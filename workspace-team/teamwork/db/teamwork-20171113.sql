/*
Navicat MySQL Data Transfer

Source Server         : alicloud
Source Server Version : 50637
Source Host           : www.gocoder.top:3306
Source Database       : teamwork

Target Server Type    : MYSQL
Target Server Version : 50637
File Encoding         : 65001

Date: 2017-11-13 10:57:05
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for article
-- ----------------------------
DROP TABLE IF EXISTS `article`;
CREATE TABLE `article` (
  `id` varchar(64) NOT NULL DEFAULT '' COMMENT '主键',
  `title` varchar(128) DEFAULT NULL COMMENT '标题',
  `brief` varchar(512) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL COMMENT '摘要',
  `detail` text COMMENT '文章内容',
  `category` varchar(128) DEFAULT NULL COMMENT '分类',
  `access` varchar(32) DEFAULT NULL COMMENT '访问权限',
  `status` varchar(32) DEFAULT NULL COMMENT '状态：草稿、发布',
  `view_time` int(8) DEFAULT NULL COMMENT '阅读次数',
  `thumb_up_time` int(8) DEFAULT NULL COMMENT '点赞次数',
  `author_name` varchar(64) DEFAULT NULL COMMENT '创建者名称',
  `create_by` varchar(64) DEFAULT NULL COMMENT '创建者',
  `create_date` datetime DEFAULT NULL COMMENT '创建时间',
  `update_by` varchar(64) DEFAULT NULL COMMENT '更新者',
  `update_date` datetime DEFAULT NULL COMMENT '更新时间',
  `del_flag` varchar(64) DEFAULT NULL COMMENT '逻辑删除标记（0：显示；1：隐藏）',
  PRIMARY KEY (`id`),
  UNIQUE KEY `id` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='商品描述表';

-- ----------------------------
-- Records of article
-- ----------------------------
INSERT INTO `article` VALUES ('A17083120222248', 'test关于比特币', '2008年爆发全球金融危机，当时有人用“  中本聪  ”的化名发          比特币  (2张)                    表了一篇论文，描述了比特币的模式。    和法定货币相比，比特币没有一个集中的发行方，而是由网络节点的计算生成，谁都有可能参与制造比特币，而且可以全世界流通，可以在任意一台接入互联网的电脑上买卖，不管身处何方，任何人都可以挖掘、购买、出售或收取比特币，并且在交易过程中外人无法辨认用户身份信息。  [2]    &nbsp;   2009年，不受央行和任何金融机构控制的比特币诞生。  [2]    &nbsp;   比特币是一种“  电子货币  ”，由...', '<div class=\"para\">2008年爆发全球金融危机，当时有人用“<a href=\"https://baike.baidu.com/item/%E4%B8%AD%E6%9C%AC%E8%81%AA\" target=\"_blank\">中本聪</a>”的化名发<a title=\"比特币\" class=\"lemma-album layout-right nslog:10000206\" style=\"width: 222px;\" href=\"https://baike.baidu.com/pic/%E6%AF%94%E7%89%B9%E5%B8%81/4143690/20461629/7c1ed21b0ef41bd5e47357ea53da81cb39db3d8f?fr=lemma&ct=cover\" target=\"_blank\"><div class=\"album-wrap\" style=\"width: 220px; height: 123px;\"><img class=\"picture\" alt=\"比特币\" src=\"/ueditor/jsp/upload/image/20170831/1504182129979064331.jpg\"/></div><div class=\"description\">比特币<span class=\"number\">(2张)</span> </div><div class=\"albumBg\"><div class=\"albumBgFir\" style=\"width: 214px;\"></div><div class=\"albumBgSec\" style=\"width: 208px;\"></div></div></a> 表了一篇论文，描述了比特币的模式。</div><div class=\"para\">和法定货币相比，比特币没有一个集中的发行方，而是由网络节点的计算生成，谁都有可能参与制造比特币，而且可以全世界流通，可以在任意一台接入互联网的电脑上买卖，不管身处何方，任何人都可以挖掘、购买、出售或收取比特币，并且在交易过程中外人无法辨认用户身份信息。<sup>[2]</sup><a class=\"sup-anchor\">&nbsp;</a> 2009年，不受央行和任何金融机构控制的比特币诞生。<sup>[2]</sup><a class=\"sup-anchor\">&nbsp;</a> 比特币是一种“<a href=\"https://baike.baidu.com/item/%E7%94%B5%E5%AD%90%E8%B4%A7%E5%B8%81\" target=\"_blank\">电子货币</a>”，由计算机生成的一串串复杂代码组成，新比特币通过预设的程序制造，随着比特币总量的增加，新币制造的速度减慢，直到2014年达到2100万个的总量上限，被挖出的比特币总量已经超过1200万个。<sup>[2]</sup><a class=\"sup-anchor\">&nbsp;</a> </div><div class=\"para\">每当比特币进入主流媒体的视野时，主流媒体总会请一些主流经济学家分析一下比特币。早先，这些分析总是集中在比特币是不是骗局。而现如今的分析总是集中在比特币能否成为未来的主流货币。而这其中争论的焦点又往往集中在比特币的通缩特性上。<sup>[5]</sup><a class=\"sup-anchor\">&nbsp;</a> </div><div class=\"para\">不少比特币玩家是被比特币的不能随意增发所吸引的。和比特币玩家的态度截然相反，经济学家们对比特币2100万固定总量的态度两极分化。<sup>[6]</sup><a class=\"sup-anchor\">&nbsp;</a> </div><div class=\"para\"><a href=\"https://baike.baidu.com/item/%E5%87%AF%E6%81%A9%E6%96%AF%E5%AD%A6%E6%B4%BE\" target=\"_blank\">凯恩斯学派</a>的经济学家们认为政府应该积极调控货币总量，用<a href=\"https://baike.baidu.com/item/%E8%B4%A7%E5%B8%81%E6%94%BF%E7%AD%96\" target=\"_blank\">货币政策</a>的松紧来为经济适时的加油或者刹车。因此，他们认为比特币固定总量货币牺牲了可调控性，而且更糟糕的是将不可避免地导致通货紧缩，进而伤害整体经济。<a href=\"https://baike.baidu.com/item/%E5%A5%A5%E5%9C%B0%E5%88%A9%E5%AD%A6%E6%B4%BE\" target=\"_blank\">奥地利学派</a>经济学家们的观点却截然相反，他们认为政府对货币的干预越少越好，货币总量的固定导致的通缩并没什么大不了的，甚至是社会进步的标志。</div><div class=\"para\">比特币网络通过“挖矿”来生成新的比特币。所谓“挖矿”实质上是用计算机解决一项复杂的数学问题，来保证比特币网络分布式记账系统的一致性。比特币网络会自动调整数学问题的难度，让整个网络约每10分钟得到一个合格答案。随后比特币网络会新生成一定量的比特币作为赏金，奖励获得答案的人。</div><div class=\"para\">2009年比特币诞生的时候，每笔赏金是50个比特币。诞生10分钟后，第一批50个比特币生成了，而此时的货币总量就是50。随后比特币就以约每10分钟50个的速度增长。当总量达到1050万时(2100万的50%)，赏金减半为25个。当总量达到1575万(新产出525万，即1050的50%)时，赏金再减半为12.5个。<sup>[7]</sup><a class=\"sup-anchor\">&nbsp;</a> </div><div class=\"para\">首先，根据其设计原理，比特币的总量会持续增长，直至100多年后达到2100万的那一天。但比特币货币总量后期增长的速度会非常缓慢。事实上，87.5%的比特币都将在头12年内被“挖”出来。所以从货币总量上看，比特币并不会达到固定量，其货币总量实质上是会不断膨胀的，尽管速度越来越慢。因此看起来比特币似乎是通胀货币才对。</div><div class=\"para\">然而判断处于通货紧缩还是膨胀，并不依据货币总量是减少还是增多，而是看整体物价水平是下跌还是上涨。整体物价上升即为通货膨胀，反之则为通货紧缩。长期看来，比特币的发行机制决定了它的货币总量增长速度将远低于社会财富的增长速度。</div><div class=\"para\">凯恩斯学派的经济学家们认为，物价持续下跌会让人们倾向于推迟消费，因为同样一块钱明天就能买到更多的东西。消费意愿的降低又进一步导致了需求萎缩、商品滞销，使物价变得更低，步入“通缩螺旋”的恶性循环。同样，通缩货币哪怕不存入银行本身也能升值（购买力越来越强），人们的投资意愿也会升高，社会生产也会陷入低迷。<sup>[5]</sup><a class=\"sup-anchor\">&nbsp;</a> 因此比特币是一种具备通缩倾向的货币。比特币经济体中，以比特币定价的商品价格将会持续下跌。<sup>[1]</sup><a class=\"sup-anchor\">&nbsp;</a> </div><div class=\"para\">比特币是一种网络虚拟货币，数量有限，但是可以用来套现：可以兑换成大多数国家的货币。你可以使用比特币购买一些虚拟的物品，比如网络游戏当中的衣服、帽子、装备等，只要有人接受，你也可以使用比特币购买现实生活当中的物品。<sup>[1]</sup><a class=\"sup-anchor\">&nbsp;</a> </div><div class=\"para\">2014年9月9日，美国电商巨头<a href=\"https://baike.baidu.com/item/eBay\" target=\"_blank\">eBay</a>宣布，该公司旗下支付处理子公司Braintree将开始接受比特币支付。该公司已与比特币交易平台Coinbase达成合作，开始接受这种相对较新的支付手段。</div><div class=\"para\">虽然eBay市场交易平台和PayPal业务还不接受比特币支付，但旅行房屋租赁社区<a href=\"https://baike.baidu.com/item/Airbnb\" target=\"_blank\">Airbnb</a>和租车服务<a href=\"https://baike.baidu.com/item/Uber/14900884\" target=\"_blank\">Uber</a>等Braintree客户将可开始接受这种虚拟货币。Braintree的主要业务是面向企业提供支付处理软件，该公司在去年被eBay以大约8亿美元的价格收购。</div><div class=\"para\">2017年1月22日晚间，火币网、比特币中国与OKCoin币行相继在各自官网发布公告称，为进一步抑制投机，防止价格剧烈波动，各平台将于2017年1月24日中午12：00起开始收取交易服务费，服务费按成交金额的0.2%固定费率收取，且主动成交和被动成交费率一致。<sup>[4]</sup><a class=\"sup-anchor\">&nbsp;</a> 5月5日，OKCoin币行网的最新数据显示，比特币的价格刚刚再度刷新历史，截止发稿前最高触及9222点高位。<sup>[8]</sup><a class=\"sup-anchor\">&nbsp;</a> </div><div class=\"anchor-list\"><a class=\"lemma-anchor para-title\"></a> <a class=\"lemma-anchor \"></a> <a class=\"lemma-anchor \"></a> </div><div class=\"para-title level-2\"><h2 class=\"title-text\"><span class=\"title-prefix\">比特币</span>创始人物</h2></div><div class=\"para\"><div class=\"lemma-picture text-pic layout-right\" style=\"width: 220px; float: right;\"><a title=\"京都大学数学教授望月新一\" class=\"image-link\" style=\"width: 220px; height: 147px;\" href=\"https://baike.baidu.com/pic/%E6%AF%94%E7%89%B9%E5%B8%81/4143690/0/024f78f0f736afc3db3f5ed0b119ebc4b7451257?fr=lemma&ct=single\" target=\"_blank\"><img alt=\"京都大学数学教授望月新一\" src=\"/ueditor/jsp/upload/image/20170831/1504182130160074800.jpg\"/></a><span class=\"description\">京都大学数学教授望月新一 </span></div>2008年11月1日，一个自称中本聪（Satoshi Nakamoto）的人在一个隐秘的<a href=\"https://baike.baidu.com/item/%E5%AF%86%E7%A0%81%E5%AD%A6\" target=\"_blank\">密码学</a>评论组上贴出了一篇研讨陈述，陈述了他对电子货币的新设想——比特币就此面世，比特币的首笔交易完成。比特币用揭露散布总账摆脱了第三方机构的制约，中本聪称之为“区域链”。用户乐于奉献出<a href=\"https://baike.baidu.com/item/CPU\" target=\"_blank\">CPU</a>的运算能力，运转一个特别的软件来做一名“挖矿工”，这会构成一个网络共同来保持“区域链”。这个过程中，他们也会生成新货币。买卖也在这个网络上延伸，运转这个软件的电脑真相破解不可逆暗码难题，这些难题包含好几个买卖数据。第一个处理难题的“<a href=\"https://baike.baidu.com/item/%E7%9F%BF%E5%B7%A5\" target=\"_blank\">矿工</a>”会得到50比特币奖赏，相关买卖区域加入链条。跟着“矿工”数量的添加，每个迷题的艰难程度也随之进步，这使每个买卖区的比特币生产率保持约在10分钟一枚。</div><div class=\"para\">2009年，中本聪设计出了一种数字货币，即比特币，风风火火的比特币市场起了又落，而其创始人“中本聪”的身份一直都是个谜，关于“比特币之父”的传闻牵涉到从美国国家安全局到金融专家，也给比特币罩上了神秘光环。</div><div class=\"para\">据外媒报道称，计算机科学家TedNelson周日在网络上发布视频称，他已经确定出，比特币的创始人是京都大学数学教授望月新一（ShinichiMochizuki）。比特币的创始人一直以来使用的都是中本聪（SatoshiNakamoto）的假名，互联网领域也对其真实身份展开了大量推测。纳尔逊发布视频称，他已确定望月新一就是比特币的真正创始人。<sup>[9]</sup><a class=\"sup-anchor\">&nbsp;</a> </div><div class=\"para\">望月新一2013年因为证明ABC猜想而名声大噪。他高中时就读于菲利普埃克塞特学院，后者是美国最具声望的高中之一，仅仅两年后就毕业。望月新一16岁进入美国普林斯顿大学，22岁时以博士身份离校，33岁就成为正教授，这么年轻就获得正教授职称在学术界极为罕见。这个数学界的巨星可能已经攻破了该领域最为重要的难题之一。</div><div class=\"para\">中本聪本人在互联网上留下的个人资料很少，尤其是近几年几乎完全销声匿迹，因此其身世也变成了一个迷。2014年3月7日，当比特币创始人多利安·P·中本聪被找到的新闻传出后，迅速成为互联网上最吸引人的消息。</div><div class=\"para\">与外界揣测其可能是个虚构的名字不同，“中本聪”是个真实的名字，他是一名64岁的日裔美国人，他喜欢收集火车模型，曾供职大企业和美国军方，从事机密工作。在过去的40年中，中本聪从不在生活中用他的真名。根据美国洛杉矶地方法院1973年的档案，在他23岁从加州州立理工大学毕业时，将自己的名字改为了多利安·普伦蒂斯·中本聪（DorianPrenticeSatoshiNakamoto）。从那时起，他不再使用“聪”这个名字，而用多利安·中本S（DorianS.Nakamoto）作为签名。<sup>[9]</sup><a class=\"sup-anchor\">&nbsp;</a> </div><div class=\"anchor-list\"><a class=\"lemma-anchor para-title\"></a> <a class=\"lemma-anchor \"></a> <a class=\"lemma-anchor \"></a> </div><div class=\"para-title level-2\"><h2 class=\"title-text\"><span class=\"title-prefix\">比特币</span>产生原理</h2></div><div class=\"para\">从比特币的本质说起，比<div class=\"lemma-picture text-pic layout-right\" style=\"width: 250px; float: right;\"><a title=\"疯狂涨势\" class=\"image-link\" style=\"width: 250px; height: 106px;\" href=\"https://baike.baidu.com/pic/%E6%AF%94%E7%89%B9%E5%B8%81/4143690/0/d043ad4bd11373f093fb8183a60f4bfbfaed04e1?fr=lemma&ct=single\" target=\"_blank\"><img alt=\"疯狂涨势\" src=\"/ueditor/jsp/upload/image/20170831/1504182130204024393.jpg\"/></a><span class=\"description\">疯狂涨势 </span></div>特币的本质其实就是一堆复杂算法所生成的特解。特解是指<a href=\"https://baike.baidu.com/item/%E6%96%B9%E7%A8%8B%E7%BB%84\" target=\"_blank\">方程组</a>所能得到无限个（其实比特币是有限个）解中的一组。而每一个特解都能解开方程并且是唯一的。<sup>[10]</sup><a class=\"sup-anchor\">&nbsp;</a> 以人民币来比喻的话，比特币就是人民币的序列号，你知道了某张钞票上的序列号，你就拥有了这张钞票。而挖矿的过程就是通过庞大的计算量不断的去寻求这个方程组的特解，这个方程组被设计成了只有 2100 万个特解，所以比特币的上限就是 2100 万。<sup>[10]</sup><a class=\"sup-anchor\">&nbsp;</a> </div><div class=\"para\">要挖掘比特币可以下载专用的比特币运算工具，然后注册各种合作网站，把注册来的用户名和密码填入计算程序中，再点击运算就正式开始。<sup>[11]</sup><a class=\"sup-anchor\">&nbsp;</a> 完成Bitcoin客户端安装后，可以直接获得一个Bitcoin地址，当别人付钱的时候，只需要自己把地址贴给别人，就能通过同样的客户端进行付款。在安装好比特币客户端后，它将会分配一个私有<a href=\"https://baike.baidu.com/item/%E5%AF%86%E9%92%A5\" target=\"_blank\">密钥</a>和一个<a href=\"https://baike.baidu.com/item/%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5\" target=\"_blank\">公开密钥</a>。需要备份你包含私有密钥的钱包数据，才能保证财产不丢失。如果不幸完全格式化硬盘，个人的比特币将会完全丢失。</div><div class=\"anchor-list\"><a class=\"lemma-anchor para-title\"></a> <a class=\"lemma-anchor \"></a> <a class=\"lemma-anchor \"></a> </div><div class=\"para-title level-2\"><h2 class=\"title-text\"><span class=\"title-prefix\">比特币</span>货币特征</h2></div><div class=\"para\"><strong>去中心化：</strong>比特币是第一种分布式的虚拟货币，整个网络由用户构成，没有中央银行。去中心化是比特币安全与自由的保证 。</div><div class=\"para\"><strong>全世界流通：</strong>比特币可以在任意一台接入互联网的电脑上管理。不管身处何方，任何人都可以挖掘、购买、出售或收取比特币。</div><div class=\"para\"><strong>专属所有权：</strong>操控比特币需要私钥，它可以被隔离保存在任何存储介质。除了用户自己之外无人可以获取。</div><div class=\"para\"><strong>低交易费用：</strong>可以免费汇出比特币，但最终对每笔交易将收取约1比特分的交易费以确保交易更快执行。</div><div class=\"para\"><strong>无隐藏成本：</strong>作为由A到B的支付手段，比特币没有繁琐的额度与手续限制。知道对方比特币地址就可以进行支付。</div><div class=\"para\"><strong>跨平台挖掘：</strong>用户可以在众多平台上发掘不同硬件的计算能力。</div><div class=\"anchor-list\"><a class=\"lemma-anchor para-title\"></a> <a class=\"lemma-anchor \"></a> <a class=\"lemma-anchor \"></a> </div><div class=\"para-title level-3\"><h3 class=\"title-text\"><span class=\"title-prefix\">比特币</span>优点</h3></div><ol class=\"custom_num  para-list list-paddingleft-1\"><li class=\"list-num-1-1 list-num-paddingleft-1\"><div class=\"para\">完全去处中心化，没有发行机构，也就不可能操纵发行数量。其发行与流通，是通过开源的p2p算法实现。</div></li><li class=\"list-num-1-2 list-num-paddingleft-1\"><div class=\"para\">匿名、免税、免监管。</div></li><li class=\"list-num-1-3 list-num-paddingleft-1\"><div class=\"para\">健壮性。比特币完全依赖p2p网络，无发行中心，所以外部无法关闭它。比特币价格可能波动、崩盘，多国政府可能宣布它非法，但比特币和比特币庞大的p2p网络不会消失。</div></li><li class=\"list-num-1-4 list-num-paddingleft-1\"><div class=\"para\">无国界、跨境。跨国汇款，会经过层层外汇管制机构，而且交易记录会被多方记录在案。但如果用比特币交易，直接输入数字地址，点一下鼠标，等待p2p网络确认交易后，大量资金就过去了。不经过任何管控机构，也不会留下任何跨境交易记录。</div></li><li class=\"list-num-1-5 list-num-paddingleft-1\"><div class=\"para\">山寨者难于生存。由于比特币算法是完全开源的，谁都可以下载到源码，修改些参数，重新编译下，就能创造一种新的p2p货币。但这些山寨货币很脆弱，极易遭到51%攻击。任何个人或组织，只要控制一种p2p货币网络51%的运算能力，就可以随意操纵交易、币值，这会对p2p货币构成毁灭性打击。很多山寨币，就是死在了这一环节上。而比特币网络已经足够健壮，想要控制比特币网络51%的运算力，所需要的cpu/gpu数量将是一个天文数字。</div></li></ol><div class=\"anchor-list\"><a class=\"lemma-anchor para-title\"></a> <a class=\"lemma-anchor \"></a> <a class=\"lemma-anchor \"></a> </div><div class=\"para-title level-3\"><h3 class=\"title-text\"><span class=\"title-prefix\">比特币</span>缺点</h3></div><ol class=\"custom_num  para-list list-paddingleft-1\"><li class=\"list-num-1-1 list-num-paddingleft-1\"><div class=\"para\">交易平台的脆弱性。比特币网络很健壮，但比特币交易平台很脆弱。交易平台通常是一个网站，而网站会遭到黑客攻击，或者遭到主管部门的关闭。</div></li><li class=\"list-num-1-2 list-num-paddingleft-1\"><div class=\"para\">交易确认时间长。比特币钱包初次安装时，会消耗大量时间下载历史交易数据块。而比特币交易时，为了确认数据准确性，会消耗一些时间，与p2p网络进行交互，得到全网确认后，交易才算完成。</div></li><li class=\"list-num-1-3 list-num-paddingleft-1\"><div class=\"para\">价格波动极大。由于大量炒家介入，导致比特币兑换现金的价格如过山车一般起伏。使得比特币更适合投机，而不是匿名交易。</div></li><li class=\"list-num-1-4 list-num-paddingleft-1\"><div class=\"para\">大众对原理不理解，以及传统金融从业人员的抵制。活跃网民了解p2p网络的原理，知道比特币无法人为操纵和控制。但大众并不理解，很多人甚至无法分清比特币和Q币的区别。“没有发行者”是比特币的优点，但在传统金融从业人员看来，“没有发行者”的货币毫无价值。<sup>[12]</sup><a class=\"sup-anchor\">&nbsp;</a></div></li></ol><div class=\"anchor-list\"><a class=\"lemma-anchor para-title\"></a> <a class=\"lemma-anchor \"></a> <a class=\"lemma-anchor \"></a> </div><div class=\"para-title level-2\"><h2 class=\"title-text\"><span class=\"title-prefix\">比特币</span>货币交易</h2></div><div class=\"anchor-list\"><a class=\"lemma-anchor para-title\"></a> <a class=\"lemma-anchor \"></a> <a class=\"lemma-anchor \"></a> </div><div class=\"para-title level-3\"><h3 class=\"title-text\"><span class=\"title-prefix\">比特币</span>购买方法</h3></div><div class=\"para\"><div class=\"lemma-picture text-pic layout-right\" style=\"width: 220px; float: right;\"><a title=\"\" class=\"image-link\" style=\"width: 220px; height: 150px;\" href=\"https://baike.baidu.com/pic/%E6%AF%94%E7%89%B9%E5%B8%81/4143690/0/0eb30f2442a7d933108ec115ac4bd11373f001b5?fr=lemma&ct=single\" target=\"_blank\"><img alt=\"\" src=\"/ueditor/jsp/upload/image/20170831/1504182130383038535.jpg\"/></a></div>用户可以买到比特币，同时还可以使用计算机依照算法进行大量的运算来“开采”比特币。在用户“开采”比特币时，需要用电脑搜寻<a href=\"https://baike.baidu.com/item/64%E4%BD%8D\" target=\"_blank\">64位</a>的数字就行，然后通过反复解谜密与其他淘金者相互竞争，为比特币网络提供所需的数字，如果用户的电脑成功地创造出一组数字，那么就将会获得25个比特币。</div><div class=\"para\">由于比特币系统采用了分散化编程，所以在每10分钟内只能获得25个比特币，而到2140年，流通的比特币上限将会达到2100万。换句话说，比特币系统是能够实现自给自足的，通过<a href=\"https://baike.baidu.com/item/%E7%BC%96%E7%A0%81\" target=\"_blank\">编码</a>来抵御通胀，并防止他人对这些代码进行破坏。</div><div class=\"anchor-list\"><a class=\"lemma-anchor para-title\"></a> <a class=\"lemma-anchor \"></a> <a class=\"lemma-anchor \"></a> </div><div class=\"para-title level-3\"><h3 class=\"title-text\"><span class=\"title-prefix\">比特币</span>交易方式</h3></div><div class=\"para\">比特币是类似电子邮件的电子现金，交易双方需要类似电子邮箱的“比特币钱包”和类似电邮地址的“比特币地址”。和收发电子邮件一样，汇款方通过电脑或智能手机，按收款方地址将比特币直接付给对方。下列表格，列出了免费下载比特币钱包和地址的部分网站。</div><div class=\"para\">比特币地址是大约33位长的、由字母和数字构成的一串字符，总是由1或者3开头，例如&quot;1DwunA9otZZQyhkVvkLJ8DV1tuSwMF7r3v&quot;。比特币软件可以自动生成地址，生成地址时也不需要联网交换信息，可以离线进行[2]。可用的比特币地址超过2个。形象地说，全世界约有2粒沙， 如果每一粒沙中有一个地球，那么比特币地址总数远远超过所有这些“地球”上的所有的沙子的数量。</div><div class=\"para\">比特币地址和私钥是成对出现的，他们的关系就像银行卡号和密码。比特币地址就像银行卡号一样用来记录你在该地址上存有多少比特币。你可以随意的生成比特币地址来存放比特币。每个比特币地址在生成时，都会有一个相对应的该地址的私钥被生成出来。这个私钥可以证明你对该地址上的比特币具有所有权。我们可以简单的把比特币地址理解成为银行卡号，该地址的私钥理解成为所对应银行卡号的密码。只有你在知道银行密码的情况下才能使用银行卡号上的钱。所以，在使用比特币钱包时请保存好你的地址和私钥。</div><div class=\"para\">比特币的交易数据被打包到一个“数据块”或“区块”（block）中后，交易就算初步确认了。当区块链接到前一个区块之后，交易会得到进一步的确认。在连续得到6个区块确认之后，这笔交易基本上就不可逆转地得到确认了。比特币对等网络将所有的交易历史都储存在“区块链”（blockchain）中。区块链在持续延长，而且新区块一旦加入到区块链中，就不会再被移走。区块链实际上是一群分散的用户端节点，并由所有参与者组成的<a href=\"https://baike.baidu.com/item/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93\" target=\"_blank\">分布式数据库</a>，是对所有比特币交易历史的记录 。 中本聪预计，当数据量增大之后，用户端希望这些数据并不全部储存自己的节点中。为了实现这一目标，他采用引入<a href=\"https://baike.baidu.com/item/%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B0\" target=\"_blank\">散列函数</a>机制。这样用户端将能够自动剔除掉那些自己永远用不到的部分，比方说极为早期的一些比特币交易记录。</div><div class=\"anchor-list\"><a class=\"lemma-anchor para-title\"></a> <a class=\"lemma-anchor \"></a> <a class=\"lemma-anchor \"></a> </div><div class=\"para-title level-3\"><h3 class=\"title-text\"><span class=\"title-prefix\">比特币</span>消费方式</h3></div><div class=\"para\">许多面向科技玩家的网站，已经开始接受比特币交易。包括Mtgox，BTCChina之类的网站，以及淘宝某些商店，甚至能接受比特币兑换美元、欧元等服务。毫无疑问，比特币已经成为真正的流通货币，而非腾讯Q币那样的虚拟货币。国外已经有专门的比特币第三方支付公司，类似国内的支付宝，可以提供API接口服务。</div><div class=\"para\">可以用钱来买比特币，也可以当采矿者，“开采”它们用电脑搜寻64位的数字就行。通过用电脑反复解密，与其他的淘金者竞争，为比特币网络提供所需的数字。如果电脑能够成功地创造出一组数字，就会获得25个比特币。比特币是分散化的，需要在每个单位计算时间内创造固定数量比特币是每10分钟内可获得25个比特币。到2140年，流通的比特币上限将达到2100万。换句话说，比特币体制是可以自给自足的，译成编码可抵御通胀，防止他人搞破坏。</div><div class=\"anchor-list\"><a class=\"lemma-anchor para-title\"></a> <a class=\"lemma-anchor \"></a> <a class=\"lemma-anchor \"></a> </div><div class=\"para-title level-3\"><h3 class=\"title-text\"><span class=\"title-prefix\">比特币</span>支付案例</h3></div><div class=\"para\">在被投资者疯狂追逐的同时，比特币已经在现实中被个别商家接受。北京一家餐馆开启了比特币支付。这家位于朝阳大悦城的餐馆称，该店从2013年11月底开始接受比特币支付。消费者在用餐结束时，把一定数量的比特币转账到该店账户，即可完成支付，整个过程类似于银行转账。该餐馆曾以0.13个比特币结算了一笔650元的餐费。<sup>[13]</sup><a class=\"sup-anchor\">&nbsp;</a> </div><div class=\"para\">2014年1月，Overstock开始接受比特币，成为首家接受比特币的大型网络零售商。</div><p><br/></p>', 'DS2600', 'public', 'publish', '8', '0', '丁庆发', 'dingqingfa@star-net.cn', '2017-08-31 20:22:23', 'dingqingfa@star-net.cn', '2017-09-18 14:24:22', '1');
INSERT INTO `article` VALUES ('A17090116254132', 'ioctl无法正常执行（android64位系统上运行32位应用的兼容问题）', '问题一：ioctl未被调用到      背景：在64位安卓系统上运行32位应用程序，调用ioctl时，对应驱动没有运行ioctl    原因：针对上述背景的情况，ioctl调用的实际上是驱动中的compat_ioctl 接口，需要我们增加该定义（如果增加完该接口定义仍然没有调用到，尝试开启配置，  在device/nb/la68/ProjectConfig.mk（根据各人实际项目进入对应目录）下增加CONFIG_COMPAT = yes；），  驱动中增加compat_ioctl的定义，与unlocked_ioctl一样的定义方法    const struct file_operat...', '<div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\"><span style=\"font-size: 18px; font-weight: bold;\">问题一：ioctl未被调用到</span></div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">背景：在64位安卓系统上运行32位应用程序，调用ioctl时，对应驱动没有运行ioctl</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">原因：针对上述背景的情况，ioctl调用的实际上是驱动中的compat_ioctl 接口，需要我们增加该定义（如果增加完该接口定义仍然没有调用到，尝试开启配置，<span style=\"color: rgb(72, 71, 68); background-color: rgb(255, 255, 255);\">在device/nb/la68/ProjectConfig.mk（根据各人实际项目进入对应目录）下增加CONFIG_COMPAT = yes；），</span>驱动中增加compat_ioctl的定义，与unlocked_ioctl一样的定义方法</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">const struct file_operations stm32f103_fops = {</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">	.owner = THIS_MODULE,</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp;	.poll = stm32f103_poll,</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">	.open = stm32f103_open,</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">	.read = stm32f103_read_buff,</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">	.write = stm32f103_write_buff,</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">	.release = stm32f103_release,</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">	.unlocked_ioctl = stm32f103_unlocked_ioctl,	</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">	.compat_ioctl = stm32f103_compat_ioctl, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //32位应用运行在64位系统时ioctl调用该接口</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">};</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\"><span style=\"font-size: 18px; font-weight: bold;\">问题二：ioctl中调用copy_from_user时出错，提示地址有问题</span></div><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">背景：</p><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">由于ioctl第三个参数，我在应用层中传入的是一个指向结构体的指针（该指针已由系统转换为64位指针，可以访问到用户空间的数据），且该结构体中含有指针成员，而指针在32位环境下为4位长度，在64位环境下为8位长度，同一个结构体，在不同的环境下，由于内存对齐，导致两个结构体实际的空间占用是不同的，在驱动中接收到该结构体后，进行数据处理需要注意结构体内存对齐问题，尤其是指针和long类型的数据要进行转换。</p><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">原结构体如下：</p><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;typedef struct</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;{</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;	char data_len;</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;	char *data_buff;</div><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;}stm32_data_pack_t;</p><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\"><br/></p><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">在驱动中增加定义了中间结构体，如下：</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;typedef struct</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;{</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;	char data_len;</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;	int data_buff;</div><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;}stm32_data_pack_32bit_t;</p><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">转换方法：</p><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">在驱动中（64位环境）用int先存储传进来的32位环境下的4位长度char*，然后利用compat_ptr函数将32位地址转换为64位地址，这样得到的地址就可以拿来访问用户空间的数据了</div><br/><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\"><br/></p><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">具体代码片段如下（参数arg为32位应用程序传进来的指向结构体的指针，该指针已由系统转换为64位环境下的地址）：</p><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">long stm32f103_compat_ioctl(struct file *file, unsigned int cmd, unsigned long arg)</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">{</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">	stm32_data_pack_t data_pack;</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp; &nbsp;&nbsp;	stm32_data_pack_32bit_t &nbsp;data_pack_32bit;</div><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">	memset(&amp;data_pack_32bit, 0, sizeof(stm32_data_pack_32bit_t));</p><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\"><br/></p><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp; &nbsp; &nbsp;ret = copy_from_user(&amp;data_pack_32bit, (stm32_data_pack_32bit_t *)arg, sizeof(stm32_data_pack_32bit_t));</div><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp; &nbsp; &nbsp;data_pack.data_len = data_pack_32bit.data_len;</div><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp; &nbsp; &nbsp;data_pack.data_buff= compat_ptr(data_pack_32bit.data_buff);</p><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\"><br/></p><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;return ret；</div><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\">}</p><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\"><span style=\"font-size: 14px; line-height: 24.5px; white-space: pre-wrap;\"></span><span style=\"font-size: 14px; line-height: 24.5px; white-space: pre-wrap;\">这里转换后的<span style=\"font-size: 14px; line-height: 24.5px; white-space: pre-wrap;\">data_pack.data_buff</span>是用户空间地址，需要调用相关接口（eg：<span style=\"font-size: 14px; line-height: 24.5px; white-space: pre-wrap;\">copy_from_user</span>）从用户空间地址拷贝到内核态地址来，才能处理数据。</span>	</p><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\"></p><div style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\"><span style=\"font-size: 18px; font-weight: bold;\">三、总结：</span></div><div style=\"white-space: pre-wrap; line-height: 1.75; text-indent: 28px; font-size: 14px;\"><span style=\"font-size: 18px; font-weight: bold;\">32位应用传入64位底层的数据要尽量避免开数据类型不兼容的类型，比如指针、long等，尤其是结构体需要格外注意，涉及到内存对齐问题。</span></div><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\"><br/></p><p style=\"white-space: pre-wrap; line-height: 1.75; font-size: 14px;\"><br/></p><p><br/></p>', 'DS3000,Linux,Android', 'public', 'publish', '26', '6', '黄文文', 'huangwenwen@star-net.cn', '2017-09-01 16:25:42', 'huangwenwen@star-net.cn', '2017-09-01 16:47:26', '0');
INSERT INTO `article` VALUES ('A17090116330647', 'flash 替换', '#### 一、概况及进展          由于原来使用的flash停产，需要在ds2600导入新flash。目前主要通过宇芯的黄工(huangshf&lt;huangshf@worldchip.cn&gt;)与全志协调来调试flash补丁，    计划导入的三款flash的计划及进入如下：          1. GD5F1GQ4UCYIG      	  - 调通补丁 （已完成）      	  - 使用x66测试验证 (已完成)      	  - x66小批量生产验证 (待生产)          2. W25N01GV(华邦)      	  - 补丁调试 (全志的提供的补丁无法...', '<p>#### 一、概况及进展</p><p><br/></p><p>由于原来使用的flash停产，需要在ds2600导入新flash。目前主要通过宇芯的黄工(huangshf&lt;huangshf@worldchip.cn&gt;)与全志协调来调试flash补丁，</p><p>计划导入的三款flash的计划及进入如下：</p><p><br/></p><p>1. GD5F1GQ4UCYIG</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>- 调通补丁 （已完成）</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>- 使用x66测试验证 (已完成)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>- x66小批量生产验证 (待生产)</p><p><br/></p><p>2. W25N01GV(华邦)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>- 补丁调试 (全志的提供的补丁无法兼容gd flash，需要找原厂更新新补丁)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>- 使用x66测试验证 (未做)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>- x66小批量 (未做)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span></p><p>3. PN26G01A (芯天下)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>- 补丁调试 (芯片已寄出，大概1~2周可以全志可以调试完毕)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>- 使用x66测试验证 (未做)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>- x66小批量 (未做)</p><p>备注：以前的芯片叫万宏（音是这么发的），具体型号问罗工</p><p>&gt; 各款flash的规格信息见datasheet目录</p><p>备注：接下来黄工会提供一个通用的补丁包，支持这三款flash，需要验证三款设备和以前的flash设备</p><p><br/></p><p>#### 二、补丁使用方式</p><p><br/></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>1. 将全志给的补丁文件同步到sdk (GD flash的补丁已经同步到develop分支39203678b8c1)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>2. 执行mkuboot -&gt; mkall进行编译&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>3. 查看kmsg的uboot版本是否有更新(如:uboot:nand version: 2 29 20170622 1145)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>备注：开机时候，查看串口信息 uboot:nand version: 2 32 20170728 1145</p><p>#### 三、测试包打包方式</p><p><br/></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>发布新测试包时可能只希望替换底层flash相关的改动，这种情况下可使用固件包修改工具对固件包进行修改(ds2600-sdk/lichee/tools/pack/dvp/full_image_parser)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>具体步骤如下:</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>1. 在full_image_parser目录下运行&quot;unpack_full_img.sh + 要修改的固件&quot;，之后会在unpack_out目录生成解包内容。</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>2. 使用最新编译生成的fex文件(位于ds2600-sdk/lichee/tools/pack/out)替换原flash相关文件：</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">		</span>1. 替换unpack_out目录下的&quot;u-boot.fex、boot.fex、Vboot.fex、boot0_spinor.fex、boot0_spinand.fex、boot0_sdcard.fex&quot;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">		</span>2. 替换origin目录下的&quot;u-boot-spinor.fex&quot;。</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">			</span>备注：(拷贝&quot;u-boot-spinor.fex&quot;到&quot;origin_files&quot;目录下)</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>3. 修改软件版本，修改unpack_out/rootfs/etc/dvp/sw_cfg/sw_ver.ini文件中的软件版本及日期，软件版本可以改为最新补丁提交后的commit号。</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">		</span>备注：取前5位（如 39203678b8c1 取 39203）</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>3. 执行pack_full_img.sh ./unpack_out来重新打包，之后会在packout目录下生成最新的固件（sun8iw8p1_camdroid_tiger-dvp-nand_uart0.img）。</p><p><br/></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>有时需要修改网络固件升级包中flash相关的内容，步骤如下：</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>1.解包，需要将固件升级包中的如下几个文件进行替换:</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">		</span>- u-boot.fex及boot.fex可以用最新编译生成的fex进行替换，同固件包替换方式相同</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>2.然后修改rootfs目录下etc/dvp/sw_cfg/sw_ver.ini的commit号</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>3.重新打包</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>具体的ota解包及打包方法见ds2600-sdk/lichee/tools/pack/dvp/ota_parser内的README.md</p><p>备注：需要用root 用户操作（普通用户不知道哪里缺少了权限）</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span> &nbsp;操作前需要 source下</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span> &nbsp;不同版本的都需要mkall一下（boot.fex包含版本信息等 ），mkuboot只需要一次</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">		</span></p><p>#### 四、验证方式</p><p><br/></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>1. 让测试部用新包过下基本功能看是否正常。</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>2. 使用工具进行读写压力测试，看是否异常log输出。(压力测试工具及方法见&quot;压力测试/spinand_test&quot;目录）</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">		</span>备注：一般测试时间为两天</p><p><br/></p><p>#### 五、其他</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>还有5台x30,及若干flash样片在全志那边，等flash调试完成之后需要他们将机器寄回来</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>备注：设备寄给了全志，我们找 宇兴 黄工中间人来归还设备，1台在罗工名下，4台在33名下</p><p>#### 相关联系人</p><p><br/></p><p>宇兴-黄工:<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>huangshf@worldchip.cn</p><p>硬件-罗诚:<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>luocheng@star-net.cn</p><p><br/></p>', 'DS2600', 'private', 'publish', '25', '7', '李晴', 'liqing@star-net.cn', '2017-09-01 16:33:06', 'liqing@star-net.cn', '2017-09-01 16:33:06', '0');
INSERT INTO `article` VALUES ('A17090414592661', '安卓ndk编译坑记录', '背景：将包含dvpjni库的I80应用跑到其他安卓设备上，踩到一些坑，可气的是怎么掉坑的都不知道，，记录一下血泪史          1、webrtc库引发的崩溃问题    今年3月份调试一个RK3288美的冰箱平板（安卓5.1），遇到dvp库使用ndk9编译的webrtc会崩溃。  当时的总结是【形参进来除（/）一个数，然后赋值给全局变量（或形参中的某个结构体成员）就会崩溃】  试过简单的测试程序也是这样，所以可能与webrtc无关，最终是把ndk版本改成10以上去编译就正常了。            这两处会死          以上可用的情况下在魔镜（安卓5.1）上也...', '<p><br/></p><p><br/>背景：将包含dvpjni库的I80应用跑到其他安卓设备上，踩到一些坑，可气的是怎么掉坑的都不知道，，记录一下血泪史</p><p><br/></p><div>1、webrtc库引发的崩溃问题</div><div>今年3月份调试一个RK3288美的冰箱平板（安卓5.1），遇到dvp库使用ndk9编译的webrtc会崩溃。<br/>当时的总结是【形参进来除（/）一个数，然后赋值给全局变量（或形参中的某个结构体成员）就会崩溃】<br/>试过简单的测试程序也是这样，所以可能与webrtc无关，最终是把ndk版本改成10以上去编译就正常了。</div><p><br/></p><p><img title=\"\" alt=\"1504508242230_967726.png\" src=\"http://39.108.177.3:8080/upload//images/2017-09-04/1504508242230_967726.png\"/>这两处会死</p><p><br/></p><div>以上可用的情况下在魔镜（安卓5.1）上也是可以的，未验证使用ndk9的会不会在魔镜崩溃</div><div>最近调试RK3128（安卓6.0.1）使用上述ndk13编译出来的webrtc给dvp使用又会崩溃了。。。<br/>日志指示WebRtcNsx_Create、WebRtcAecm_Init等底层接口会崩溃，单独webrtc测试程序与dvp无关跑进去又不会<br/>最终是改会用ndk9去编译webrtc才能正常，因为只有包含在dvp库下才会导致崩溃，而此时又无法打印log，所以没有查下去</div><div><br/>2、关于ndk版本的差异<br/>（1）NDK-9 函数中变量地址是向上增长的，NDK-13 是向下增长的<br/>（2）NDK-13编译可执行程序时需添加以下两条(安全机制判断)，否则执行会失败（提示：error: only position independent executables (PIE) are supported）<br/>&nbsp;&nbsp;LOCAL_CFLAGS += -fPIE<br/>&nbsp;&nbsp;LOCAL_LDFLAGS += -fPIE -pie<br/>&nbsp;如果NDK-9编译so时则不能包含这两句，否则在编译包含这个so的时候会编译失败提示找不到库里面的接口</div><div>&nbsp;<br/>3、dvpjni库无法打印log<br/>美的平板、RK3128、MTK-LA68这几个我碰到的dvp库下都无法打印安卓log，发现无法打印的都是打印到/dev/log/main那边（logcat没有输出）<br/>外面单独做一个log打印的so给dvp却可以，目前唯独发现webrtc库里面如果用ndk13编译会有底层部分无法打印出来（ndk9可以）</div><p><br/></p><p>4、so崩溃地址</p><div style=\"font-family:&#39;Helvetica Neue&#39;, Arial, sans;font-size:16px;\">编译出带地址符号表的so，出现崩溃时可用addr2line定位问题所在函数行数</div><div style=\"font-family:&#39;Helvetica Neue&#39;, Arial, sans;font-size:16px;\">cmd执行以下命令（<span style=\"font-family:gotham, helvetica, arial, sans-serif;font-size:14px;\">addr2line 位于%NDKHOME%</span>	oolchainsarm-linux-androideabi-4.9prebuiltwindows-x86_64in目录下）</div><p style=\"font-family:gotham, helvetica, arial, sans-serif;font-size:14px;\">arm-linux-androideabi-addr2line -C -f -e &nbsp;~/workspace/DLNA/libs/armeabi/libctrlpt.so 0003deb4</p><p style=\"font-family:gotham, helvetica, arial, sans-serif;font-size:14px;\"><br/></p><p style=\"font-family:gotham, helvetica, arial, sans-serif;font-size:14px;\"><br/></p><p style=\"font-family:gotham, helvetica, arial, sans-serif;font-size:14px;\"><br/></p><p style=\"font-family:gotham, helvetica, arial, sans-serif;font-size:14px;\"><br/></p><p style=\"font-family:gotham, helvetica, arial, sans-serif;font-size:14px;\"><br/></p><p style=\"font-family:gotham, helvetica, arial, sans-serif;font-size:14px;\"><br/></p><p><br/></p>', 'DS3000,C&C++,Linux,Android', 'private', 'publish', '27', '4', '林圣腾', 'linshengteng@star-net.cn', '2017-09-04 14:59:26', 'linshengteng@star-net.cn', '2017-09-05 15:20:20', '0');
INSERT INTO `article` VALUES ('A17090810333894', 'Z73开发环境搭建', 'Z73开发环境搭建          一、下载代码。路径：svn://192.168.61.223/HZ300，分支太多，目前使用的是 branches/Z73_Pro_V3.1.X_A4          二、下载eclipse。地址：http://www.cnblogs.com/ls-33/p/6555564.html，参考这份eclipse搭建Android开发环境详细步骤        三、参照网上的步骤安装完Android SDK Manager。这个需要很久，但是我记得一路next就可以了，不需要选择什么。  如果全部安装，文件太大，时间也太长，据说只安装Android4.2....', '<p style=\"text-align: center;\">Z73开发环境搭建</p><p><br/></p><p>一、下载代码。路径：svn://192.168.61.223/HZ300，分支太多，目前使用的是 branches/Z73_Pro_V3.1.X_A4</p><p><br/></p><p>二、下载eclipse。地址：http://www.cnblogs.com/ls-33/p/6555564.html，参考这份eclipse搭建Android开发环境详细步骤<br/></p><p><br/>三、参照网上的步骤安装完Android SDK Manager。这个需要很久，但是我记得一路next就可以了，不需要选择什么。<br/>如果全部安装，文件太大，时间也太长，据说只安装Android4.2.2（API 17）就可以了。<br/>AVD创不创建都无所谓，反正模拟器也跑不起来。</p><p><br/></p><p>总之，需要三个包：eclipse、Android SDK， Android ndk；不用eclipse也可以，使用Android studio更方便，我没试过就写不出来了。</p><p><br/></p><p>四、Z73工程的编译：<br/>1、打开eclipse，导入Z73工程，File-&gt;Import-&gt;Android-&gt;Existing Android Code Into Workspace，选择代码路径，导入完成之后，会出现Z73工程。</p><p>2、设置android sdk路径：</p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-08/1504837966392_979518.png\" title=\"\" alt=\"1504837966392_979518.png\"/></p><p>3、先编译下，正常应该是会报错，因为svn上的编译环境传了个不能用的builder。右键Z73工程名，Properties-&gt;Builders，找到那个红色打叉的编译器，删掉就行了，这个本来是用来编译C的，暂时可以不用。<br/>4、如果顺利，应该可以编译通过了。然后打包，右键Z73工程名-&gt;Android Tools-&gt;Export Unsigned Application Package，弹出路径选择，就选Z73_Pro_V3.1.X_A4Z73升级包制作工具_A4，等待提示导出成功之后，执行Z73_Pro_V3.1.X_A4Z73升级包制作工具_A4Z73_Tool_A4.bat，这样升级包就打好了。<br/>5、用刚打好的包升级试试能不能跑起来。可以用IBMC网络升级，也可以用U盘升级。IBMC网络升级与设备端其他的机子升级方法相同，这里不再介绍，说一下U盘升级方法。升级包bin和md5两个文件拷贝到U盘根目录，插到Z73上，在界面上点“设置——&gt;应用设置（密码3888）——应用还原——应用升级”，等升级界面检测到/mnt/usb_storage/Z73_updateimage.upgrade之后，点“开始升级”，等待升级成功重启。</p><p><br/></p><p>五、编译过程中常遇到的问题：<br/>1、permission is only granted to system apps<br/>解决办法：Window -&gt; Preferences -&gt; Android -&gt; Lint Error Checking，找到ProtectedPermission选项，把安全等级降低，改成warning。<br/>类似这样的修改安全等级的问题可能还会碰到，也同样百度一下错误提示的关键词，找到对应的选项，修改安全等级即可。</p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-08/1504837841027_732683.png\" title=\"\" alt=\"1504837841027_732683.png\"/></p><p><br/></p><p>2、通常这两个勾要去掉。</p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-08/1504837855404_132793.png\" title=\"\" alt=\"1504837855404_132793.png\"/></p><p><br/></p><p>3、还有可能遇到Z73工程里面的SDK版本与实际安装的版本不符合，导致编译不过的问题，修改AndroidManifest.xml文件的<br/>&lt;uses-sdk android:minSdkVersion=&quot;17&quot; <br/>&nbsp;&nbsp;&nbsp; android:targetSdkVersion=&quot;17&quot; /&gt;<br/>配置项，改成实际安装的版本。<br/><br/>4、中文注释显示乱码<br/>解决办法：右键Z73工程名，Properties-&gt;Resource，修改Text file encoding的other选项为UTF-8<br/>总之，遇到编译打包问题，先检查一下java环境变量设置，再检查与Z73工程中的设置是否符合，再用错误提示关键词去百度。<br/><br/>六、Z73由于应用程序出错，升级了一个跑不起来的应用程序，解救办法：<br/>前提是网络还能用，U盘里放一个能跑起来的apk（Z73_PRO_A4.apk）。<br/>1、先用网络连上adb：<br/>电脑上打开cmd，adb start-server跑起来，<br/>再adb connect 192.168.0.73，可能会连接不上，提示unable to connect to 192.168.0.73:5555，此时在Z73的控制台输入</p><p>&nbsp;&nbsp;&nbsp;&nbsp;setprop service.adb.tcp.port 5555</p><p>&nbsp;&nbsp;&nbsp;&nbsp;stop adbd</p><p>&nbsp;&nbsp;&nbsp;&nbsp;start adbd</p><p>就是设置5555为监听端口， 重启了adb，然后再次输入adb connect 192.168.0.73就提示connected to 192.168.0.73:5555。<br/><br/>2、adb shell进入终端，查看原来Z73应用程序的名称pm list package，显示名称为com.M73.ManageCenter<br/>3、先卸载，再安装，否则安装时会提示Failure [INSTALL_FAILED_ALREADY_EXISTS]。<br/>卸载命令：pm uninstall com.M73.ManageCenter<br/>安装命令：pm intall /mnt/usb_storage/Z73_PRO_A4.apk（或者先进入/mnt/usb_storage目录，再pm install Z73_PRO_A4.apk也可以,这个比较管用）。<br/>最后提示安装成功。</p>', 'Android', 'private', 'publish', '18', '7', '方雪嵘', 'fangxuerong@star-net.cn', '2017-09-08 10:33:39', 'fangxuerong@star-net.cn', '2017-09-08 10:39:04', '0');
INSERT INTO `article` VALUES ('A17090811072879', 'Git - 如何导入一个已有大工程', 'Git - 如何导入一个已有大工程          一、原仓库it82-sdk.tgz，解压：tar -zxvf it82-sdk.tgz得到sdk_marshmallow_rk3128目录          二、在git上建立新的项目：git@192.168.61.223:device/sdk-rk3128.git          三、在原仓库目录下，将git服务器地址改成新的地址，具体操作如下：  &nbsp;&nbsp; &nbsp;1、git remote -v&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&n...', '<p style=\"text-align: center;\">Git - 如何导入一个已有大工程</p><p><br/></p><p>一、原仓库it82-sdk.tgz，解压：tar -zxvf it82-sdk.tgz得到sdk_marshmallow_rk3128目录</p><p><br/></p><p>二、在git上建立新的项目：git@192.168.61.223:device/sdk-rk3128.git</p><p><br/></p><p>三、在原仓库目录下，将git服务器地址改成新的地址，具体操作如下：<br/>&nbsp;&nbsp; &nbsp;1、git remote -v&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//显示该仓库当前的服务器地址<br/>&nbsp;&nbsp; &nbsp;2、git remote remove origin&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//删除该仓库当前的服务器地址<br/>&nbsp;&nbsp; &nbsp;3、git remote add origin git@192.168.61.223:device/sdk-rk3128.git&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; //添加新的地址<br/>&nbsp;&nbsp; &nbsp;4、git push -u origin master&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//上传<br/>&nbsp;&nbsp; &nbsp;然后就静静的等待上传结果吧，上传完成之后，看看服务器上有代码和log信息没有，有的话就ok了。<br/></p><p><span style=\"color: rgb(255, 0, 0);\">这里需要注意的地方</span>：<br/>&nbsp;&nbsp; &nbsp;1、添加新地址的时候，使用http://192.168.61.223/device/sdk-rk3128.git&nbsp; 本来也是可以的，问题是上传的文件太大时，http回超时退出，导致上传不成功。该项目解压之后的目录大约20G，先是因为采用http地址传不上去，再改成git地址，才成功的。<br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-08/1504840466814_876508.png\" title=\"\" alt=\"1504840466814_876508.png\"/> </p><p>2、刚开始为了保留原仓库的git log信息，说是要导入log什么的，脑袋全是懵的，在百度的过程中，直到看到一篇关于git仓库迁移的文章，才发现我们要做的其实就是把一个从其他地方拷过来的git仓库迁移到我们自己的服务器上面。而最终用到的几句关键命令，在第二步新的git项目创建成功之后，网页上就已经明确提示了，只是当时没太懂，看来人家还是挺明白开发者的需求的。</p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-08/1504839940286_303021.png\" title=\"\" alt=\"1504839940286_303021.png\"/></p><p><br/></p><p>四、接下来就是各位开发成员clone新的项目到本地了。原仓库已经没用了。<br/>&nbsp;&nbsp; &nbsp;其实把远程代码拉到本地是有两种方法的：<br/>&nbsp;&nbsp; &nbsp;1、git clone git@192.168.61.223:device/sdk-rk3128.git，这个可能比较常用<br/>&nbsp;&nbsp; &nbsp;2、按照第二步中，新的git项目创建成功之后，网页上提示的操作命令：<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;mkdir sdk-rk3128<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cd sdk-rk3128<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;git init<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;touch README.md（这步可省略）<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;git add README.md（这步可省略）<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;git commit -m &quot;fist commit&quot;（这步可省略）<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;git remote add origin git@192.168.61.223:device/sdk-rk3128.git<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;git push -u origin master （这步可省略）<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;其实到git remote add就够了，中间可省略的步骤都不要，直接git pull origin master，就可以将服务器上的代码拉下来了。<br/><br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style=\"color: rgb(255, 0, 0);\">&nbsp;这里需要注意的是</span>：我们60.213这台编译服务器是多人共用的，稍不留神就可能会用到别人的git账号。<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;按照推荐的操作，是采用如下命令登陆git账号：<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;git config --global user.name &quot;XXX&quot;<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;git config --global user.email &quot;YYY@star-net.cn&quot;<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;这是将该账号设置成了全局参数，我一开始没去重新设置，结果提交上去居然显示的作者是锦乐。<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;另外一个方法是修改自己本地目录下的git 配置，方法如下，加入红色方框内的几行就可以了：<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cd sdk-rk3128<br/>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;vi .git/config</p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-08/1504839996237_463799.png\" title=\"\" alt=\"1504839996237_463799.png\"/></p><p>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 最后保存退出，这样就不会设置成全局参数了。<br/></p>', 'Git&Svn', 'private', 'publish', '32', '12', '方雪嵘', 'fangxuerong@star-net.cn', '2017-09-08 11:07:28', 'fangxuerong@star-net.cn', '2017-09-08 11:14:49', '0');
INSERT INTO `article` VALUES ('A17091309502743', '整机出厂定制软件变更流程', '需求案例：            &nbsp; &nbsp;&nbsp;睿云联定制机型  E10S  ，生产过程中先使用智慧社区的固件进行烧写和测试，在出厂前做一次软件升级切换成睿云联的应用程序。    现由于睿云联客户需求变更，要求修改出厂前升级软件版本，具体处理流程如下：                    步骤一、使用PDM 软件找出整机料号                          （需要有PDM账号并开通相关权限）                    步骤二、打开整机收集所需信息          &nbsp; &nbsp;&nbsp;            ...', '<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 20px;\"><strong>需求案例：</strong></span></p><p><img src=\"http://39.108.177.3:8080/static/ueditor/themes/default/images/spacer.gif\"/><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 20px;\">&nbsp; &nbsp;&nbsp;睿云联定制机型<span style=\"font-size: 20px; font-family: 楷体, 楷体_GB2312, SimKai;\">E10S</span>，生产过程中先使用智慧社区的固件进行烧写和测试，在出厂前做一次软件升级切换成睿云联的应用程序。</span><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 20px;\">现由于睿云联客户需求变更，要求修改出厂前升级软件版本，具体处理流程如下：</span></p><p><span style=\"font-family: 楷体, 楷体_GB2312, SimKai;\"><br/></span></p><p><strong><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">步骤一、使用PDM 软件找出整机料号</span></strong><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-18/1505705264971_342626.png\" title=\"\" alt=\"1505705264971_342626.png\"/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">（需要有PDM账号并开通相关权限）</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><strong><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">步骤二、打开整机收集所需信息</span></strong></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; &nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-09-18/1505705438830_462241.png\" title=\"\" alt=\"1505705438830_462241.png\"/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><strong><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">步骤三、发送邮件发起更新流程</span></strong></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-18/1505705794910_163715.png\" title=\"\" alt=\"1505705794910_163715.png\"/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">（需要先上传升级包到svn 下）</span></p>', 'DS3000,DS2600,DS2000', 'private', 'publish', '62', '3', '丁庆发', 'dingqingfa@star-net.cn', '2017-09-13 09:50:27', 'dingqingfa@star-net.cn', '2017-09-18 14:32:31', '0');
INSERT INTO `article` VALUES ('A17091622354801', '测试文章', '...', '<p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-16/1505575273055_532935.png\" title=\"\" alt=\"1505575273055_532935.png\"/></p>', 'DS2600', 'private', 'draft', '22', '0', '丁庆发', 'dingqingfa@star-net.cn', '2017-09-16 22:35:48', 'dingqingfa@star-net.cn', '2017-09-20 19:10:06', '1');
INSERT INTO `article` VALUES ('A17092014572768', '关于android6.0以上系统获取wifi、蓝牙MAC地址的方法', '背景问题：              &nbsp;&nbsp;&nbsp;&nbsp;在android旧的系统版本（6.0之前）中通过下述接口即可获取到蓝牙MAC            &nbsp;&nbsp;&nbsp;&nbsp;BluetoothAdapter.getDefaultAdapter().getAddress().          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;但是在6.0中普通应用仅能获取到默认的无效MAC地址：&nbsp;      02:00:00:00:00:00           ...', '<p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\"><strong><code style=\"margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 13px; line-height: inherit; font-family: Consolas, Menlo, Monaco, &#39;Lucida Console&#39;, &#39;Liberation Mono&#39;, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, &#39;Courier New&#39;, monospace, sans-serif; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(239, 240, 241);\"><span style=\"font-size: 16px;\">背景问题：</span></code></strong></p><p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\"><code style=\"margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 13px; line-height: inherit; font-family: Consolas, Menlo, Monaco, &#39;Lucida Console&#39;, &#39;Liberation Mono&#39;, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, &#39;Courier New&#39;, monospace, sans-serif; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(239, 240, 241);\"><span style=\"font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;在android旧的系统版本（6.0之前）中通过下述接口即可获取到蓝牙MAC</span></code></p><p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\"><code style=\"margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 13px; line-height: inherit; font-family: Consolas, Menlo, Monaco, &#39;Lucida Console&#39;, &#39;Liberation Mono&#39;, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, &#39;Courier New&#39;, monospace, sans-serif; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(239, 240, 241);\"><span style=\"font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;BluetoothAdapter.getDefaultAdapter().getAddress().</span></code></p><p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;但是在6.0中普通应用仅能获取到默认的无效MAC地址：&nbsp;</span><code style=\"margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 13px; line-height: inherit; font-family: Consolas, Menlo, Monaco, &#39;Lucida Console&#39;, &#39;Liberation Mono&#39;, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, &#39;Courier New&#39;, monospace, sans-serif; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(239, 240, 241);\"><span style=\"font-size: 14px;\">02:00:00:00:00:00</span></code></p><p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\"><strong><span style=\"font-size: 16px;\">解决方案：</span></strong><br/></p><p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\"><code style=\"margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 13px; line-height: inherit; font-family: Consolas, Menlo, Monaco, &#39;Lucida Console&#39;, &#39;Liberation Mono&#39;, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, &#39;Courier New&#39;, monospace, sans-serif; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(239, 240, 241);\"><span style=\"font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;</span></code><span style=\"font-size: 14px;\">要获取准确的MAC地址，</span><span style=\"font-size: 14px;\">具体方法参考 <a href=\"https://stackoverflow.com/questions/33377982/get-bluetooth-local-mac-address-in-marshmallow\">https://stackoverflow.com/questions/33377982/get-bluetooth-local-mac-address-in-marshmallow</a> </span></p><p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;链接中的方法主要就是分以下两种情况<br/></p><p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"font-size: 14px;\"></span></p><p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\"><code style=\"margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 13px; line-height: inherit; font-family: Consolas, Menlo, Monaco, &#39;Lucida Console&#39;, &#39;Liberation Mono&#39;, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, &#39;Courier New&#39;, monospace, sans-serif; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(239, 240, 241);\">&nbsp;&nbsp;&nbsp;</code><code style=\"margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 13px; line-height: inherit; font-family: Consolas, Menlo, Monaco, &#39;Lucida Console&#39;, &#39;Liberation Mono&#39;, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, &#39;Courier New&#39;, monospace, sans-serif; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(239, 240, 241);\"><span style=\"font-size: 14px;\">&nbsp;一、系统应用</span></code></p><p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\"><code style=\"margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 13px; line-height: inherit; font-family: Consolas, Menlo, Monaco, &#39;Lucida Console&#39;, &#39;Liberation Mono&#39;, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, &#39;Courier New&#39;, monospace, sans-serif; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(239, 240, 241);\"><span style=\"font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作为系统应用，可以仍然使用上述接口，但是需要在AndroidMainfest.xml中添加如下权限</span></code></p><p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\"><code style=\"margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 13px; line-height: inherit; font-family: Consolas, Menlo, Monaco, &#39;Lucida Console&#39;, &#39;Liberation Mono&#39;, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, &#39;Courier New&#39;, monospace, sans-serif; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(239, 240, 241);\"><span style=\"font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;uses-permission android:name=&quot;android.permission.LOCAL_MAC_ADDRESS&quot;/&gt;</span></code></p><p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\"><code style=\"margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 13px; line-height: inherit; font-family: Consolas, Menlo, Monaco, &#39;Lucida Console&#39;, &#39;Liberation Mono&#39;, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, &#39;Courier New&#39;, monospace, sans-serif; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(239, 240, 241);\"><span style=\"font-size: 14px;\"> &nbsp; &nbsp;二、普通应用</span></code></p><p style=\"margin-top: 0px; margin-bottom: 1em; padding: 0px; border: 0px; font-stretch: inherit; font-size: 15px; line-height: 19.5px; font-family: Arial, &#39;Helvetica Neue&#39;, Helvetica, sans-serif; vertical-align: baseline; clear: both; color: rgb(36, 39, 41); white-space: normal; background-color: rgb(255, 255, 255);\"><code style=\"margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: 13px; line-height: inherit; font-family: Consolas, Menlo, Monaco, &#39;Lucida Console&#39;, &#39;Liberation Mono&#39;, &#39;DejaVu Sans Mono&#39;, &#39;Bitstream Vera Sans Mono&#39;, &#39;Courier New&#39;, monospace, sans-serif; vertical-align: baseline; white-space: pre-wrap; background-color: rgb(239, 240, 241);\"><span style=\"font-size: 14px;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通过反射的方法获取</span></code></p>', 'DS3000,Android', 'public', 'publish', '19', '1', '黄文文', 'huangwenwen@star-net.cn', '2017-09-20 14:57:27', 'huangwenwen@star-net.cn', '2017-09-20 14:57:27', '0');
INSERT INTO `article` VALUES ('A17092016214236', 'build.gradle用于多分支打包的一些粗浅认识', '了解的甚少，这篇主要想记录第2点里面  不同分支覆盖相同  j      ava源文件的需求  ，大神们帮忙指点        AS的gradle配置很强大，可以做很多事情，基本是可以替代Manifest的节奏          1、设置基本信息    如下所示在android下可以设置API、SDK等版本，设置包名版本号等，这些不细说了    android{\r\n&nbsp;&nbsp;&nbsp;&nbsp;compileSdkVersion&nbsp;21\r\n&nbsp;&nbsp;&nbsp;&nbsp;buildToolsVersion&nbsp;&#39;23....', '<p><br/></p><p><span style=\"font-family:gotham, helvetica, arial, sans-serif;font-size:14px;\">了解的甚少，这篇主要想记录第2点里面<strong>不同分支覆盖相同<b>j</b></strong><b>ava源文件的需求</b>，大神们帮忙指点<img src=\"http://img.baidu.com/hi/tsj/t_0002.gif\"/></span></p><p>AS的gradle配置很强大，可以做很多事情，基本是可以替代Manifest的节奏</p><p><br/></p><p>1、设置基本信息</p><p>如下所示在android下可以设置API、SDK等版本，设置包名版本号等，这些不细说了</p><pre class=\"brush:java;toolbar:false\">android{\r\n&nbsp;&nbsp;&nbsp;&nbsp;compileSdkVersion&nbsp;21\r\n&nbsp;&nbsp;&nbsp;&nbsp;buildToolsVersion&nbsp;&#39;23.0.2&#39;\r\n&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;defaultConfig&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;applicationId&nbsp;&quot;com.evideo.i80&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minSdkVersion&nbsp;22\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetSdkVersion&nbsp;22\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionCode&nbsp;11645\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionName&nbsp;&quot;5.0.0&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;testInstrumentationRunner&nbsp;&quot;android.support.test.runner.AndroidJUnitRunner&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n//...\r\n}</pre><p><br/></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span></p><p>2、多分支buildTypes</p><p>buildTypes默认会有debug和release两种，可以任意添加其他分支，如I80、I100，如下所示（不打debug/release可以去掉）</p><p><br/></p><pre class=\"brush:java;toolbar:false\">android{\r\n&nbsp;&nbsp;&nbsp;&nbsp;//...\r\n&nbsp;&nbsp;&nbsp;&nbsp;buildTypes&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I80&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signingConfig&nbsp;&nbsp;signingConfigs.debug\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//buildConfigField(&quot;int&quot;,&nbsp;&quot;cloud_port&quot;,&nbsp;&quot;8888&quot;)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiDexEnabled&nbsp;true\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I100&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signingConfig&nbsp;&nbsp;signingConfigs.debug\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiDexEnabled&nbsp;true\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signingConfig&nbsp;&nbsp;signingConfigs.debug\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiDexEnabled&nbsp;true\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;release&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiDexEnabled&nbsp;true\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;//...\r\n}</pre><p><br/></p><p>每个分支底下可以配置相应属性，比如不一样的签名、混淆文件等等。</p><p>每添加一个分支，可以在源码src目录下对应添加以分支名命名的文件夹</p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894436099_042715.png\" title=\"\" alt=\"1505894436099_042715.png\"/></p><p><br/></p><p>原始默认放在main目录下，目录下包含java源文件、res、assets等，其他分支与main同级目录按相同目录结构建立</p><p>编译分支时先从分支目录下找，找不到则到main下面找，结构示例如下图</p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894458576_489574.png\" title=\"\" alt=\"1505894458576_489574.png\"/></p><p><br/></p><p>res和assets相同文件覆盖规则上没什么问题，我这边有个需求是想我<strong>两个分支只有一个HomeActivity内容不一样但想类名一样</strong>，希望根据打出不同包去对应启动不同的HomeActivity，最土的方法当然是在main那边再新加一个如NewHomeActivity，根据判断启动哪个，这种方法显得代码臃肿了，会有一些代码在打某个包情况下根本没用。</p><p><br/></p><p>所以就想我能不能main和I100分支分别有一个HomeActivity，类似资源的覆盖关系，实验结果令人失望了，因为这种分支方式其实就是编译时选择对应源码去编译了，如果两边都有这个类，在编译main分支（就是debug或release分支）时没问题，但是编译I100分支时就会存在两个HomeActivity导致类冲突了</p><p><br/></p><p>这种替换方式我是暂时没有办法，然后就用了另外一种方法，虽然不是完美，至少看着还算清晰：</p><p>就是<strong>再加一个I80分支</strong>，也就是你这个工程有多少分支就建多少分支，默认的debug和release不作为打包发布用。</p><p>然后保持main目录下只存放共有文件，如果存在差异文件，分别存放在分支上，在I80和I100分支同等目录下分别存放HomeActivity，去掉mian下面的HomeActivity（去掉后去编译main分支肯定失败，所以不作为打包用），使用时只打包对应分支，这样就达到用相同类的需求了，Manifest和main调用代码里面用到时写这个类名就行了，类里面你可以各自做自己的事情，每个分支各自独立的东西单独放，看起来比较清晰吧。</p><p><br/></p><p><br/></p><p>附：补充一下buildTypes作为部分代码判断分支的方法</p><p>buildTypes的属性在工程被构建后会生成BuildConfig.java文件（如下图），这个类在代码是可以直接使用的</p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894620339_807361.png\" title=\"\" alt=\"1505894620339_807361.png\"/></p><p>常用的BUILD_TYPE判断分支：</p><pre class=\"brush:jfx;toolbar:false\">if&nbsp;(BuildConfig.BUILD_TYPE&nbsp;==&nbsp;&quot;I80&quot;){\r\n//...\r\n}</pre><p><br/></p><p>也可以自定义成员，比如在buildTypes添加buildConfigField(&quot;int&quot;, &quot;cloud_port&quot;, &quot;8888&quot;)，后面就能使用BuildConfig.cloud_port这个成员了</p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894663216_990784.png\" title=\"\" alt=\"1505894663216_990784.png\"/></p><p><br/></p><p>3、多渠道productFlavors</p><p>这个主要用于多渠道打包，还没用到，不深入说了，可以设定一些包名渠道号友盟之类的特性</p><pre class=\"brush:java;toolbar:false\">productFlavors{\r\n&nbsp;&nbsp;&nbsp;&nbsp;yingyongbao&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dimension&nbsp;&quot;channel&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;manifestPlaceholders&nbsp;=&nbsp;[umeng_channel_value:&nbsp;&quot;yingyongbao&quot;]\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resValue(&quot;bool&quot;,&nbsp;&quot;application_log_enable&quot;,&nbsp;&quot;false&quot;)\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;evideo&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dimension&nbsp;&quot;firm&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;applicationId&nbsp;&quot;com.evideo.weiju&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionCode&nbsp;20205\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionName&nbsp;&quot;1.1.2.5&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;mag&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dimension&nbsp;&quot;firm&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;applicationId&nbsp;&quot;com.magcctv.xyyj&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionCode&nbsp;10100\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionName&nbsp;&quot;1.0.1&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p><br/></p><p>添加productFlavors是会跟buildTypes结合使用的，属于相乘组合的形式，比如上面的例子最终可以打出这些包：yingyongbaoI80，yingyongbaoI100，evideoI80，evideoI100等</p><p><br/></p><p>4、总结</p><p>gradle可以做很多事情，包括自动打包、添加混淆这些后面时间再说吧，有兴趣上网查一下玩一下，可以借鉴的有：3000SDK分支有dvp混淆jar包的，微居APP有多渠道打包的，I100有覆盖java文件（还没上传，哈哈）。</p><p>然后上面的多分支方式也可以替代此前T91S脚本切换版本的方式，有兴趣的可以去改造一下，作为练手。</p><p><br/></p><p><br/></p><p>再扔一张gradle配置示例，有图的文章好像比较漂亮</p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894930838_208708.png\" title=\"\" alt=\"1505894930838_208708.png\"/></p><p><br/></p><p><img src=\"http://img.baidu.com/hi/bobo/B_0056.gif\"/><img src=\"http://img.baidu.com/hi/tsj/t_0038.gif\"/><img src=\"http://img.baidu.com/hi/bobo/B_0021.gif\"/></p><p><br/></p><p><br/></p><p><br/></p>', 'DS3000,Java,Android', 'private', 'publish', '12', '0', '林圣腾', 'linshengteng@star-net.cn', '2017-09-20 16:21:42', 'linshengteng@star-net.cn', '2017-09-20 16:36:20', '1');
INSERT INTO `article` VALUES ('A17092016291107', '123', '了解的甚少，这篇主要想记录第2点里面  不同分支覆盖相同  j      ava源文件的需求  ，大神们帮忙指点      AS的gradle配置很强大，可以做很多事情，基本是可以替代Manifest的节奏          1、设置基本信息    如下所示在android下可以设置API、SDK等版本，设置包名版本号等，这些不细说了    android{\r\n&nbsp;&nbsp;&nbsp;&nbsp;compileSdkVersion&nbsp;21\r\n&nbsp;&nbsp;&nbsp;&nbsp;buildToolsVersion&nbsp;&#39;23.0.2&#39;...', '<p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-family: gotham, helvetica, arial, sans-serif; font-size: 14px;\">了解的甚少，这篇主要想记录第2点里面<span style=\"box-sizing: border-box; font-weight: 700;\">不同分支覆盖相同<span style=\"box-sizing: border-box;\">j</span></span><span style=\"box-sizing: border-box; font-weight: 700;\">ava源文件的需求</span>，大神们帮忙指点</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">AS的gradle配置很强大，可以做很多事情，基本是可以替代Manifest的节奏</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">1、设置基本信息</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">如下所示在android下可以设置API、SDK等版本，设置包名版本号等，这些不细说了</p><pre class=\"brush:java;toolbar:false\" style=\"box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-radius: 4px;\">android{\r\n&nbsp;&nbsp;&nbsp;&nbsp;compileSdkVersion&nbsp;21\r\n&nbsp;&nbsp;&nbsp;&nbsp;buildToolsVersion&nbsp;&#39;23.0.2&#39;\r\n&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;defaultConfig&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;applicationId&nbsp;&quot;com.evideo.i80&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minSdkVersion&nbsp;22\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetSdkVersion&nbsp;22\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionCode&nbsp;11645\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionName&nbsp;&quot;5.0.0&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;testInstrumentationRunner&nbsp;&quot;android.support.test.runner.AndroidJUnitRunner&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n//...\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\"></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">2、多分支buildTypes</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">buildTypes默认会有debug和release两种，可以任意添加其他分支，如I80、I100，如下所示（不打debug/release可以去掉）</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><pre class=\"brush:java;toolbar:false\" style=\"box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-radius: 4px;\">android{\r\n&nbsp;&nbsp;&nbsp;&nbsp;//...\r\n&nbsp;&nbsp;&nbsp;&nbsp;buildTypes&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I80&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signingConfig&nbsp;&nbsp;signingConfigs.debug\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//buildConfigField(&quot;int&quot;,&nbsp;&quot;cloud_port&quot;,&nbsp;&quot;8888&quot;)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiDexEnabled&nbsp;true\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I100&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signingConfig&nbsp;&nbsp;signingConfigs.debug\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiDexEnabled&nbsp;true\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;debug&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signingConfig&nbsp;&nbsp;signingConfigs.debug\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiDexEnabled&nbsp;true\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;release&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiDexEnabled&nbsp;true\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;//...\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">每个分支底下可以配置相应属性，比如不一样的签名、混淆文件等等。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">每添加一个分支，可以在源码src目录下对应添加以分支名命名的文件夹</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894436099_042715.png\" title=\"\" alt=\"1505894436099_042715.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">原始默认放在main目录下，目录下包含java源文件、res、assets等，其他分支与main同级目录按相同目录结构建立</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">编译分支时先从分支目录下找，找不到则到main下面找，结构示例如下图</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894458576_489574.png\" title=\"\" alt=\"1505894458576_489574.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">res和assets相同文件覆盖规则上没什么问题，我这边有个需求是想我<span style=\"box-sizing: border-box; font-weight: 700;\">两个分支只有一个HomeActivity内容不一样但想类名一样</span>，希望根据打出不同包去对应启动不同的HomeActivity，最土的方法当然是在main那边再新加一个如NewHomeActivity，根据判断启动哪个，这种方法显得代码臃肿了，会有一些代码在打某个包情况下根本没用。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">所以就想我能不能main和I100分支分别有一个HomeActivity，类似资源的覆盖关系，实验结果令人失望了，因为这种分支方式其实就是编译时选择对应源码去编译了，如果两边都有这个类，在编译main分支（就是debug或release分支）时没问题，但是编译I100分支时就会存在两个HomeActivity导致类冲突了</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">这种替换方式我是暂时没有办法，然后就用了另外一种方法，虽然不是完美，至少看着还算清晰：</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">就是<span style=\"box-sizing: border-box; font-weight: 700;\">再加一个I80分支</span>，也就是你这个工程有多少分支就建多少分支，默认的debug和release不作为打包发布用。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">然后保持main目录下只存放共有文件，如果存在差异文件，分别存放在分支上，在I80和I100分支同等目录下分别存放HomeActivity，去掉mian下面的HomeActivity（去掉后去编译main分支肯定失败，所以不作为打包用），使用时只打包对应分支，这样就达到用相同类的需求了，Manifest和main调用代码里面用到时写这个类名就行了，类里面你可以各自做自己的事情，每个分支各自独立的东西单独放，看起来比较清晰吧。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">附：补充一下buildTypes作为部分代码判断分支的方法</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">buildTypes的属性在工程被构建后会生成BuildConfig.java文件（如下图），这个类在代码是可以直接使用的</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894620339_807361.png\" title=\"\" alt=\"1505894620339_807361.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">常用的BUILD_TYPE判断分支：</p><pre class=\"brush:jfx;toolbar:false\" style=\"box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-radius: 4px;\">if&nbsp;(BuildConfig.BUILD_TYPE&nbsp;==&nbsp;&quot;I80&quot;){\r\n//...\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">也可以自定义成员，比如在buildTypes添加buildConfigField(&quot;int&quot;, &quot;cloud_port&quot;, &quot;8888&quot;)，后面就能使用BuildConfig.cloud_port这个成员了</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894663216_990784.png\" title=\"\" alt=\"1505894663216_990784.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">3、多渠道productFlavors</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">这个主要用于多渠道打包，还没用到，不深入说了，可以设定一些包名渠道号友盟之类的特性</p><pre class=\"brush:java;toolbar:false\" style=\"box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-radius: 4px;\">productFlavors{\r\n&nbsp;&nbsp;&nbsp;&nbsp;yingyongbao&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dimension&nbsp;&quot;channel&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;manifestPlaceholders&nbsp;=&nbsp;[umeng_channel_value:&nbsp;&quot;yingyongbao&quot;]\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resValue(&quot;bool&quot;,&nbsp;&quot;application_log_enable&quot;,&nbsp;&quot;false&quot;)\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;evideo&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dimension&nbsp;&quot;firm&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;applicationId&nbsp;&quot;com.evideo.weiju&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionCode&nbsp;20205\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionName&nbsp;&quot;1.1.2.5&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;mag&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dimension&nbsp;&quot;firm&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;applicationId&nbsp;&quot;com.magcctv.xyyj&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionCode&nbsp;10100\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;versionName&nbsp;&quot;1.0.1&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">添加productFlavors是会跟buildTypes结合使用的，属于相乘组合的形式，比如上面的例子最终可以打出这些包：yingyongbaoI80，yingyongbaoI100，evideoI80，evideoI100等</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">4、总结</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">gradle可以做很多事情，包括自动打包、添加混淆这些后面时间再说吧，有兴趣上网查一下玩一下，可以借鉴的有：3000SDK分支有dvp混淆jar包的，微居APP有多渠道打包的，I100有覆盖java文件（还没上传，哈哈）。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">然后上面的多分支方式也可以替代此前T91S脚本切换版本的方式，有兴趣的可以去改造一下，作为练手。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">再扔一张gradle配置示例，有图的文章好像比较漂亮</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894930838_208708.png\" title=\"\" alt=\"1505894930838_208708.png\"/></p><p><br/></p>', null, 'private', 'draft', '0', '0', '林圣腾', 'linshengteng@star-net.cn', '2017-09-20 16:29:11', 'linshengteng@star-net.cn', '2017-09-20 16:29:30', '1');
INSERT INTO `article` VALUES ('A17092016295602', '32', '...', '<pre class=\"brush:java;toolbar:false\">\r\nif（1）\r\n{\r\n\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">4、总结</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">gradle可以做很多事情，包括自动打包、添加混淆这些后面时间再说吧，有兴趣上网查一下玩一下，可以借鉴的有：3000SDK分支有dvp混淆jar包的，微居APP有多渠道打包的，I100有覆盖java文件（还没上传，哈哈）。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">然后上面的多分支方式也可以替代此前T91S脚本切换版本的方式，有兴趣的可以去改造一下，作为练手。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">再扔一张gradle配置示例，有图的文章好像比较漂亮</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p><br/></p>', null, 'private', 'draft', '0', '0', '林圣腾', 'linshengteng@star-net.cn', '2017-09-20 16:29:56', 'linshengteng@star-net.cn', '2017-09-20 16:30:52', '1');
INSERT INTO `article` VALUES ('A17092016360581', 'build.gradle用于多分支打包粗浅认识', '了解的甚少，这篇主要想记录第2点里面  不同分支覆盖相同  j  ava源文件的需求  ，大神们帮忙指点      AS的gradle配置很强大，可以做很多事情，基本是可以替代Manifest的节奏    if(qe){\r\n}    1、设置基本信息    如下所示在android下可以设置API、SDK等版本，设置包名版本号等，这些不细说了      android{          	  compileSdkVersion 21        &nbsp; &nbsp; buildToolsVersion &#39;23.0.2&#39;        &nbsp; &nbsp;...', '<p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-family: gotham, helvetica, arial, sans-serif; font-size: 14px;\">了解的甚少，这篇主要想记录第2点里面<span style=\"\">不同分支覆盖相同<span style=\"box-sizing: border-box;\">j</span>ava源文件的需求</span>，大神们帮忙指点</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">AS的gradle配置很强大，可以做很多事情，基本是可以替代Manifest的节奏</p><pre class=\"brush:cpp;toolbar:false;\">if(qe){\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">1、设置基本信息</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">如下所示在android下可以设置API、SDK等版本，设置包名版本号等，这些不细说了</p><p><span style=\"color: rgb(112, 48, 160);\">android{</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(0, 112, 192); white-space: pre;\">	</span>compileSdkVersion 21</span></p><p><span style=\"color: rgb(112, 48, 160);\">&nbsp; &nbsp; buildToolsVersion &#39;23.0.2&#39;</span></p><p><span style=\"color: rgb(112, 48, 160);\">&nbsp; &nbsp; defaultConfig {</span></p><p><span style=\"color: rgb(112, 48, 160);\">&nbsp; &nbsp; &nbsp; &nbsp; applicationId &quot;com.evideo.i80&quot;</span></p><p><span style=\"color: rgb(112, 48, 160);\">&nbsp; &nbsp; &nbsp; &nbsp; minSdkVersion 22</span></p><p><span style=\"color: rgb(112, 48, 160);\">&nbsp; &nbsp; &nbsp; &nbsp; targetSdkVersion 22</span></p><p><span style=\"color: rgb(112, 48, 160);\">&nbsp; &nbsp; &nbsp; &nbsp; versionCode 11645</span></p><p><span style=\"color: rgb(112, 48, 160);\">&nbsp; &nbsp; &nbsp; &nbsp; versionName &quot;5.0.0&quot;</span></p><p><span style=\"color: rgb(112, 48, 160);\">&nbsp; &nbsp; &nbsp; &nbsp; testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot;</span></p><p><span style=\"color: rgb(112, 48, 160);\">&nbsp; &nbsp; }</span></p><p><span style=\"color: rgb(112, 48, 160);\">//...</span></p><p><span style=\"color: rgb(112, 48, 160);\">}</span><span style=\"color: rgb(0, 112, 192); white-space: pre;\">	</span></p><p><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">2、多分支buildTypes</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">buildTypes默认会有debug和release两种，可以任意添加其他分支，如I80、I100，如下所示（不打debug/release可以去掉）</p><p><span style=\"color: rgb(112, 48, 160);\">android{</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">	</span>//...</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">	</span>buildTypes {</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">			</span>I80 {</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">				</span>signingConfig &nbsp;signingConfigs.debug</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">				</span>//buildConfigField(&quot;int&quot;, &quot;cloud_port&quot;, &quot;8888&quot;)</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">				</span>multiDexEnabled true</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">			</span>}</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">			</span>I100 {</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">				</span>signingConfig &nbsp;signingConfigs.debug</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">				</span>multiDexEnabled true</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">			</span>}</span></p><p><br/></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">			</span>debug {</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">				</span>signingConfig &nbsp;signingConfigs.debug</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">				</span>multiDexEnabled true</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">			</span>}</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">			</span>release {</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">				</span>multiDexEnabled true</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">			</span>}</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">		</span>}<span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">	</span></span></p><p><span style=\"color: rgb(112, 48, 160);\">//...</span></p><p><span style=\"color: rgb(112, 48, 160);\">}<span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">	</span></span></p><p><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">每个分支底下可以配置相应属性，比如不一样的签名、混淆文件等等。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">每添加一个分支，可以在源码src目录下对应添加以分支名命名的文件夹</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894436099_042715.png\" title=\"\" alt=\"1505894436099_042715.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">原始默认放在main目录下，目录下包含java源文件、res、assets等，其他分支与main同级目录按相同目录结构建立</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">编译分支时先从分支目录下找，找不到则到main下面找，结构示例如下图</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894458576_489574.png\" title=\"\" alt=\"1505894458576_489574.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">res和assets相同文件覆盖规则上没什么问题，我这边有个需求是想我<span style=\"box-sizing: border-box; font-weight: 700;\">两个分支只有一个HomeActivity内容不一样但想类名一样</span>，希望根据打出不同包去对应启动不同的HomeActivity，最土的方法当然是在main那边再新加一个如NewHomeActivity，根据判断启动哪个，这种方法显得代码臃肿了，会有一些代码在打某个包情况下根本没用。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">所以就想我能不能main和I100分支分别有一个HomeActivity，类似资源的覆盖关系，实验结果令人失望了，因为这种分支方式其实就是编译时选择对应源码去编译了，如果两边都有这个类，在编译main分支（就是debug或release分支）时没问题，但是编译I100分支时就会存在两个HomeActivity导致类冲突了</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">这种替换方式我是暂时没有办法，然后就用了另外一种方法，虽然不是完美，至少看着还算清晰：</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">就是<span style=\"box-sizing: border-box; font-weight: 700;\">再加一个I80分支</span>，也就是你这个工程有多少分支就建多少分支，默认的debug和release不作为打包发布用。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">然后保持main目录下只存放共有文件，如果存在差异文件，分别存放在分支上，在I80和I100分支同等目录下分别存放HomeActivity，去掉mian下面的HomeActivity（去掉后去编译main分支肯定失败，所以不作为打包用），使用时只打包对应分支，这样就达到用相同类的需求了，Manifest和main调用代码里面用到时写这个类名就行了，类里面你可以各自做自己的事情，每个分支各自独立的东西单独放，看起来比较清晰吧。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">附：补充一下buildTypes作为部分代码判断分支的方法</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">buildTypes的属性在工程被构建后会生成BuildConfig.java文件（如下图），这个类在代码是可以直接使用的</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894620339_807361.png\" title=\"\" alt=\"1505894620339_807361.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">常用的BUILD_TYPE判断分支：</p><p><span style=\"color: rgb(112, 48, 160);\">if (BuildConfig.BUILD_TYPE == &quot;I80&quot;){</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">	</span>//...</span></p><p><span style=\"color: rgb(112, 48, 160);\">}</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">也可以自定义成员，比如在buildTypes添加buildConfigField(&quot;int&quot;, &quot;cloud_port&quot;, &quot;8888&quot;)，后面就能使用BuildConfig.cloud_port这个成员了</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894663216_990784.png\" title=\"\" alt=\"1505894663216_990784.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">编译前可以在build Variants选择对应的分支：</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-21/1505990288678_302221.png\" title=\"\" alt=\"1505990288678_302221.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">打签名包时同样选择对应分支：</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-21/1505990369567_065252.png\" title=\"\" alt=\"1505990369567_065252.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">3、多渠道productFlavors</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">这个主要用于多渠道打包，还没用到，不深入说了，可以设定一些包名渠道号友盟之类的特性</p><p><span style=\"color: rgb(112, 48, 160);\">productFlavors{</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">	</span>yingyongbao {</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">		</span>dimension &quot;channel&quot;</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">		</span>manifestPlaceholders = [umeng_channel_value: &quot;yingyongbao&quot;]</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">		</span>resValue(&quot;bool&quot;, &quot;application_log_enable&quot;, &quot;false&quot;)</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">	</span>}</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">	</span>evideo {</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">		</span>dimension &quot;firm&quot;</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">		</span>applicationId &quot;com.evideo.weiju&quot;</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">		</span>versionCode 20205</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">		</span>versionName &quot;1.1.2.5&quot;</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">	</span>}</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">	</span>mag {</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">		</span>dimension &quot;firm&quot;</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">		</span>applicationId &quot;com.magcctv.xyyj&quot;</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">		</span>versionCode 10100</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">		</span>versionName &quot;1.0.1&quot;</span></p><p><span style=\"color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"color: rgb(112, 48, 160); white-space: pre;\">	</span>}</span></p><p><span style=\"color: rgb(112, 48, 160);\">}</span></p><p><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">添加productFlavors是会跟buildTypes结合使用的，属于相乘组合的形式，比如上面的例子最终可以打出这些包：yingyongbaoI80，yingyongbaoI100，evideoI80，evideoI100等</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">4、总结</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">gradle可以做很多事情，包括自动打包、添加混淆这些后面时间再说吧，有兴趣上网查一下玩一下，包括上面那些还有好多属性可以配，可以去尝试。可以借鉴的有：3000SDK分支有dvp混淆jar包的，微居APP有多渠道打包的，I100有覆盖java文件（还没上传，哈哈）。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">然后上面的多分支方式也可以替代此前T91S脚本切换版本的方式，有兴趣的可以去改造一下，作为练手。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">再扔一张gradle配置示例，有图的文章好像比较漂亮</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894930838_208708.png\" title=\"\" alt=\"1505894930838_208708.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://img.baidu.com/hi/bobo/B_0056.gif\"/><img src=\"http://img.baidu.com/hi/tsj/t_0038.gif\"/><img src=\"http://img.baidu.com/hi/bobo/B_0021.gif\"/></p><p><br/></p>', 'DS3000,Java,Android', 'private', 'draft', '50', '3', '林圣腾', 'linshengteng@star-net.cn', '2017-09-20 16:36:05', 'linshengteng@star-net.cn', '2017-11-08 14:36:09', '1');
INSERT INTO `article` VALUES ('A17092019095822', '测试', 'String&nbsp;name&nbsp;=&nbsp;&quot;kinphar.&quot;    @RequestMapping(&quot;/get&quot;)\r\n	@ResponseBody\r\n	public&nbsp;List&lt;Comment&gt;&nbsp;getComments(@RequestParam(&quot;taskid&quot;)&nbsp;String&nbsp;taskId)&nbsp;{\r\n		List&lt;Comment&gt;&nbsp;comments&nbsp;=&nbsp;commentService.getCommentByPa...', '<pre class=\"brush:java;toolbar:false\">String&nbsp;name&nbsp;=&nbsp;&quot;kinphar.&quot;</pre><pre class=\"brush:java;toolbar:false\">@RequestMapping(&quot;/get&quot;)\r\n	@ResponseBody\r\n	public&nbsp;List&lt;Comment&gt;&nbsp;getComments(@RequestParam(&quot;taskid&quot;)&nbsp;String&nbsp;taskId)&nbsp;{\r\n		List&lt;Comment&gt;&nbsp;comments&nbsp;=&nbsp;commentService.getCommentByParentId(taskId);\r\n		return&nbsp;comments;\r\n	}</pre><p>test...</p>', null, 'private', 'draft', '0', '0', '丁庆发', 'dingqingfa@star-net.cn', '2017-09-20 19:09:58', 'dingqingfa@star-net.cn', '2017-09-20 19:11:38', '1');
INSERT INTO `article` VALUES ('A17092019120112', '测试文章。', '...', '<pre class=\"brush:cpp;toolbar:false\">@RequestMapping(&quot;/get&quot;)\r\n	@ResponseBody\r\n	public&nbsp;List&lt;Comment&gt;&nbsp;getComments(@RequestParam(&quot;taskid&quot;)&nbsp;String&nbsp;taskId)&nbsp;{\r\n		List&lt;Comment&gt;&nbsp;comments&nbsp;=&nbsp;commentService.getCommentByParentId(taskId);\r\n		return&nbsp;comments;\r\n	}</pre><p><br/></p>', null, 'private', 'draft', '0', '0', '丁庆发', 'dingqingfa@star-net.cn', '2017-09-20 19:12:01', 'dingqingfa@star-net.cn', '2017-09-20 19:12:10', '1');
INSERT INTO `article` VALUES ('A17092515410473', '【出去浪】脚踩棋盘石、火烧棋盘寨-20170923', '天气不错，店家很大的门面。                向山内进发。                眼睛一闭一睁，此照差点成为ip6最后的作品。                看，有一只蜻蜓。                                  看起来现场火势很大。                炖锅出炉。                            卖相不错，缺饭一碗。                现场品鉴大师。                烤地瓜，唤起童年记忆。                他和他的西瓜雕艺术品。               ...', '<p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325171229_380923.jpg\" title=\"\" alt=\"1506325171229_380923.jpg\"/></p><p>天气不错，店家很大的门面。</p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325035660_988500.jpg\"/></p><p>向山内进发。</p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325790059_545503.jpg\" title=\"\" alt=\"1506325790059_545503.jpg\"/></p><p>眼睛一闭一睁，此照差点成为ip6最后的作品。</p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325849923_061131.jpg\" title=\"\" alt=\"1506325849923_061131.jpg\"/></p><p>看，有一只蜻蜓。</p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325911709_560491.jpg\" title=\"\" alt=\"1506325911709_560491.jpg\"/></p><p><br/></p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325034321_695539.jpg\"/></p><p>看起来现场火势很大。</p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325034394_231006.jpg\"/></p><p>炖锅出炉。</p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325034468_049224.jpg\"/></p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506326020621_768988.jpg\" title=\"\" alt=\"1506326020621_768988.jpg\"/></p><p>卖相不错，缺饭一碗。</p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325034479_465310.jpg\"/></p><p>现场品鉴大师。</p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325034549_571212.jpg\"/></p><p>烤地瓜，唤起童年记忆。</p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325036888_072320.jpg\"/></p><p>他和他的西瓜雕艺术品。</p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325034578_867713.jpg\"/></p><p>莆田系的争斗。</p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325035932_836679.jpg\"/></p><p><br/></p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-09-25/1506325035509_180611.jpg\"/></p><p>对着山竟然拍出了卖家秀的效果。</p><p><br/></p>', 'Other', 'private', 'publish', '41', '0', '丁庆发', 'dingqingfa@star-net.cn', '2017-09-25 15:41:04', 'dingqingfa@star-net.cn', '2017-09-25 16:04:41', '0');
INSERT INTO `article` VALUES ('A17092810124310', '采用Rabbitmq消息队列实现设备直连云平台', '1. 什么是RabbitMq          &nbsp; 官网：      http://www.rabbitmq.com/           &nbsp; RabbitMQ 是一个由erlang 开发的AMQP 的开源实现。        &nbsp; AMQP，即Advanced Message Queuing Protocol，是一个提供统一消息服务的应用层标准  高级消息队列协议  ，是应用层协议的一个开放标准，为面向消息的中间件设计。                  2.RabbitMq主要概念              &nbsp; Exchanges  ：pr...', '<p><strong><span style=\"font-size: 20px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">1. 什么是RabbitMq</span></strong></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; 官网：</span><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline;\"><a href=\"http://www.rabbitmq.com/\" style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline;\">http://www.rabbitmq.com/</a></span> </p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; RabbitMQ 是一个由erlang 开发的AMQP 的开源实现。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; AMQP，即Advanced Message Queuing Protocol，是一个提供统一消息服务的应用层标准<strong>高级消息队列协议</strong>，是应用层协议的一个开放标准，为面向消息的中间件设计。</span></p><p><br/></p><p><span style=\"font-size: 20px;\"><strong><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">2.RabbitMq主要概念</span></strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-weight: bold;\">&nbsp; Exchanges</span>：producer 在这里发布消息；</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-weight: bold;\">&nbsp; Queues</span>：consumer 从这里接收消息；存储还未被消费的消息；</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-weight: bold;\">&nbsp; Bindings</span>：确定从Exchanges 到特定Queue 的传输路径；</span></p><div><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-weight: bold;\">&nbsp; Connection</span>：就是一个TCP连接，Producer 和Consumer 都是通过TCP 连接到 RabbitMq server的。<br/></span></div><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-weight: bold;\">&nbsp; Channels</span>：虚拟连接，建立在TCP连接中，数据流动都是在Channel 中进行的。一个连接可创建多个通道以节省资源。一般情况下，程序起始建立TCP连接，第二步就是建立Channel。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;<strong>vhost</strong>：每个virtual host本质上都是一个RabbitMQ Server，它拥有自己的queue，exchagne，和bings rule等等。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; 在多项目系统上可实现对不同项目资源分开管理，互补影响。</span></p><p><br/></p><p><br/></p><p><strong><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 20px;\">3. RabbitMq 的系统框架</span></strong><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><br/></p><p><br/></p><p><strong><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 20px;\">4. 在T91上使用RabbitMq</span></strong></p><p><strong><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 20px;\">5. RabbitMq调试方法</span></strong></p><p><strong><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 20px;\">6. 参考资料</span></strong></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;</span><a href=\"http://blog.csdn.net/anzhsoft/article/details/19563091\" style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">http://blog.csdn.net/anzhsoft/article/details/19563091</span></a> </p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;</span></p>', 'DS3000,DS2600,DS2000,Java', 'private', 'draft', '5', '0', '丁庆发', 'dingqingfa@star-net.cn', '2017-09-28 10:12:44', 'dingqingfa@star-net.cn', '2017-09-28 11:16:54', '0');
INSERT INTO `article` VALUES ('A17101019522323', '如何更改触摸屏参数', '前言：          &nbsp;&nbsp;&nbsp;一般情况下ds2600平台的触摸屏配置参数都是由触摸屏厂商烧写配置好的，我们平台上面的只在          lichee/linux-3.4/drivers/input/touchscreen/gt9xx_ts/gt9xx_config.h b/lichee/linux-3.4/drivers/input/touchscreen/gt9xx_ts/gt9xx_config.h        该文件下做了触摸屏配置的备份，默认情况下没有生效，但有些情况下需要让触摸屏参数生效，比如：            验证某个触摸屏参...', '<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>前言：</strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;&nbsp;一般情况下ds2600平台的触摸屏配置参数都是由触摸屏厂商烧写配置好的，我们平台上面的只在<br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">lichee/linux-3.4/drivers/input/touchscreen/gt9xx_ts/gt9xx_config.h b/lichee/linux-3.4/drivers/input/touchscreen/gt9xx_ts/gt9xx_config.h</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">该文件下做了触摸屏配置的备份，默认情况下没有生效，但有些情况下需要让触摸屏参数生效，比如：</span></p><ul class=\" list-paddingleft-2\" style=\"list-style-type: disc;\"><li><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">验证某个触摸屏参数配置是否可用</span></p></li><li><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">设备厂商出厂时配置错参数 ，需要通过软件来校正参数（该情况真的存在</span><img src=\"http://img.baidu.com/hi/jx2/j_0064.gif\"/><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">）</span></p></li></ul><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><strong>配置触摸屏参数，让其生效的方法如下：</strong></span></p><ol class=\" list-paddingleft-2\" style=\"list-style-type: decimal;\"><li><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">获取所要配置的触摸屏参数（一般由触摸屏设备厂商提供）</span></p></li><li><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">查看配置文件sys_config.fex中设备对应的触摸屏参数配置数组，以X66L_1.0为例，该配置文件位于：</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">/camdroid/device/softwinner/tiger-dvp-nand/custom/x66l-1-0/001/lichee/pack_config/sys_config.fex</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">打开sys_config.fex找到ctp_name配置选项，如下</span></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-10-10/1507633836437_179970.png\" title=\"\" alt=\"1507633836437_179970.png\"/><br/></p></li><li><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">打开lichee/linux-3.4/drivers/input/touchscreen/gt9xx_ts/gt9xx_config.h b/lichee/linux-3.4/drivers/input/touchscreen/gt9xx_ts/gt9xx_config.h</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">找到第2步获取的ctp_name对应的名称&quot;gt911_tianzhiyu_x66l&quot;在gt9xx_config.h 文件中gt9xx_fw_grp所配置的数组</span></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-10-10/1507634119391_913143.png\" title=\"\" alt=\"1507634119391_913143.png\"/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">如该数组为gt911_tianzhiyu_x66l，对应配置如下</span><img src=\"http://39.108.177.3:8080/upload//images/2017-10-10/1507634211776_243339.png\" title=\"\" alt=\"1507634211776_243339.png\"/></p><p><br/></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">将第1步获取的触摸屏参数填入到所对应的gt911_tianzhiyu_x66l[]数组中</span></p></li><li><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">由于默认情况下触摸屏参数配置是不生效的，更改lichee/linux-3.4/drivers/input/touchscreen/gt9xx_ts/gt9xx.h配置文件中</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">GTP_DRIVER_SEND_CFG为1，让触摸屏配置生效</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><img src=\"http://39.108.177.3:8080/upload//images/2017-10-10/1507636175357_609321.png\" title=\"\" alt=\"1507636175357_609321.png\"/></span></p></li><li><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">mkall 后打包固，烧写至设备，配置生效</span></p></li><li><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;如何查看当前的设备的触摸屏参数</span></p></li><ol class=\" list-paddingleft-2\" style=\"list-style-type: lower-alpha;\"><li><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">默认情况下GTP_DRIVER_SEND_CFG为0，则可以直接在设备端 cat /proc/kmsg&nbsp;</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">打印信息中查看GTP&nbsp;read&nbsp;param: 后面对应的参数，即为当前的配置触摸屏参数</span></p></li><li><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">当我们需要配置触摸屏参数让其生效时，在第5步中将GTP_DRIVER_SEND_CFG设置为1了，则kmsg中无法显示触摸屏参数，需要先将第6步打好的包烧进设备后，让配置生效了 ，然后将GTP_DRIVER_SEND_CFG设置为0，重新编译，将生成的gt9xx_ts.ko文件，路径如下</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">camdroid/out/target/product/tiger-dvp-nand/system/vendor/modules/gt9xx_ts.ko</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">将gt9xx_ts.ko文件替换到设备中，重启设备，此时，GTP_DRIVER_SEND_CFG为0，同a步一样，在kmsg中可以查看当前的配置触摸屏参数，对比是否与自己所设置的参数一致</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">如我们设备的配置参数如下：</span><img src=\"http://39.108.177.3:8080/upload//images/2017-10-10/1507635710910_771186.png\" title=\"\" alt=\"1507635710910_771186.png\"/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">查看kmsg中的参数如下：<br/></span></p><div><img src=\"http://39.108.177.3:8080/static/ueditor/themes/default/images/spacer.gif\"/></div></li><img src=\"http://39.108.177.3:8080/upload//images/2017-10-10/1507635773387_191576.png\" title=\"\" alt=\"1507635773387_191576.png\"/><br/><br/></ol><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; &nbsp;可以发现参数配置成功了</span><ol class=\" list-paddingleft-2\" style=\"list-style-type: lower-alpha;\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">ps：开头会有固定的字节80、47，末尾也会有多出一些数据，属正常情况</span></ol><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"></span></ol><p><br/></p><p><br/></p>', 'DS2600', 'private', 'publish', '25', '7', '李晴', 'liqing@star-net.cn', '2017-10-10 19:52:24', 'liqing@star-net.cn', '2017-10-10 19:52:24', '0');
INSERT INTO `article` VALUES ('A17102614530227', '', 'file.html  \r\n  @font-face { font-family: octicons-link; src: url(\"data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAA...', '<!DOCTYPE html><html><head><meta charset=\"utf-8\">\r\n<title>file.html</title>\r\n<style>@font-face { font-family: octicons-link; src: url(\"data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==\") format(\"woff\"); }.markdown-body { text-size-adjust: 100%; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\"; font-size: 16px; line-height: 1.5; word-wrap: break-word; }.markdown-body .pl-c { color: rgb(106, 115, 125); }.markdown-body .pl-c1, .markdown-body .pl-s .pl-v { color: rgb(0, 92, 197); }.markdown-body .pl-e, .markdown-body .pl-en { color: rgb(111, 66, 193); }.markdown-body .pl-smi, .markdown-body .pl-s .pl-s1 { color: rgb(36, 41, 46); }.markdown-body .pl-ent { color: rgb(34, 134, 58); }.markdown-body .pl-k { color: rgb(215, 58, 73); }.markdown-body .pl-s, .markdown-body .pl-pds, .markdown-body .pl-s .pl-pse .pl-s1, .markdown-body .pl-sr, .markdown-body .pl-sr .pl-cce, .markdown-body .pl-sr .pl-sre, .markdown-body .pl-sr .pl-sra { color: rgb(3, 47, 98); }.markdown-body .pl-v, .markdown-body .pl-smw { color: rgb(227, 98, 9); }.markdown-body .pl-bu { color: rgb(179, 29, 40); }.markdown-body .pl-ii { color: rgb(250, 251, 252); background-color: rgb(179, 29, 40); }.markdown-body .pl-c2 { color: rgb(250, 251, 252); background-color: rgb(215, 58, 73); }.markdown-body .pl-c2::before { content: \"^M\"; }.markdown-body .pl-sr .pl-cce { font-weight: bold; color: rgb(34, 134, 58); }.markdown-body .pl-ml { color: rgb(115, 92, 15); }.markdown-body .pl-mh, .markdown-body .pl-mh .pl-en, .markdown-body .pl-ms { font-weight: bold; color: rgb(0, 92, 197); }.markdown-body .pl-mi { font-style: italic; color: rgb(36, 41, 46); }.markdown-body .pl-mb { font-weight: bold; color: rgb(36, 41, 46); }.markdown-body .pl-md { color: rgb(179, 29, 40); background-color: rgb(255, 238, 240); }.markdown-body .pl-mi1 { color: rgb(34, 134, 58); background-color: rgb(240, 255, 244); }.markdown-body .pl-mc { color: rgb(227, 98, 9); background-color: rgb(255, 235, 218); }.markdown-body .pl-mi2 { color: rgb(246, 248, 250); background-color: rgb(0, 92, 197); }.markdown-body .pl-mdr { font-weight: bold; color: rgb(111, 66, 193); }.markdown-body .pl-ba { color: rgb(88, 96, 105); }.markdown-body .pl-sg { color: rgb(149, 157, 165); }.markdown-body .pl-corl { text-decoration: underline; color: rgb(3, 47, 98); }.markdown-body .octicon { display: inline-block; vertical-align: text-top; fill: currentcolor; }.markdown-body a { background-color: transparent; }.markdown-body a:active, .markdown-body a:hover { outline-width: 0px; }.markdown-body strong { font-weight: inherit; }.markdown-body strong { font-weight: bolder; }.markdown-body h1 { font-size: 2em; margin: 0.67em 0px; }.markdown-body img { border-style: none; }.markdown-body svg:not(:root) { overflow: hidden; }.markdown-body code, .markdown-body kbd, .markdown-body pre { font-family: monospace, monospace; font-size: 1em; }.markdown-body hr { box-sizing: content-box; height: 0px; overflow: visible; }.markdown-body input { font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; margin: 0px; }.markdown-body input { overflow: visible; }.markdown-body [type=\"checkbox\"] { box-sizing: border-box; padding: 0px; }.markdown-body * { box-sizing: border-box; }.markdown-body input { font-family: inherit; font-size: inherit; line-height: inherit; }.markdown-body a { color: rgb(3, 102, 214); text-decoration: none; }.markdown-body a:hover { text-decoration: underline; }.markdown-body strong { font-weight: 600; }.markdown-body hr { height: 0px; margin: 15px 0px; overflow: hidden; background: transparent; border-width: 0px 0px 1px; border-top-style: initial; border-right-style: initial; border-left-style: initial; border-top-color: initial; border-right-color: initial; border-left-color: initial; border-image: initial; border-bottom-style: solid; border-bottom-color: rgb(223, 226, 229); }.markdown-body hr::before { display: table; content: \"\"; }.markdown-body hr::after { display: table; clear: both; content: \"\"; }.markdown-body table { border-spacing: 0px; border-collapse: collapse; }.markdown-body td, .markdown-body th { padding: 0px; }.markdown-body h1, .markdown-body h2, .markdown-body h3, .markdown-body h4, .markdown-body h5, .markdown-body h6 { margin-top: 0px; margin-bottom: 0px; }.markdown-body h1 { font-size: 32px; font-weight: 600; }.markdown-body h2 { font-size: 24px; font-weight: 600; }.markdown-body h3 { font-size: 20px; font-weight: 600; }.markdown-body h4 { font-size: 16px; font-weight: 600; }.markdown-body h5 { font-size: 14px; font-weight: 600; }.markdown-body h6 { font-size: 12px; font-weight: 600; }.markdown-body p { margin-top: 0px; margin-bottom: 10px; }.markdown-body blockquote { margin: 0px; }.markdown-body ul, .markdown-body ol { padding-left: 0px; margin-top: 0px; margin-bottom: 0px; }.markdown-body ol ol, .markdown-body ul ol { list-style-type: lower-roman; }.markdown-body ul ul ol, .markdown-body ul ol ol, .markdown-body ol ul ol, .markdown-body ol ol ol { list-style-type: lower-alpha; }.markdown-body dd { margin-left: 0px; }.markdown-body code { font-family: SFMono-Regular, Consolas, \"Liberation Mono\", Menlo, Courier, monospace; font-size: 12px; }.markdown-body pre { margin-top: 0px; margin-bottom: 0px; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 12px; line-height: normal; font-family: SFMono-Regular, Consolas, \"Liberation Mono\", Menlo, Courier, monospace; }.markdown-body .octicon { vertical-align: text-bottom; }.markdown-body .pl-0 { padding-left: 0px !important; }.markdown-body .pl-1 { padding-left: 4px !important; }.markdown-body .pl-2 { padding-left: 8px !important; }.markdown-body .pl-3 { padding-left: 16px !important; }.markdown-body .pl-4 { padding-left: 24px !important; }.markdown-body .pl-5 { padding-left: 32px !important; }.markdown-body .pl-6 { padding-left: 40px !important; }.markdown-body::before { display: table; content: \"\"; }.markdown-body::after { display: table; clear: both; content: \"\"; }.markdown-body > :first-child { margin-top: 0px !important; }.markdown-body > :last-child { margin-bottom: 0px !important; }.markdown-body a:not([href]) { color: inherit; text-decoration: none; }.markdown-body .anchor { float: left; padding-right: 4px; margin-left: -20px; line-height: 1; }.markdown-body .anchor:focus { outline: none; }.markdown-body p, .markdown-body blockquote, .markdown-body ul, .markdown-body ol, .markdown-body dl, .markdown-body table, .markdown-body pre { margin-top: 0px; margin-bottom: 16px; }.markdown-body hr { height: 0.25em; padding: 0px; margin: 24px 0px; background-color: rgb(225, 228, 232); border: 0px; }.markdown-body blockquote { padding: 0px 1em; color: rgb(106, 115, 125); border-left: 0.25em solid rgb(223, 226, 229); }.markdown-body blockquote > :first-child { margin-top: 0px; }.markdown-body blockquote > :last-child { margin-bottom: 0px; }.markdown-body kbd { display: inline-block; padding: 3px 5px; font-size: 11px; line-height: 10px; color: rgb(68, 77, 86); vertical-align: middle; background-color: rgb(250, 251, 252); border-width: 1px; border-style: solid; border-color: rgb(198, 203, 209) rgb(198, 203, 209) rgb(149, 157, 165); border-image: initial; border-radius: 3px; box-shadow: rgb(149, 157, 165) 0px -1px 0px inset; }.markdown-body h1, .markdown-body h2, .markdown-body h3, .markdown-body h4, .markdown-body h5, .markdown-body h6 { margin-top: 24px; margin-bottom: 16px; font-weight: 600; line-height: 1.25; }.markdown-body h1 .octicon-link, .markdown-body h2 .octicon-link, .markdown-body h3 .octicon-link, .markdown-body h4 .octicon-link, .markdown-body h5 .octicon-link, .markdown-body h6 .octicon-link { color: rgb(27, 31, 35); vertical-align: middle; visibility: hidden; }.markdown-body h1:hover .anchor, .markdown-body h2:hover .anchor, .markdown-body h3:hover .anchor, .markdown-body h4:hover .anchor, .markdown-body h5:hover .anchor, .markdown-body h6:hover .anchor { text-decoration: none; }.markdown-body h1:hover .anchor .octicon-link, .markdown-body h2:hover .anchor .octicon-link, .markdown-body h3:hover .anchor .octicon-link, .markdown-body h4:hover .anchor .octicon-link, .markdown-body h5:hover .anchor .octicon-link, .markdown-body h6:hover .anchor .octicon-link { visibility: visible; }.markdown-body h1 { padding-bottom: 0.3em; font-size: 2em; border-bottom: 1px solid rgb(234, 236, 239); }.markdown-body h2 { padding-bottom: 0.3em; font-size: 1.5em; border-bottom: 1px solid rgb(234, 236, 239); }.markdown-body h3 { font-size: 1.25em; }.markdown-body h4 { font-size: 1em; }.markdown-body h5 { font-size: 0.875em; }.markdown-body h6 { font-size: 0.85em; color: rgb(106, 115, 125); }.markdown-body ul, .markdown-body ol { padding-left: 2em; }.markdown-body ul ul, .markdown-body ul ol, .markdown-body ol ol, .markdown-body ol ul { margin-top: 0px; margin-bottom: 0px; }.markdown-body li > p { margin-top: 16px; }.markdown-body li + li { margin-top: 0.25em; }.markdown-body dl { padding: 0px; }.markdown-body dl dt { padding: 0px; margin-top: 16px; font-size: 1em; font-style: italic; font-weight: 600; }.markdown-body dl dd { padding: 0px 16px; margin-bottom: 16px; }.markdown-body table { display: block; width: 100%; overflow: auto; }.markdown-body table th { font-weight: 600; }.markdown-body table th, .markdown-body table td { padding: 6px 13px; border: 1px solid rgb(223, 226, 229); }.markdown-body table tr { background-color: rgb(255, 255, 255); border-top: 1px solid rgb(198, 203, 209); }.markdown-body table tr:nth-child(2n) { background-color: rgb(246, 248, 250); }.markdown-body img { max-width: 100%; box-sizing: content-box; background-color: rgb(255, 255, 255); }.markdown-body code { padding: 0.2em 0px; margin: 0px; font-size: 85%; background-color: rgba(27, 31, 35, 0.05); border-radius: 3px; }.markdown-body code::before, .markdown-body code::after { letter-spacing: -0.2em; content: \" \"; }.markdown-body pre { word-wrap: normal; }.markdown-body pre > code { padding: 0px; margin: 0px; font-size: 100%; word-break: normal; white-space: pre; background: transparent; border: 0px; }.markdown-body .highlight { margin-bottom: 16px; }.markdown-body .highlight pre { margin-bottom: 0px; word-break: normal; }.markdown-body .highlight pre, .markdown-body pre { padding: 16px; overflow: auto; font-size: 85%; line-height: 1.45; background-color: rgb(246, 248, 250); border-radius: 3px; }.markdown-body pre code { display: inline; padding: 0px; margin: 0px; overflow: visible; line-height: inherit; word-wrap: normal; background-color: transparent; border: 0px; }.markdown-body pre code::before, .markdown-body pre code::after { content: normal; }.markdown-body .full-commit .btn-outline:not(:disabled):hover { color: rgb(0, 92, 197); border-color: rgb(0, 92, 197); }.markdown-body kbd { display: inline-block; padding: 3px 5px; font-style: normal; font-variant: normal; font-weight: normal; font-stretch: normal; font-size: 11px; font-family: SFMono-Regular, Consolas, \"Liberation Mono\", Menlo, Courier, monospace; line-height: 10px; color: rgb(68, 77, 86); vertical-align: middle; background-color: rgb(250, 251, 252); border-width: 1px; border-style: solid; border-color: rgb(209, 213, 218) rgb(209, 213, 218) rgb(198, 203, 209); border-image: initial; border-radius: 3px; box-shadow: rgb(198, 203, 209) 0px -1px 0px inset; }.markdown-body :checked + .radio-label { position: relative; z-index: 1; border-color: rgb(3, 102, 214); }.markdown-body .task-list-item { list-style-type: none; }.markdown-body .task-list-item + .task-list-item { margin-top: 3px; }.markdown-body .task-list-item input { margin: 0px 0.2em 0.25em -1.6em; vertical-align: middle; }.markdown-body hr { border-bottom-color: rgb(238, 238, 238); }.markdown-body .warning { background-color: rgb(255, 255, 136); padding: 20px; border-radius: 6px; }.markdown-body pre code, .hljs { color: rgb(169, 183, 198); background: rgb(40, 43, 46); display: block; overflow-x: auto; padding: 0.5em; }.hljs-number, .hljs-literal, .hljs-symbol, .hljs-bullet { color: rgb(104, 151, 187); }.hljs-keyword, .hljs-selector-tag, .hljs-deletion { color: rgb(204, 120, 50); }.hljs-variable, .hljs-template-variable, .hljs-link { color: rgb(98, 151, 85); }.hljs-comment, .hljs-quote { color: rgb(128, 128, 128); }.hljs-meta { color: rgb(187, 181, 41); }.hljs-string, .hljs-attribute, .hljs-addition { color: rgb(106, 135, 89); }.hljs-section, .hljs-title, .hljs-type { color: rgb(255, 198, 109); }.hljs-name, .hljs-selector-id, .hljs-selector-class { color: rgb(232, 191, 106); }.hljs-emphasis { font-style: italic; }.hljs-strong { font-weight: bold; }</style>\r\n</head><body>\r\n<div id=\"preview\" class=\"markdown-body\">\r\n    <div cc-preview=\"\"><pre><code class=\"hljs language-c\"><span class=\"hljs-comment\">/*\r\n * =====================================================================================\r\n *\r\n *       Filename:  i2c_test.c\r\n *\r\n *    Description:  communication with n79e814a \r\n *\r\n *        Version:  1.0\r\n *        Created:  2015/10/22 15:10\r\n *       Revision:  none\r\n *       Compiler:  gcc\r\n *\r\n *         Author:  wangjl (), \r\n *        Company:  \r\n *\r\n * =====================================================================================\r\n */</span>\r\n\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;stdio.h&gt;  </span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;linux/i2c.h&gt;  </span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;linux/i2c-dev.h&gt;  </span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;fcntl.h&gt;  </span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;stdlib.h&gt;  </span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;unistd.h&gt;  </span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;sys/ioctl.h&gt;  </span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;string.h&gt; </span></span>\r\n\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">define</span>	I2C_DEV     <span class=\"hljs-meta-string\">\"/dev/i2c-1\"</span>			<span class=\"hljs-comment\">/*  */</span></span>\r\n\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">define</span> N79E814_I2C_ADDR    (0xA4 &gt;&gt; 1)</span>\r\n\r\n<span class=\"hljs-comment\">/* --------------------------------------------------------------------------*/</span>\r\n<span class=\"hljs-comment\">/**\r\n * @Brief  i2c_read\r\n *\r\n * @Param fd\r\n * @Param slave_addr：从设备的I2C 地址\r\n * @Param reg\r\n * @Param data: 读取后数据存放位置\r\n * @Param data_byte_count : 要读取几个字节\r\n *\r\n * @Returns   \r\n */</span>\r\n<span class=\"hljs-comment\">/* ----------------------------------------------------------------------------*/</span>\r\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">i2c_read</span> <span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> fd, <span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">char</span> slave_addr, <span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">char</span> reg, <span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">char</span>* data, <span class=\"hljs-keyword\">int</span> data_byte_count )</span>\r\n</span>{\r\n    <span class=\"hljs-class\"><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title\">i2c_rdwr_ioctl_data</span> <span class=\"hljs-title\">packets</span>;</span>\r\n    <span class=\"hljs-class\"><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title\">i2c_msg</span> <span class=\"hljs-title\">messages</span>[2];</span>\r\n\r\n    messages[<span class=\"hljs-number\">0</span>].addr = slave_addr;\r\n    messages[<span class=\"hljs-number\">0</span>].flags = <span class=\"hljs-number\">0</span>;\r\n    messages[<span class=\"hljs-number\">0</span>].buf = &amp;reg;\r\n    messages[<span class=\"hljs-number\">0</span>].len = <span class=\"hljs-number\">1</span>;\r\n\r\n    messages[<span class=\"hljs-number\">1</span>].addr = slave_addr;\r\n    messages[<span class=\"hljs-number\">1</span>].flags = I2C_M_RD;\r\n    messages[<span class=\"hljs-number\">1</span>].buf = data;\r\n    messages[<span class=\"hljs-number\">1</span>].len = data_byte_count;\r\n\r\n    packets.msgs      = messages;  \r\n    packets.nmsgs     = <span class=\"hljs-number\">2</span>;\r\n\r\n    <span class=\"hljs-keyword\">if</span>(ioctl(fd, I2C_RDWR, &amp;packets) &lt; <span class=\"hljs-number\">0</span>) {  \r\n        perror(<span class=\"hljs-string\">\"Unable to send data\"</span>);  \r\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">1</span>;  \r\n    } \r\n\r\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;\r\n}		<span class=\"hljs-comment\">/* -----  end of function i2c_read  ----- */</span>\r\n\r\n<span class=\"hljs-comment\">/* --------------------------------------------------------------------------*/</span>\r\n<span class=\"hljs-comment\">/**\r\n * @Brief  \r\n *\r\n * @Param fd\r\n * @Param slave_addr:  slave i2c address\r\n * @Param reg:   write @data to this register or address\r\n * @Param data: \r\n * @Param data_byte_count: count the @data len with byte\r\n *\r\n * @Returns   \r\n */</span>\r\n<span class=\"hljs-comment\">/* ----------------------------------------------------------------------------*/</span>\r\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">i2c_write</span> <span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> fd, <span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">char</span> slave_addr, <span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">char</span> reg, \\\r\n        <span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">char</span>* data, <span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">char</span> data_byte_count )</span>\r\n</span>{\r\n    <span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">char</span> outbuf[I2C_RDRW_IOCTL_MAX_MSGS];\r\n    <span class=\"hljs-class\"><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title\">i2c_rdwr_ioctl_data</span> <span class=\"hljs-title\">packets</span>;</span>  \r\n    <span class=\"hljs-class\"><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title\">i2c_msg</span> <span class=\"hljs-title\">messages</span>[1];</span>  \r\n\r\n    <span class=\"hljs-keyword\">if</span>(data_byte_count &lt;= I2C_RDRW_IOCTL_MAX_MSGS){\r\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">-2</span>;\r\n    }\r\n\r\n    messages[<span class=\"hljs-number\">0</span>].addr  = slave_addr;  \r\n    messages[<span class=\"hljs-number\">0</span>].flags = <span class=\"hljs-number\">0</span>;  \r\n    messages[<span class=\"hljs-number\">0</span>].len   = data_byte_count + <span class=\"hljs-number\">1</span>;  \r\n    messages[<span class=\"hljs-number\">0</span>].buf   = outbuf;  \r\n\r\n    <span class=\"hljs-comment\">/* The first byte indicates which register we\'ll write */</span>  \r\n    outbuf[<span class=\"hljs-number\">0</span>] = reg;  \r\n\r\n    <span class=\"hljs-comment\">/*  \r\n     *  The second byte indicates the value to write.  Note that for many \r\n     *  devices, we can write multiple, sequential registers at once by \r\n     *  simply making outbuf bigger. \r\n     */</span>  \r\n    <span class=\"hljs-built_in\">memcpy</span>(outbuf + <span class=\"hljs-number\">1</span>, data, data_byte_count);\r\n\r\n    packets.msgs  = messages;  \r\n    packets.nmsgs = <span class=\"hljs-number\">1</span>;  \r\n\r\n    <span class=\"hljs-keyword\">if</span>(ioctl(fd, I2C_RDWR, &amp;packets) &lt; <span class=\"hljs-number\">0</span>) {  \r\n        perror(<span class=\"hljs-string\">\"Unable to send data\"</span>);  \r\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">-1</span>;  \r\n    }\r\n\r\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;\r\n}		<span class=\"hljs-comment\">/* -----  end of function i2c_write  ----- */</span>    \r\n\r\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">n79e814_version_read</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">void</span>)</span>\r\n</span>{\r\n    <span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">char</span> data[<span class=\"hljs-number\">2</span>] = {<span class=\"hljs-number\">0</span>};\r\n    <span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">char</span> reg = <span class=\"hljs-number\">0</span>;\r\n    <span class=\"hljs-keyword\">int</span> ret = <span class=\"hljs-number\">0</span>;\r\n\r\n    <span class=\"hljs-keyword\">int</span> fd = open(I2C_DEV, O_RDWR);\r\n    <span class=\"hljs-keyword\">if</span>(fd &lt; <span class=\"hljs-number\">0</span>){\r\n        perror(<span class=\"hljs-string\">\"Unable to open i2c control file\"</span>);  \r\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">-1</span>;\r\n    }<span class=\"hljs-keyword\">else</span>{\r\n        <span class=\"hljs-built_in\">printf</span> ( <span class=\"hljs-string\">\"open %s success\\n\"</span>, I2C_DEV);\r\n    }\r\n\r\n    reg = <span class=\"hljs-number\">0x09</span>;\r\n    ret = i2c_read(fd, N79E814_I2C_ADDR, reg, data, <span class=\"hljs-number\">2</span>);\r\n    <span class=\"hljs-keyword\">if</span>(ret == <span class=\"hljs-number\">0</span>){\r\n        <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">\"n79e814a version is -&gt;  %d.%d \\n\"</span>, data[<span class=\"hljs-number\">0</span>], data[<span class=\"hljs-number\">1</span>]); \r\n    }<span class=\"hljs-keyword\">else</span>{\r\n        <span class=\"hljs-built_in\">printf</span> ( <span class=\"hljs-string\">\"read version fail\\n\"</span> );\r\n    }\r\n\r\n    <span class=\"hljs-keyword\">return</span> ret;\r\n}\r\n\r\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">main</span> <span class=\"hljs-params\">( <span class=\"hljs-keyword\">int</span> argc, <span class=\"hljs-keyword\">char</span> *argv[] )</span>\r\n</span>{\r\n\r\n    <span class=\"hljs-keyword\">int</span> ret = n79e814_version_read();\r\n\r\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;\r\n}				<span class=\"hljs-comment\">/* ----------  end of function main  ---------- */</span>\r\n\r\n</code></pre>\r\n</div>\r\n  </div>\r\n</body></html>', null, 'private', 'draft', '0', '0', '王锦乐', 'wangjinle@star-net.cn', '2017-10-26 14:53:02', 'wangjinle@star-net.cn', '2017-10-26 14:53:02', '0');
INSERT INTO `article` VALUES ('A17110611163200', '2017深圳安博会观后感', '原计划是去全志排查DS2600的问题，碰巧赶上安博会，蹭了一会儿。                          第一天          参加瑞为智能安防方案推介会（T91人脸识别的方案商），了解该公司当前主推的一些安防产品，其中印象比较深的有下面几个：        1. 用于治安维稳的人脸追踪系统，可以根据目标人物的人脸分析并在地图上显示其行径路线。        找人变容易了，隐私没了，出门带口罩是个不错的选择。                    2. 由于人脸识别放后端成本很大，目前这个行业里面的趋势是识别算法前移，即在摄像头里面加入人脸算法模块。        ...', '<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px;\"><strong>原计划是去全志排查DS2600的问题，碰巧赶上安博会，蹭了一会儿。</strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 24px;\"><strong><br/></strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 24px;\"><strong>第一天</strong></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">参加瑞为智能安防方案推介会（T91人脸识别的方案商），了解该公司当前主推的一些安防产品，其中印象比较深的有下面几个：</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">1. 用于治安维稳的人脸追踪系统，可以根据目标人物的人脸分析并在地图上显示其行径路线。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">找人变容易了，隐私没了，出门带口罩是个不错的选择。</span></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509948875932_161401.png\" title=\"\" alt=\"1509948875932_161401.png\"/></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">2. 由于人脸识别放后端成本很大，目前这个行业里面的趋势是识别算法前移，即在摄像头里面加入人脸算法模块。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">瑞为主推的是FPGA方案，具有高并发、低功耗特点。行业概念“AI+安防：智能前移是必然”。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">瑞为的星光级人脸抓拍枪型产品（RN-FC-P11-01）支持逐帧人脸检测，单帧最大人脸数为32个。<br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">也开始做硬件了。</span></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509949941795_579439.png\" title=\"1509949941795_579439.png\" alt=\"1509949941795_579439.png\" width=\"720\" height=\"380\"/></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">3. 人证合一应用场景，用于判断证件关联的人脸与当前证件使用者的人脸是否相同。“证明你是不是你”。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">得益于厦门政府对瑞为的支持，目前厦门大部分码头都在用这套系统。但是稳定性还不是太好，他们的测试妹子都驻点到码头。</span></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509950810236_125578.png\" title=\"1509950810236_125578.png\" alt=\"1509950810236_125578.png\" width=\"800\" height=\"405\"/></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">4. 人脸识别于立林智慧社区方案的应用，上去了一个立林院长，说是讲人脸应用实际更像是为自己打广告的。</span></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509951203033_353369.png\" title=\"1509951203033_353369.png\" alt=\"1509951203033_353369.png\" width=\"800\" height=\"420\"/></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">讲台：</span></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509948663196_900836.png\" title=\"1509948663196_900836.png\" alt=\"1509948663196_900836.png\" width=\"680\" height=\"260\"/></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">以下图册可以做进一步了解</span></p><p style=\"line-height: 16px;\"><img src=\"http://39.108.177.3:8080/static/ueditor/dialogs/attachment/fileTypeImages/icon_pdf.gif\"/><a style=\"font-size: 12px; color: rgb(0, 102, 204); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline;\" href=\"http://39.108.177.3:8080/upload//files/2017-11-06/140331/瑞为智能安防宣传册2017年.pdf\" title=\"瑞为智能安防宣传册2017年.pdf\"><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">瑞为智能安防宣传册2017年.pdf</span></a></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 24px;\"><strong>第二天</strong></span></p><p><span style=\"font-family:微软雅黑, Microsoft YaHei\">逛安博会场，时间比较仓促，逛了差不多2个小时。</span></p><p><span style=\"font-family:微软雅黑, Microsoft YaHei\">楼宇对讲终端没什么变化，人脸识别已经很普遍。</span></p><p><span style=\"font-family:微软雅黑, Microsoft YaHei\">主要趋势是 AI+安防 实现各种智能识别，防范于未然。</span></p><p><span style=\"font-family:微软雅黑, Microsoft YaHei\">拍了一些室内机照片可用于后续新产品参考。</span></p><p><span style=\"font-family:微软雅黑, Microsoft YaHei\">一堆插图。。。</span></p><p><br/></p><p><span style=\"font-family:微软雅黑, Microsoft YaHei\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509951573284_265348.png\" title=\"\" alt=\"1509951573284_265348.png\"/></span></p><p><span style=\"font-family:微软雅黑, Microsoft YaHei\"><br/></span></p><p><span style=\"font-family:微软雅黑, Microsoft YaHei\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509951635666_745011.png\" title=\"\" alt=\"1509951635666_745011.png\"/></span></p><p><span style=\"font-family:微软雅黑, Microsoft YaHei\"><br/></span></p><p><span style=\"font-family:微软雅黑, Microsoft YaHei\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509952023425_917347.png\" title=\"\" alt=\"1509952023425_917347.png\"/></span></p><p><span style=\"font-family:微软雅黑, Microsoft YaHei\"><br/></span></p><p><span style=\"font-family:微软雅黑, Microsoft YaHei\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509952063745_113962.png\" title=\"\" alt=\"1509952063745_113962.png\"/></span></p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509952209823_241884.png\" title=\"\" alt=\"1509952209823_241884.png\"/>、</p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509952650576_821212.png\" title=\"\" alt=\"1509952650576_821212.png\"/></p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509952247405_973494.png\" title=\"\" alt=\"1509952247405_973494.png\"/></p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509952299944_315674.png\" title=\"\" alt=\"1509952299944_315674.png\"/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509952383446_026847.png\" title=\"\" alt=\"1509952383446_026847.png\"/></p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509953140865_675332.png\" title=\"\" alt=\"1509953140865_675332.png\"/></p><p><br/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509952863365_735881.png\" title=\"\" alt=\"1509952863365_735881.png\"/></p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-06/1509952923415_796353.png\" title=\"\" alt=\"1509952923415_796353.png\"/></p><p><br/></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">没了~<img src=\"http://img.baidu.com/hi/jx2/j_0028.gif\"/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p>', 'Other', 'private', 'publish', '35', '1', '丁庆发', 'dingqingfa@star-net.cn', '2017-11-06 11:16:33', 'dingqingfa@star-net.cn', '2017-11-06 15:32:57', '0');
INSERT INTO `article` VALUES ('A17110814385658', 'build.gradle用于多分支打包粗浅认识', '了解的甚少，这篇主要想记录第2点里面  不同分支覆盖相同  j  ava源文件的需求  ，大神们帮忙指点      AS的gradle配置很强大，可以做很多事情，基本是可以替代Manifest的节奏          1、设置基本信息    如下所示在android下可以设置API、SDK等版本，设置包名版本号等，这些不细说了      android{          	  compileSdkVersion 21        &nbsp; &nbsp; buildToolsVersion &#39;23.0.2&#39;        &nbsp; &nbsp; default...', '<p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-family: gotham, helvetica, arial, sans-serif; font-size: 14px;\">了解的甚少，这篇主要想记录第2点里面<span style=\"box-sizing: border-box;\">不同分支覆盖相同<span style=\"box-sizing: border-box;\">j</span>ava源文件的需求</span>，大神们帮忙指点</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">AS的gradle配置很强大，可以做很多事情，基本是可以替代Manifest的节奏</p><p><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">1、设置基本信息</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">如下所示在android下可以设置API、SDK等版本，设置包名版本号等，这些不细说了</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">android{</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; color: rgb(0, 112, 192); white-space: pre;\">	</span>compileSdkVersion 21</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">&nbsp; &nbsp; buildToolsVersion &#39;23.0.2&#39;</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">&nbsp; &nbsp; defaultConfig {</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">&nbsp; &nbsp; &nbsp; &nbsp; applicationId &quot;com.evideo.i80&quot;</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">&nbsp; &nbsp; &nbsp; &nbsp; minSdkVersion 22</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">&nbsp; &nbsp; &nbsp; &nbsp; targetSdkVersion 22</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">&nbsp; &nbsp; &nbsp; &nbsp; versionCode 11645</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">&nbsp; &nbsp; &nbsp; &nbsp; versionName &quot;5.0.0&quot;</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">&nbsp; &nbsp; &nbsp; &nbsp; testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot;</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">&nbsp; &nbsp; }</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">//...</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">}</span><span style=\"box-sizing: border-box; color: rgb(0, 112, 192); white-space: pre;\">	</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">2、多分支buildTypes</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">buildTypes默认会有debug和release两种，可以任意添加其他分支，如I80、I100，如下所示（不打debug/release可以去掉）</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">android{</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">	</span>//...</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">	</span>buildTypes {</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">			</span>I80 {</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">				</span>signingConfig &nbsp;signingConfigs.debug</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">				</span>//buildConfigField(&quot;int&quot;, &quot;cloud_port&quot;, &quot;8888&quot;)</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">				</span>multiDexEnabled true</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">			</span>}</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">			</span>I100 {</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">				</span>signingConfig &nbsp;signingConfigs.debug</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">				</span>multiDexEnabled true</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">			</span>}</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">			</span>debug {</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">				</span>signingConfig &nbsp;signingConfigs.debug</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">				</span>multiDexEnabled true</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">			</span>}</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">			</span>release {</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">				</span>multiDexEnabled true</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">			</span>}</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">		</span>}<span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">	</span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">//...</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">}<span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">	</span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">每个分支底下可以配置相应属性，比如不一样的签名、混淆文件等等。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">每添加一个分支，可以在源码src目录下对应添加以分支名命名的文件夹</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894436099_042715.png\" title=\"\" alt=\"1505894436099_042715.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">原始默认放在main目录下，目录下包含java源文件、res、assets等，其他分支与main同级目录按相同目录结构建立</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">编译分支时先从分支目录下找，找不到则到main下面找，结构示例如下图</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894458576_489574.png\" title=\"\" alt=\"1505894458576_489574.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">res和assets相同文件覆盖规则上没什么问题，我这边有个需求是想我<span style=\"box-sizing: border-box; font-weight: 700;\">两个分支只有一个HomeActivity内容不一样但想类名一样</span>，希望根据打出不同包去对应启动不同的HomeActivity，最土的方法当然是在main那边再新加一个如NewHomeActivity，根据判断启动哪个，这种方法显得代码臃肿了，会有一些代码在打某个包情况下根本没用。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">所以就想我能不能main和I100分支分别有一个HomeActivity，类似资源的覆盖关系，实验结果令人失望了，因为这种分支方式其实就是编译时选择对应源码去编译了，如果两边都有这个类，在编译main分支（就是debug或release分支）时没问题，但是编译I100分支时就会存在两个HomeActivity导致类冲突了</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">这种替换方式我是暂时没有办法，然后就用了另外一种方法，虽然不是完美，至少看着还算清晰：</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">就是<span style=\"box-sizing: border-box; font-weight: 700;\">再加一个I80分支</span>，也就是你这个工程有多少分支就建多少分支，默认的debug和release不作为打包发布用。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">然后保持main目录下只存放共有文件，如果存在差异文件，分别存放在分支上，在I80和I100分支同等目录下分别存放HomeActivity，去掉mian下面的HomeActivity（去掉后去编译main分支肯定失败，所以不作为打包用），使用时只打包对应分支，这样就达到用相同类的需求了，Manifest和main调用代码里面用到时写这个类名就行了，类里面你可以各自做自己的事情，每个分支各自独立的东西单独放，看起来比较清晰吧。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">附：补充一下buildTypes作为部分代码判断分支的方法</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">buildTypes的属性在工程被构建后会生成BuildConfig.java文件（如下图），这个类在代码是可以直接使用的</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894620339_807361.png\" title=\"\" alt=\"1505894620339_807361.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">常用的BUILD_TYPE判断分支：</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">if (BuildConfig.BUILD_TYPE == &quot;I80&quot;){</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">	</span>//...</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">}</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">也可以自定义成员，比如在buildTypes添加buildConfigField(&quot;int&quot;, &quot;cloud_port&quot;, &quot;8888&quot;)，后面就能使用BuildConfig.cloud_port这个成员了</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894663216_990784.png\" title=\"\" alt=\"1505894663216_990784.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">编译前可以在build Variants选择对应的分支：</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-21/1505990288678_302221.png\" title=\"\" alt=\"1505990288678_302221.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">打签名包时同样选择对应分支：</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-21/1505990369567_065252.png\" title=\"\" alt=\"1505990369567_065252.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">3、多渠道productFlavors</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">这个主要用于多渠道打包，还没用到，不深入说了，可以设定一些包名渠道号友盟之类的特性</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">productFlavors{</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">	</span>yingyongbao {</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">		</span>dimension &quot;channel&quot;</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">		</span>manifestPlaceholders = [umeng_channel_value: &quot;yingyongbao&quot;]</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">		</span>resValue(&quot;bool&quot;, &quot;application_log_enable&quot;, &quot;false&quot;)</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">	</span>}</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">	</span>evideo {</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">		</span>dimension &quot;firm&quot;</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">		</span>applicationId &quot;com.evideo.weiju&quot;</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">		</span>versionCode 20205</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">		</span>versionName &quot;1.1.2.5&quot;</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">	</span>}</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">	</span>mag {</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">		</span>dimension &quot;firm&quot;</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">		</span>applicationId &quot;com.magcctv.xyyj&quot;</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">		</span>versionCode 10100</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">		</span>versionName &quot;1.0.1&quot;</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\"><span class=\"Apple-tab-span\" style=\"box-sizing: border-box; white-space: pre;\">	</span>}</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; color: rgb(112, 48, 160);\">}</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">添加productFlavors是会跟buildTypes结合使用的，属于相乘组合的形式，比如上面的例子最终可以打出这些包：yingyongbaoI80，yingyongbaoI100，evideoI80，evideoI100等</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">4、总结</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">gradle可以做很多事情，包括自动打包、添加混淆这些后面时间再说吧，有兴趣上网查一下玩一下，包括上面那些还有好多属性可以配，可以去尝试。可以借鉴的有：3000SDK分支有dvp混淆jar包的，微居APP有多渠道打包的，I100有覆盖java文件（还没上传，哈哈）。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">然后上面的多分支方式也可以替代此前T91S脚本切换版本的方式，有兴趣的可以去改造一下，作为练手。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\">再扔一张gradle配置示例，有图的文章好像比较漂亮</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-09-20/1505894930838_208708.png\" title=\"\" alt=\"1505894930838_208708.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://img.baidu.com/hi/bobo/B_0056.gif\"/><img src=\"http://img.baidu.com/hi/tsj/t_0038.gif\"/><img src=\"http://img.baidu.com/hi/bobo/B_0021.gif\"/></p><p><br/></p>', 'DS3000,Android', 'private', 'draft', '0', '0', '林圣腾', 'linshengteng@star-net.cn', '2017-11-08 14:38:56', 'linshengteng@star-net.cn', '2017-11-08 14:38:56', '0');
INSERT INTO `article` VALUES ('A17110910501939', 'DS2000平台主线稳定性bug解决心得', '日志与函数映射表的解析工具.rar                前言：        &nbsp;&nbsp;&nbsp;&nbsp;稳定性bug，一直是代码维护的疑难杂症，难点在于找出让bug复现的方法，以及定位死机的代码位置，从而找出产生bug的原因，最后得以解决。本章心得体会，从两个实例的稳定性bug，介绍了几种DS2000平台的bug定位方法，分享给大家，希望今后的工作有所启发和帮助。          方法一：以界面为排查单位，确认内存是否泄漏。                      bug现象（漫索缺陷[B170822-001]、[B170828-004]和[B1...', '<p style=\"line-height: 16px;\"><img src=\"http://39.108.177.3:8080/static/ueditor/dialogs/attachment/fileTypeImages/icon_rar.gif\"/><a style=\"font-size:12px; color:#0066cc;\" href=\"http://39.108.177.3:8080/upload//files/2017-11-08/144034/日志与函数映射表的解析工具.rar\" title=\"日志与函数映射表的解析工具.rar\">日志与函数映射表的解析工具.rar</a></p><pre class=\"brush:plain;toolbar:false\"><br/></pre><p><span style=\"font-size: 20px;\"><strong>前言：</strong></span></p><p>&nbsp;&nbsp;&nbsp;&nbsp;稳定性bug，一直是代码维护的疑难杂症，难点在于找出让bug复现的方法，以及定位死机的代码位置，从而找出产生bug的原因，最后得以解决。本章心得体会，从两个实例的稳定性bug，介绍了几种DS2000平台的bug定位方法，分享给大家，希望今后的工作有所启发和帮助。</p><br/><p><span style=\"font-size: 20px;\"><strong>方法一：以界面为排查单位，确认内存是否泄漏。</strong></span></p><p><span style=\"font-size: 20px;\"><strong><br/></strong></span></p><strong>bug现象（漫索缺陷[B170822-001]、[B170828-004]和[B170822-009]）：</strong><br/><p>&nbsp;&nbsp;&nbsp;&nbsp;自动化测试，室内机概率性出现被叫死机。</p><strong>跟踪：</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp;log中，搜索重启关键字“udp_manager_init”，发现死机前多数处于被叫界面。<br/><strong>分析：</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp;对于该类稳定性问题，多数情况下，死于被叫业务只是一个暴露问题的导火线，不是根本问题所在。由于音视频通话业务，所占内存较大，很容易触发由于内存管理不当，致使内存泄露，导致的死机问题。<br/><strong>方法：</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp;可在_memleak_add()中，增加mem_block_cnt变量的打印，如果频繁执行某个测试用例，mem_block_cnt会不断增加，就说明该界面中有内存块没有被释放，就着重查看动态申请的内存，是否有对应的反初始化操作。<br/><strong>定位：</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp;查看日志，记录测试用例中，所有进入的界面，用以上方法，定位存在内存泄露的界面。<br/><strong>排查结果：</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp;通过该方法，定位到含有缩略图的物业讯息、访客留言、通话记录等界面，再查看代码中有动态申请内存部分的代码，可发现以下代码隐患，当resize_buf不为空时，已经动态申请了内存的bmp_data变量，没有被释放掉，造成了内存泄露：<br/><pre class=\"brush:cpp;toolbar:false\">static&nbsp;void&nbsp;_msg_infor_load_thumb(msg_infor_widget_view_t*&nbsp;view,&nbsp;int&nbsp;thumb_w,&nbsp;int&nbsp;thumb_h)\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;char*&nbsp;bmp_data&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;fsize&nbsp;=&nbsp;0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;FtkColor&nbsp;bg&nbsp;=&nbsp;{0};\r\n&nbsp;&nbsp;&nbsp;&nbsp;ES_FILE*&nbsp;fp&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;char*&nbsp;file_name&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;__u8*&nbsp;resize_buf&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;BMP_HEADER*&nbsp;bmp_header&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;return_if_fail(view&nbsp;!=&nbsp;NULL);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(view-&gt;rec_bmp_thumb&nbsp;!=&nbsp;NULL)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ftk_bitmap_unref(view-&gt;rec_bmp_thumb);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;view-&gt;node-&gt;content;\r\n&nbsp;&nbsp;&nbsp;&nbsp;fp&nbsp;=&nbsp;fopen(file_name,&nbsp;&quot;r&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;fsize&nbsp;=&nbsp;task_msg_get_bmp_data_size(fp);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;__inf(&quot;[msg&nbsp;play&nbsp;load&nbsp;thumb:&nbsp;file=%s]\\n&quot;,&nbsp;file_name);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(fsize&nbsp;&gt;&nbsp;0)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_data&nbsp;=&nbsp;(unsigned&nbsp;char*&nbsp;)eLIBs_malloc(fsize);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(bmp_data&nbsp;==&nbsp;NULL)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__inf(&quot;bmp_data&nbsp;eLIBs_malloc&nbsp;failed!\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;bitCount&nbsp;=&nbsp;24;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FtkBitmap*&nbsp;thumb&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eLIBs_memset(bmp_data,&nbsp;0,&nbsp;fsize);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fread(bmp_data,&nbsp;sizeof(char),&nbsp;fsize,&nbsp;fp);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_header&nbsp;=&nbsp;(BMP_HEADER*)bmp_data;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitCount&nbsp;=&nbsp;bmp_header-&gt;biBitCount;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(bmp_header-&gt;biWidth&nbsp;!=&nbsp;thumb_w&nbsp;||&nbsp;bmp_header-&gt;biHeight&nbsp;!=&nbsp;thumb_h)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resize_buf&nbsp;=&nbsp;(__u8*)ev_Vmalloc(((thumb_w&nbsp;*&nbsp;bitCount&nbsp;+&nbsp;31)&nbsp;/&nbsp;32)&nbsp;*&nbsp;4&nbsp;*&nbsp;thumb_h);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(resize_buf&nbsp;!=&nbsp;NULL)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__inf(&quot;resize_buf&nbsp;malloc&nbsp;ok\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitmap_resize((__u8*)(bmp_data&nbsp;+&nbsp;sizeof(BMP_HEADER)),&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_header-&gt;biBitCount,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_header-&gt;biWidth,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_header-&gt;biHeight,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resize_buf,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thumb_w,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thumb_h);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__inf(&quot;resize_buf&nbsp;malloc&nbsp;failed\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thumb&nbsp;=&nbsp;ftk_bitmap_create(thumb_w,&nbsp;thumb_h,&nbsp;bg);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;view-&gt;rec_bmp_thumb&nbsp;=&nbsp;thumb;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(resize_buf&nbsp;!=&nbsp;NULL)&nbsp;{&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_common_bmp_copy24(view-&gt;rec_bmp_thumb,&nbsp;(unsigned&nbsp;char*)(resize_buf));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ev_Vfree(resize_buf);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resize_buf&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if(bmp_data&nbsp;!=&nbsp;NULL)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_common_bmp_copy24(view-&gt;rec_bmp_thumb,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(unsigned&nbsp;char*)(bmp_data&nbsp;+&nbsp;sizeof(BMP_HEADER)));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eLIBs_free(bmp_data);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_data&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;view-&gt;rec_bmp_thumb&nbsp;=&nbsp;ui_load_bitmap(&quot;common/default_image.png&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;if(fp&nbsp;!=&nbsp;NULL)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fclose(fp);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fp&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n}</pre><br/><strong>解决：</strong><br/><p>&nbsp;&nbsp;&nbsp;&nbsp;如下修改，确保可能动态申请的内存，都会被尝试释放掉。修改后，再次跑相同测试用例，看是否还会出现死机，未出现即说明已解决。</p><p><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191167812_998369.png\" title=\"\" alt=\"1510191167812_998369.png\"/></p><p><span style=\"font-size: 20px;\"><strong><br/></strong></span></p><p><span style=\"font-size: 20px;\"><strong>方法二：从死机“Data Abort”信息中，定位死机的代码位置。</strong></span></p><br/><strong>bug现象（漫索缺陷[B170822-001]和[B170823-001]）：</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp;自动化测试，死机于报警发生。<br/><strong>跟踪：</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp;log中，搜索重启关键字“Data Abort”（只有串口代印才会有），发现死机前，处于报警发生时，准备进入报警发生界面前：<br/> &nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191781061_618855.png\" title=\"\" alt=\"1510191781061_618855.png\"/><strong>分析：</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp;该类问题如果用“方法一”，排查不出有什么内存泄露相关的异常问题，且复现的概率又较低（例如2~3个小时出现一次）。可先从死机“Data Abort”信息中，尝试获取死机相关的函数与变量信息。<br/><strong>方法：</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp;查看“Address of aborted instruction:”字段，表示最终死机的代码段位置。查看“current prio”字段，表示死机时现场处于哪个线程中。查看对应线程ID的现场堆栈信息。<br/><strong>定位：</strong><br/><p>&nbsp;&nbsp;&nbsp;&nbsp;这里从日志中，可看出是死于线程ID为64的线程当中。对应的是音频播放线程函数_wav_thread()。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191838442_227178.png\" title=\"\" alt=\"1510191838442_227178.png\"/></p>&nbsp;&nbsp;&nbsp;&nbsp;以下由本人总结的几个常见的线程ID对应的线程函数：<br/>&nbsp;&nbsp;&nbsp;&nbsp;ui：129<br/>&nbsp;&nbsp;&nbsp;&nbsp;_dvp_sys_thread：37<br/>&nbsp;&nbsp;&nbsp;&nbsp;_wav_thread：64<br/>&nbsp;&nbsp;&nbsp;&nbsp;_dinosaur_thread_task：65<br/>&nbsp;&nbsp;&nbsp;&nbsp;_task_message_thread_task：66<br/>&nbsp;&nbsp;&nbsp;&nbsp;net_thread:67<br/>&nbsp;&nbsp;&nbsp;&nbsp;arec_thread:68<br/>&nbsp;&nbsp;&nbsp;&nbsp;_msg_srv_thread：97<br/>&nbsp;&nbsp;&nbsp;&nbsp;_netProto_udp_from_net_proc：98<br/>&nbsp;&nbsp;&nbsp;&nbsp;_msg_srv_thread_task：99<br/>&nbsp;&nbsp;&nbsp;&nbsp;_main_thread_task:100<br/>&nbsp;&nbsp;&nbsp;&nbsp;task_alarm_thread：101<br/>&nbsp;&nbsp;&nbsp;&nbsp;_task_phone_thread：103<br/>&nbsp;&nbsp;&nbsp;&nbsp;_task_ihome_thread_task：104<br/>&nbsp;&nbsp;&nbsp;&nbsp;_task_elevator_thread_task：105<br/>&nbsp;&nbsp;&nbsp;&nbsp;_task_ext_sb_thread：106<br/>&nbsp;&nbsp;&nbsp;&nbsp;_task_manual_thread_task：107<br/>&nbsp;&nbsp;&nbsp;&nbsp;_ping_net_task:108<br/>&nbsp;&nbsp;&nbsp;&nbsp;_http_down_percent_thread：131<br/>&nbsp;&nbsp;&nbsp;&nbsp;_http_recv_service_proc：132<br/>&nbsp;&nbsp;&nbsp;&nbsp;_standby_thread_task：133<br/>&nbsp;&nbsp;&nbsp;&nbsp;_task_monitor_thread：134<br/>&nbsp;&nbsp;&nbsp;&nbsp;_task_ipc_thread：135<br/>&nbsp;&nbsp;&nbsp;&nbsp;_task_mediaplay_thread：136<br/>&nbsp;&nbsp;&nbsp;&nbsp;_task_doorbell_thread：137<br/>&nbsp;&nbsp;&nbsp;&nbsp;_task_cattle_thread：138<br/>&nbsp;&nbsp;&nbsp;&nbsp;_task_intelligent_thread：139<br/>&nbsp;&nbsp;&nbsp;&nbsp;从线程的现场堆栈信息中，查找出对应dvp_sym_map.txt或epos_map.txt中的函数或变量，可发现第一个对应函数的是地址0xe1893708，对应的是dvp_sym_map.txt中的eLIBs_fseek()函数（地址0xe1893700）。<br/> <p>&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191969155_497296.png\" title=\"\" alt=\"1510191969155_497296.png\"/></p><p>&nbsp;&nbsp;&nbsp;&nbsp;最终死机地址“Address of aborted instruction”的c203e29c，对应的是epos_map.txt中的esFSYS_fseek()函数（地址0xc203e18c），进一步确认死机在eLIBs_fseek()函数中。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192006747_741145.png\" title=\"\" alt=\"1510192006747_741145.png\"/>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;查看死机现场寄存器中的数据，“r[4] = 0”、“r[5] = 2c”、“r[6] = 0”，分别对应着eLIBs_fseek()的三个参数，可以发现参数一为空，是不正常的。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192107273_598058.png\" title=\"\" alt=\"1510192107273_598058.png\"/>&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;综上，可以初步判断，死机在线程函数_wav_thread()中，调用到eLIBs_fseek()的地方，原因是参数一，即文件句柄指针为空导致的。</p><br/>&nbsp;&nbsp;&nbsp;&nbsp;注：以上根据地址对应函数或变量的过程，可借助附件中本人编写的convert_addr_to_func_name.py脚本，自动解析出，所有线程现场中可能的对应函数与变量。<br/><strong>排查结果：</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp;通过代码中查找eLIBs_fseek()，_wav_thread()相关的，只有audioplayer_api.c中的_wav_thread()和_wav_play()中的两处。再仔细阅读代码逻辑，并联系报警发生过程（先是播放了报警声，然后又播放了按键声），可以看出文件句柄指针wav_player.fp，有用类似互斥锁机制的WAVPLAY_ENTER_CRITICAL()和WAVPLAY_EXIT_CRITICAL()保护起来，但_wav_play()中，锁保护范围的颗粒度太小，由于eLIBs_fwrite()函数执行周期可能较长，会在执行eLIBs_fwrite()的时候，被播放按键音的_wav_stop()穿插执行，进行反初始化，将其文件句柄置为了空指针，然后播放报警声的_wav_play()继续走，当执行到eLIBs_fseek()的时候，便因为该指针为空，而导致死机。<br/><p>&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510193184744_979989.png\" title=\"\" alt=\"1510193184744_979989.png\"/></p><p>&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510193244594_592866.png\" title=\"\" alt=\"1510193244594_592866.png\"/></p>&nbsp;&nbsp;&nbsp;&nbsp;没错，恭喜找到了可能的bug的根本原因，接下来，就差进一步解决后的验证。<br/><strong>解决：</strong><br/>&nbsp;&nbsp;&nbsp;&nbsp;适当增加锁保护范围的颗粒度（前提是执行周期较短），对文件句柄指针的判断与调用，需要在同一对互斥锁保护中，避免被穿插访问共享内存数据。<br/><p style=\"white-space: normal;\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192903381_962067.png\" title=\"\" alt=\"1510192903381_962067.png\"/></p><p style=\"white-space: normal;\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192936053_819770.png\" title=\"\" alt=\"1510192936053_819770.png\"/></p><p style=\"white-space: normal;\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192957965_760083.png\" title=\"\" alt=\"1510192957965_760083.png\"/></p><p style=\"white-space: normal;\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510193011134_633349.png\" title=\"\" alt=\"1510193011134_633349.png\"/></p>&nbsp;&nbsp;&nbsp;&nbsp;修改后，再次跑相同测试用例，看是否还会出现死机，未出现即说明已解决。<p><br/></p>', 'DS2000,C&C++', 'private', 'draft', '4', '0', '陈钟', 'chenzhong.sy@star-net.cn', '2017-11-09 10:50:20', 'chenzhong.sy@star-net.cn', '2017-11-09 11:08:42', '1');
INSERT INTO `article` VALUES ('A17110911055997', 'DS2000平台主线稳定性bug解决心得', '前言：        &nbsp;&nbsp;&nbsp;&nbsp;稳定性bug，一直是代码维护的疑难杂症，难点在于找出让bug复现的方法，以及定位死机的代码位置，从而找出产生bug的原因，最后得以解决。本章心得体会，从两个实例的稳定性bug，介绍了几种DS2000平台的bug定位方法，分享给大家，希望今后的工作有所启发和帮助。              方法一：以界面为排查单位，确认内存是否泄漏。                        bug现象（漫索缺陷[B170822-001]、[B170828-004]和[B170822-009]）：        &nbsp;&...', '<p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\">前言：</span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;稳定性bug，一直是代码维护的疑难杂症，难点在于找出让bug复现的方法，以及定位死机的代码位置，从而找出产生bug的原因，最后得以解决。本章心得体会，从两个实例的稳定性bug，介绍了几种DS2000平台的bug定位方法，分享给大家，希望今后的工作有所启发和帮助。</p><p><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\">方法一：以界面为排查单位，确认内存是否泄漏。</span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\"><br/></span></span></p><p><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">bug现象（漫索缺陷[B170822-001]、[B170828-004]和[B170822-009]）：</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;自动化测试，室内机概率性出现被叫死机。</p><p><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">跟踪：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;log中，搜索重启关键字“udp_manager_init”，发现死机前多数处于被叫界面。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">分析：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;对于该类稳定性问题，多数情况下，死于被叫业务只是一个暴露问题的导火线，不是根本问题所在。由于音视频通话业务，所占内存较大，很容易触发由于内存管理不当，致使内存泄露，导致的死机问题。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">方法：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;可在_memleak_add()中，增加mem_block_cnt变量的打印，如果频繁执行某个测试用例，mem_block_cnt会不断增加，就说明该界面中有内存块没有被释放，就着重查看动态申请的内存，是否有对应的反初始化操作。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">定位：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;查看日志，记录测试用例中，所有进入的界面，用以上方法，定位存在内存泄露的界面。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">排查结果：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;通过该方法，定位到含有缩略图的物业讯息、访客留言、通话记录等界面，再查看代码中有动态申请内存部分的代码，可发现以下代码隐患，当resize_buf不为空时，已经动态申请了内存的bmp_data变量，没有被释放掉，造成了内存泄露：</span><br/></p><pre class=\"brush:cpp;toolbar:false\" style=\"box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &#39;Courier New&#39;, monospace; font-size: 13px; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; color: rgb(51, 51, 51); word-break: break-all; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); border-radius: 4px; background-color: rgb(245, 245, 245);\">static&nbsp;void&nbsp;_msg_infor_load_thumb(msg_infor_widget_view_t*&nbsp;view,&nbsp;int&nbsp;thumb_w,&nbsp;int&nbsp;thumb_h)\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;char*&nbsp;bmp_data&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;fsize&nbsp;=&nbsp;0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;FtkColor&nbsp;bg&nbsp;=&nbsp;{0};\r\n&nbsp;&nbsp;&nbsp;&nbsp;ES_FILE*&nbsp;fp&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;char*&nbsp;file_name&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;__u8*&nbsp;resize_buf&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;BMP_HEADER*&nbsp;bmp_header&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;return_if_fail(view&nbsp;!=&nbsp;NULL);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(view-&gt;rec_bmp_thumb&nbsp;!=&nbsp;NULL)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ftk_bitmap_unref(view-&gt;rec_bmp_thumb);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;file_name&nbsp;=&nbsp;view-&gt;node-&gt;content;\r\n&nbsp;&nbsp;&nbsp;&nbsp;fp&nbsp;=&nbsp;fopen(file_name,&nbsp;&quot;r&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;fsize&nbsp;=&nbsp;task_msg_get_bmp_data_size(fp);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;__inf(&quot;[msg&nbsp;play&nbsp;load&nbsp;thumb:&nbsp;file=%s]\\n&quot;,&nbsp;file_name);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(fsize&nbsp;&gt;&nbsp;0)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_data&nbsp;=&nbsp;(unsigned&nbsp;char*&nbsp;)eLIBs_malloc(fsize);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(bmp_data&nbsp;==&nbsp;NULL)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__inf(&quot;bmp_data&nbsp;eLIBs_malloc&nbsp;failed!\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;bitCount&nbsp;=&nbsp;24;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FtkBitmap*&nbsp;thumb&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eLIBs_memset(bmp_data,&nbsp;0,&nbsp;fsize);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fread(bmp_data,&nbsp;sizeof(char),&nbsp;fsize,&nbsp;fp);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_header&nbsp;=&nbsp;(BMP_HEADER*)bmp_data;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitCount&nbsp;=&nbsp;bmp_header-&gt;biBitCount;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(bmp_header-&gt;biWidth&nbsp;!=&nbsp;thumb_w&nbsp;||&nbsp;bmp_header-&gt;biHeight&nbsp;!=&nbsp;thumb_h)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resize_buf&nbsp;=&nbsp;(__u8*)ev_Vmalloc(((thumb_w&nbsp;*&nbsp;bitCount&nbsp;+&nbsp;31)&nbsp;/&nbsp;32)&nbsp;*&nbsp;4&nbsp;*&nbsp;thumb_h);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(resize_buf&nbsp;!=&nbsp;NULL)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__inf(&quot;resize_buf&nbsp;malloc&nbsp;ok\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitmap_resize((__u8*)(bmp_data&nbsp;+&nbsp;sizeof(BMP_HEADER)),&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_header-&gt;biBitCount,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_header-&gt;biWidth,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_header-&gt;biHeight,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resize_buf,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thumb_w,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thumb_h);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__inf(&quot;resize_buf&nbsp;malloc&nbsp;failed\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thumb&nbsp;=&nbsp;ftk_bitmap_create(thumb_w,&nbsp;thumb_h,&nbsp;bg);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;view-&gt;rec_bmp_thumb&nbsp;=&nbsp;thumb;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(resize_buf&nbsp;!=&nbsp;NULL)&nbsp;{&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_common_bmp_copy24(view-&gt;rec_bmp_thumb,&nbsp;(unsigned&nbsp;char*)(resize_buf));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ev_Vfree(resize_buf);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resize_buf&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if(bmp_data&nbsp;!=&nbsp;NULL)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui_common_bmp_copy24(view-&gt;rec_bmp_thumb,&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(unsigned&nbsp;char*)(bmp_data&nbsp;+&nbsp;sizeof(BMP_HEADER)));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eLIBs_free(bmp_data);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_data&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;view-&gt;rec_bmp_thumb&nbsp;=&nbsp;ui_load_bitmap(&quot;common/default_image.png&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;if(fp&nbsp;!=&nbsp;NULL)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fclose(fp);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fp&nbsp;=&nbsp;NULL;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n}</pre><p><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">解决：</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;如下修改，确保可能动态申请的内存，都会被尝试释放掉。修改后，再次跑相同测试用例，看是否还会出现死机，未出现即说明已解决。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191167812_998369.png\" title=\"\" alt=\"1510191167812_998369.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\"><br/></span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\">方法二：从死机“Data Abort”信息中，定位死机的代码位置。</span></span></p><p><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">bug现象（漫索缺陷[B170822-001]和[B170823-001]）：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;自动化测试，死机于报警发生。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">跟踪：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;log中，搜索重启关键字“Data Abort”（只有串口代印才会有），发现死机前，处于报警发生时，准备进入报警发生界面前：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;</span><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191781061_618855.png\" title=\"\" alt=\"1510191781061_618855.png\"/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">分析：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;该类问题如果用“方法一”，排查不出有什么内存泄露相关的异常问题，且复现的概率又较低（例如2~3个小时出现一次）。可先从死机“Data Abort”信息中，尝试获取死机相关的函数与变量信息。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">方法：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;查看“Address of aborted instruction:”字段，表示最终死机的代码段位置。查看“current prio”字段，表示死机时现场处于哪个线程中。查看对应线程ID的现场堆栈信息。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">定位：</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;这里从日志中，可看出是死于线程ID为64的线程当中。对应的是音频播放线程函数_wav_thread()。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191838442_227178.png\" title=\"\" alt=\"1510191838442_227178.png\"/></p><p><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;以下由本人总结的几个常见的线程ID对应的线程函数：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;ui：129</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_dvp_sys_thread：37</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_wav_thread：64</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_dinosaur_thread_task：65</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_message_thread_task：66</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;net_thread:67</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;arec_thread:68</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_msg_srv_thread：97</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_netProto_udp_from_net_proc：98</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_msg_srv_thread_task：99</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_main_thread_task:100</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;task_alarm_thread：101</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_phone_thread：103</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_ihome_thread_task：104</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_elevator_thread_task：105</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_ext_sb_thread：106</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_manual_thread_task：107</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_ping_net_task:108</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_http_down_percent_thread：131</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_http_recv_service_proc：132</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_standby_thread_task：133</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_monitor_thread：134</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_ipc_thread：135</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_mediaplay_thread：136</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_doorbell_thread：137</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_cattle_thread：138</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_intelligent_thread：139</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;从线程的现场堆栈信息中，查找出对应dvp_sym_map.txt或epos_map.txt中的函数或变量，可发现第一个对应函数的是地址0xe1893708，对应的是dvp_sym_map.txt中的eLIBs_fseek()函数（地址0xe1893700）。</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191969155_497296.png\" title=\"\" alt=\"1510191969155_497296.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;最终死机地址“Address of aborted instruction”的c203e29c，对应的是epos_map.txt中的esFSYS_fseek()函数（地址0xc203e18c），进一步确认死机在eLIBs_fseek()函数中。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192006747_741145.png\" title=\"\" alt=\"1510192006747_741145.png\"/>&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;查看死机现场寄存器中的数据，“r[4] = 0”、“r[5] = 2c”、“r[6] = 0”，分别对应着eLIBs_fseek()的三个参数，可以发现参数一为空，是不正常的。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192107273_598058.png\" title=\"\" alt=\"1510192107273_598058.png\"/>&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;综上，可以初步判断，死机在线程函数_wav_thread()中，调用到eLIBs_fseek()的地方，原因是参数一，即文件句柄指针为空导致的。</p><p><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;注：以上根据地址对应函数或变量的过程，可借助附件中本人编写的convert_addr_to_func_name.py脚本，自动解析出，所有线程现场中可能的对应函数与变量。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">排查结果：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;通过代码中查找eLIBs_fseek()，_wav_thread()相关的，只有audioplayer_api.c中的_wav_thread()和_wav_play()中的两处。再仔细阅读代码逻辑，并联系报警发生过程（先是播放了报警声，然后又播放了按键声），可以看出文件句柄指针wav_player.fp，有用类似互斥锁机制的WAVPLAY_ENTER_CRITICAL()和WAVPLAY_EXIT_CRITICAL()保护起来，但_wav_play()中，锁保护范围的颗粒度太小，由于eLIBs_fwrite()函数执行周期可能较长，会在执行eLIBs_fwrite()的时候，被播放按键音的_wav_stop()穿插执行，进行反初始化，将其文件句柄置为了空指针，然后播放报警声的_wav_play()继续走，当执行到eLIBs_fseek()的时候，便因为该指针为空，而导致死机。</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510193184744_979989.png\" title=\"\" alt=\"1510193184744_979989.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510193244594_592866.png\" title=\"\" alt=\"1510193244594_592866.png\"/></p><p><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;没错，恭喜找到了可能的bug的根本原因，接下来，就差进一步解决后的验证。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">解决：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;适当增加锁保护范围的颗粒度（前提是执行周期较短），对文件句柄指针的判断与调用，需要在同一对互斥锁保护中，避免被穿插访问共享内存数据。</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192903381_962067.png\" title=\"\" alt=\"1510192903381_962067.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192936053_819770.png\" title=\"\" alt=\"1510192936053_819770.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192957965_760083.png\" title=\"\" alt=\"1510192957965_760083.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510193011134_633349.png\" title=\"\" alt=\"1510193011134_633349.png\"/></p><p><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;修改后，再次跑相同测试用例，看是否还会出现死机，未出现即说明已解决。</span></p><p><br/></p>', 'DS2000,C&C++', 'private', 'draft', '1', '0', '陈钟', 'chenzhong.sy@star-net.cn', '2017-11-09 11:05:59', 'chenzhong.sy@star-net.cn', '2017-11-09 11:11:52', '1');
INSERT INTO `article` VALUES ('A17110911083602', 'DS2000平台主线稳定性bug解决心得', '前言：        &nbsp;&nbsp;&nbsp;&nbsp;稳定性bug，一直是代码维护的疑难杂症，难点在于找出让bug复现的方法，以及定位死机的代码位置，从而找出产生bug的原因，最后得以解决。本章心得体会，从两个实例的稳定性bug，介绍了几种DS2000平台的bug定位方法，分享给大家，希望今后的工作有所启发和帮助。              方法一：以界面为排查单位，确认内存是否泄漏。                        bug现象（漫索缺陷[B170822-001]、[B170828-004]和[B170822-009]）：        &nbsp;&...', '<p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\">前言：</span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;稳定性bug，一直是代码维护的疑难杂症，难点在于找出让bug复现的方法，以及定位死机的代码位置，从而找出产生bug的原因，最后得以解决。本章心得体会，从两个实例的稳定性bug，介绍了几种DS2000平台的bug定位方法，分享给大家，希望今后的工作有所启发和帮助。</p><p><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\">方法一：以界面为排查单位，确认内存是否泄漏。</span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\"><br/></span></span></p><p><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">bug现象（漫索缺陷[B170822-001]、[B170828-004]和[B170822-009]）：</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;自动化测试，室内机概率性出现被叫死机。</p><p><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">跟踪：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;log中，搜索重启关键字“udp_manager_init”，发现死机前多数处于被叫界面。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">分析：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;对于该类稳定性问题，多数情况下，死于被叫业务只是一个暴露问题的导火线，不是根本问题所在。由于音视频通话业务，所占内存较大，很容易触发由于内存管理不当，致使内存泄露，导致的死机问题。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">方法：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;可在_memleak_add()中，增加mem_block_cnt变量的打印，如果频繁执行某个测试用例，mem_block_cnt会不断增加，就说明该界面中有内存块没有被释放，就着重查看动态申请的内存，是否有对应的反初始化操作。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">定位：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;查看日志，记录测试用例中，所有进入的界面，用以上方法，定位存在内存泄露的界面。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">排查结果：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;通过该方法，定位到含有缩略图的物业讯息、访客留言、通话记录等界面，再查看代码中有动态申请内存部分的代码，可发现以下代码隐患，当resize_buf不为空时，已经动态申请了内存的bmp_data变量，没有被释放掉，造成了内存泄露：</span></p><p>static void _msg_infor_load_thumb(msg_infor_widget_view_t* view, int thumb_w, int thumb_h)</p><p>{</p><p>&nbsp; &nbsp; unsigned char* bmp_data = NULL;</p><p>&nbsp; &nbsp; int fsize = 0;</p><p>&nbsp; &nbsp; FtkColor bg = {0};</p><p>&nbsp; &nbsp; ES_FILE* fp = NULL;</p><p>&nbsp; &nbsp; char* file_name = NULL;</p><p>&nbsp; &nbsp; __u8* resize_buf = NULL;</p><p>&nbsp; &nbsp; BMP_HEADER* bmp_header = NULL;</p><p>&nbsp; &nbsp; &nbsp;</p><p>&nbsp; &nbsp; return_if_fail(view != NULL);</p><p>&nbsp; &nbsp; &nbsp;</p><p>&nbsp; &nbsp; if (view-&gt;rec_bmp_thumb != NULL)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ftk_bitmap_unref(view-&gt;rec_bmp_thumb);</p><p>&nbsp; &nbsp; &nbsp;</p><p>&nbsp; &nbsp; file_name = view-&gt;node-&gt;content;</p><p>&nbsp; &nbsp; fp = fopen(file_name, &quot;r&quot;);</p><p>&nbsp; &nbsp; fsize = task_msg_get_bmp_data_size(fp);</p><p>&nbsp; &nbsp; &nbsp;</p><p>&nbsp; &nbsp; __inf(&quot;[msg play load thumb: file=%s]\r\n&quot;, file_name);</p><p>&nbsp; &nbsp; &nbsp;</p><p>&nbsp; &nbsp; if (fsize &gt; 0) {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; bmp_data = (unsigned char* )eLIBs_malloc(fsize);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if (bmp_data == NULL) {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; __inf(&quot;bmp_data eLIBs_malloc failed!\r\n&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; else {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int bitCount = 24;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FtkBitmap* thumb = NULL;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eLIBs_memset(bmp_data, 0, fsize);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fread(bmp_data, sizeof(char), fsize, fp);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bmp_header = (BMP_HEADER*)bmp_data;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bitCount = bmp_header-&gt;biBitCount;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (bmp_header-&gt;biWidth != thumb_w || bmp_header-&gt;biHeight != thumb_h) {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resize_buf = (__u8*)ev_Vmalloc(((thumb_w * bitCount + 31) / 32) * 4 * thumb_h);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (resize_buf != NULL) {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; __inf(&quot;resize_buf malloc ok\r\n&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bitmap_resize((__u8*)(bmp_data + sizeof(BMP_HEADER)),&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bmp_header-&gt;biBitCount,&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bmp_header-&gt;biWidth,&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bmp_header-&gt;biHeight,&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resize_buf,&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thumb_w,&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thumb_h);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; __inf(&quot;resize_buf malloc failed\r\n&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thumb = ftk_bitmap_create(thumb_w, thumb_h, bg);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; view-&gt;rec_bmp_thumb = thumb;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (resize_buf != NULL) { &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ui_common_bmp_copy24(view-&gt;rec_bmp_thumb, (unsigned char*)(resize_buf));</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ev_Vfree(resize_buf);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resize_buf = NULL;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if(bmp_data != NULL) {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ui_common_bmp_copy24(view-&gt;rec_bmp_thumb,&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (unsigned char*)(bmp_data + sizeof(BMP_HEADER)));</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eLIBs_free(bmp_data);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bmp_data = NULL;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; else {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; view-&gt;rec_bmp_thumb = ui_load_bitmap(&quot;common/default_image.png&quot;);</p><p>&nbsp; &nbsp; }</p><p>&nbsp;</p><p>&nbsp; &nbsp; if(fp != NULL) {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; fclose(fp);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; fp = NULL;</p><p>&nbsp; &nbsp; }&nbsp;</p><p>}</p><p><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">解决：</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;如下修改，确保可能动态申请的内存，都会被尝试释放掉。修改后，再次跑相同测试用例，看是否还会出现死机，未出现即说明已解决。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191167812_998369.png\" title=\"\" alt=\"1510191167812_998369.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\"><br/></span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\">方法二：从死机“Data Abort”信息中，定位死机的代码位置。</span></span></p><p><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">bug现象（漫索缺陷[B170822-001]和[B170823-001]）：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;自动化测试，死机于报警发生。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">跟踪：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;log中，搜索重启关键字“Data Abort”（只有串口代印才会有），发现死机前，处于报警发生时，准备进入报警发生界面前：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;</span><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191781061_618855.png\" title=\"\" alt=\"1510191781061_618855.png\"/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">分析：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;该类问题如果用“方法一”，排查不出有什么内存泄露相关的异常问题，且复现的概率又较低（例如2~3个小时出现一次）。可先从死机“Data Abort”信息中，尝试获取死机相关的函数与变量信息。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">方法：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;查看“Address of aborted instruction:”字段，表示最终死机的代码段位置。查看“current prio”字段，表示死机时现场处于哪个线程中。查看对应线程ID的现场堆栈信息。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">定位：</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;这里从日志中，可看出是死于线程ID为64的线程当中。对应的是音频播放线程函数_wav_thread()。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191838442_227178.png\" title=\"\" alt=\"1510191838442_227178.png\"/></p><p><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;以下由本人总结的几个常见的线程ID对应的线程函数：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;ui：129</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_dvp_sys_thread：37</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_wav_thread：64</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_dinosaur_thread_task：65</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_message_thread_task：66</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;net_thread:67</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;arec_thread:68</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_msg_srv_thread：97</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_netProto_udp_from_net_proc：98</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_msg_srv_thread_task：99</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_main_thread_task:100</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;task_alarm_thread：101</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_phone_thread：103</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_ihome_thread_task：104</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_elevator_thread_task：105</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_ext_sb_thread：106</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_manual_thread_task：107</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_ping_net_task:108</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_http_down_percent_thread：131</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_http_recv_service_proc：132</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_standby_thread_task：133</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_monitor_thread：134</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_ipc_thread：135</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_mediaplay_thread：136</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_doorbell_thread：137</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_cattle_thread：138</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;_task_intelligent_thread：139</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;从线程的现场堆栈信息中，查找出对应dvp_sym_map.txt或epos_map.txt中的函数或变量，可发现第一个对应函数的是地址0xe1893708，对应的是dvp_sym_map.txt中的eLIBs_fseek()函数（地址0xe1893700）。</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191969155_497296.png\" title=\"\" alt=\"1510191969155_497296.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;最终死机地址“Address of aborted instruction”的c203e29c，对应的是epos_map.txt中的esFSYS_fseek()函数（地址0xc203e18c），进一步确认死机在eLIBs_fseek()函数中。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192006747_741145.png\" title=\"\" alt=\"1510192006747_741145.png\"/>&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;查看死机现场寄存器中的数据，“r[4] = 0”、“r[5] = 2c”、“r[6] = 0”，分别对应着eLIBs_fseek()的三个参数，可以发现参数一为空，是不正常的。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192107273_598058.png\" title=\"\" alt=\"1510192107273_598058.png\"/>&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;综上，可以初步判断，死机在线程函数_wav_thread()中，调用到eLIBs_fseek()的地方，原因是参数一，即文件句柄指针为空导致的。</p><p><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;注：以上根据地址对应函数或变量的过程，可借助附件中本人编写的convert_addr_to_func_name.py脚本，自动解析出，所有线程现场中可能的对应函数与变量。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">排查结果：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;通过代码中查找eLIBs_fseek()，_wav_thread()相关的，只有audioplayer_api.c中的_wav_thread()和_wav_play()中的两处。再仔细阅读代码逻辑，并联系报警发生过程（先是播放了报警声，然后又播放了按键声），可以看出文件句柄指针wav_player.fp，有用类似互斥锁机制的WAVPLAY_ENTER_CRITICAL()和WAVPLAY_EXIT_CRITICAL()保护起来，但_wav_play()中，锁保护范围的颗粒度太小，由于eLIBs_fwrite()函数执行周期可能较长，会在执行eLIBs_fwrite()的时候，被播放按键音的_wav_stop()穿插执行，进行反初始化，将其文件句柄置为了空指针，然后播放报警声的_wav_play()继续走，当执行到eLIBs_fseek()的时候，便因为该指针为空，而导致死机。</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510193184744_979989.png\" title=\"\" alt=\"1510193184744_979989.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510193244594_592866.png\" title=\"\" alt=\"1510193244594_592866.png\"/></p><p><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;没错，恭喜找到了可能的bug的根本原因，接下来，就差进一步解决后的验证。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">解决：</span><br/><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;适当增加锁保护范围的颗粒度（前提是执行周期较短），对文件句柄指针的判断与调用，需要在同一对互斥锁保护中，避免被穿插访问共享内存数据。</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192903381_962067.png\" title=\"\" alt=\"1510192903381_962067.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192936053_819770.png\" title=\"\" alt=\"1510192936053_819770.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192957965_760083.png\" title=\"\" alt=\"1510192957965_760083.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510193011134_633349.png\" title=\"\" alt=\"1510193011134_633349.png\"/></p><p><span style=\"color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;修改后，再次跑相同测试用例，看是否还会出现死机，未出现即说明已解决。</span></p><p><br/></p>', 'DS2000,C&C++', 'private', 'draft', '4', '0', '陈钟', 'chenzhong.sy@star-net.cn', '2017-11-09 11:08:37', 'chenzhong.sy@star-net.cn', '2017-11-09 11:11:48', '1');
INSERT INTO `article` VALUES ('A17110911110868', 'DS2000平台主线稳定性bug解决心得', '前言：        &nbsp;&nbsp;&nbsp;&nbsp;稳定性bug，一直是代码维护的疑难杂症，难点在于找出让bug复现的方法，以及定位死机的代码位置，从而找出产生bug的原因，最后得以解决。本章心得体会，从两个实例的稳定性bug，介绍了几种DS2000平台的bug定位方法，分享给大家，希望对今后的工作有所启发和帮助。              方法一：以界面为排查单位，确认内存是否泄漏。                        bug现象（漫索缺陷[B170822-001]、[B170828-004]和[B170822-009]）：        &nbsp;...', '<p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\">前言：</span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;稳定性bug，一直是代码维护的疑难杂症，难点在于找出让bug复现的方法，以及定位死机的代码位置，从而找出产生bug的原因，最后得以解决。本章心得体会，从两个实例的稳定性bug，介绍了几种DS2000平台的bug定位方法，分享给大家，希望对今后的工作有所启发和帮助。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\">方法一：以界面为排查单位，确认内存是否泄漏。</span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\"><br/></span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">bug现象（漫索缺陷[B170822-001]、[B170828-004]和[B170822-009]）：</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;自动化测试，室内机概率性出现被叫死机。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">跟踪：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;log中，搜索重启关键字“udp_manager_init”，发现死机前多数处于被叫界面。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">分析：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;对于该类稳定性问题，多数情况下，死于被叫业务只是一个暴露问题的导火线，不是根本问题所在。由于音视频通话业务，所占内存较大，很容易触发由于内存管理不当，致使内存泄露，导致的死机问题。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">方法：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;可在_memleak_add()中，增加mem_block_cnt变量的打印，如果频繁执行某个测试用例，mem_block_cnt会不断增加，就说明该界面中有内存块没有被释放，就着重查看动态申请的内存，是否有对应的反初始化操作。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">定位：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;查看日志，记录测试用例中，所有进入的界面，用以上方法，定位存在内存泄露的界面。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">排查结果：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;通过该方法，定位到含有缩略图的物业讯息、访客留言、通话记录等界面，再查看代码中有动态申请内存部分的代码，可发现以下代码隐患，当resize_buf不为空时，已经动态申请了内存的bmp_data变量，没有被释放掉，造成了内存泄露：</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">static void _msg_infor_load_thumb(msg_infor_widget_view_t* view, int thumb_w, int thumb_h)</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">{</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; unsigned char* bmp_data = NULL;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; int fsize = 0;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; FtkColor bg = {0};</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; ES_FILE* fp = NULL;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; char* file_name = NULL;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; __u8* resize_buf = NULL;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; BMP_HEADER* bmp_header = NULL;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; return_if_fail(view != NULL);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; if (view-&gt;rec_bmp_thumb != NULL)</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; ftk_bitmap_unref(view-&gt;rec_bmp_thumb);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; file_name = view-&gt;node-&gt;content;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; fp = fopen(file_name, &quot;r&quot;);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; fsize = task_msg_get_bmp_data_size(fp);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; __inf(&quot;[msg play load thumb: file=%s] &quot;, file_name);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; if (fsize &gt; 0) {</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; bmp_data = (unsigned char* )eLIBs_malloc(fsize);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; if (bmp_data == NULL) {</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; __inf(&quot;bmp_data eLIBs_malloc failed! &quot;);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; }</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; else {</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int bitCount = 24;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FtkBitmap* thumb = NULL;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eLIBs_memset(bmp_data, 0, fsize);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fread(bmp_data, sizeof(char), fsize, fp);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bmp_header = (BMP_HEADER*)bmp_data;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bitCount = bmp_header-&gt;biBitCount;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (bmp_header-&gt;biWidth != thumb_w || bmp_header-&gt;biHeight != thumb_h) {</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resize_buf = (__u8*)ev_Vmalloc(((thumb_w * bitCount + 31) / 32) * 4 * thumb_h);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (resize_buf != NULL) {</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; __inf(&quot;resize_buf malloc ok &quot;);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bitmap_resize((__u8*)(bmp_data + sizeof(BMP_HEADER)),&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bmp_header-&gt;biBitCount,&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bmp_header-&gt;biWidth,&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bmp_header-&gt;biHeight,&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resize_buf,&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thumb_w,&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thumb_h);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else {</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; __inf(&quot;resize_buf malloc failed &quot;);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thumb = ftk_bitmap_create(thumb_w, thumb_h, bg);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; view-&gt;rec_bmp_thumb = thumb;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (resize_buf != NULL) { &nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ui_common_bmp_copy24(view-&gt;rec_bmp_thumb, (unsigned char*)(resize_buf));</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ev_Vfree(resize_buf);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resize_buf = NULL;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if(bmp_data != NULL) {</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ui_common_bmp_copy24(view-&gt;rec_bmp_thumb,&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (unsigned char*)(bmp_data + sizeof(BMP_HEADER)));</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eLIBs_free(bmp_data);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bmp_data = NULL;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; }</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; }</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; else {</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; view-&gt;rec_bmp_thumb = ui_load_bitmap(&quot;common/default_image.png&quot;);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; }</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; if(fp != NULL) {</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; fclose(fp);</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; &nbsp; &nbsp; fp = NULL;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">&nbsp; &nbsp; }&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\">}</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">解决：</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;如下修改，确保可能动态申请的内存，都会被尝试释放掉。修改后，再次跑相同测试用例，看是否还会出现死机，未出现即说明已解决。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191167812_998369.png\" title=\"\" alt=\"1510191167812_998369.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\"><br/></span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; font-size: 20px;\"><span style=\"box-sizing: border-box; font-weight: 700;\">方法二：从死机“Data Abort”信息中，定位死机的代码位置。</span></span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">bug现象（漫索缺陷[B170822-001]和[B170823-001]）：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;自动化测试，死机于报警发生。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">跟踪：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;log中，搜索重启关键字“Data Abort”（只有串口代印才会有），发现死机前，处于报警发生时，准备进入报警发生界面前：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;</span><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191781061_618855.png\" title=\"\" alt=\"1510191781061_618855.png\"/><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">分析：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;该类问题如果用“方法一”，排查不出有什么内存泄露相关的异常问题，且复现的概率又较低（例如2~3个小时出现一次）。可先从死机“Data Abort”信息中，尝试获取死机相关的函数与变量信息。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">方法：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;查看“Address of aborted instruction:”字段，表示最终死机的代码段位置。查看“current prio”字段，表示死机时现场处于哪个线程中。查看对应线程ID的现场堆栈信息。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">定位：</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;这里从日志中，可看出是死于线程ID为64的线程当中。对应的是音频播放线程函数_wav_thread()。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191838442_227178.png\" title=\"\" alt=\"1510191838442_227178.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;以下由本人总结的几个常见的线程ID对应的线程函数：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;ui：129</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_dvp_sys_thread：37</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_wav_thread：64</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_dinosaur_thread_task：65</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_task_message_thread_task：66</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;net_thread:67</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;arec_thread:68</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_msg_srv_thread：97</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_netProto_udp_from_net_proc：98</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_msg_srv_thread_task：99</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_main_thread_task:100</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;task_alarm_thread：101</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_task_phone_thread：103</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_task_ihome_thread_task：104</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_task_elevator_thread_task：105</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_task_ext_sb_thread：106</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_task_manual_thread_task：107</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_ping_net_task:108</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_http_down_percent_thread：131</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_http_recv_service_proc：132</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_standby_thread_task：133</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_task_monitor_thread：134</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_task_ipc_thread：135</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_task_mediaplay_thread：136</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_task_doorbell_thread：137</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_task_cattle_thread：138</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;_task_intelligent_thread：139</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;从线程的现场堆栈信息中，查找出对应dvp_sym_map.txt或epos_map.txt中的函数或变量，可发现第一个对应函数的是地址0xe1893708，对应的是dvp_sym_map.txt中的eLIBs_fseek()函数（地址0xe1893700）。</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510191969155_497296.png\" title=\"\" alt=\"1510191969155_497296.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;最终死机地址“Address of aborted instruction”的c203e29c，对应的是epos_map.txt中的esFSYS_fseek()函数（地址0xc203e18c），进一步确认死机在eLIBs_fseek()函数中。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192006747_741145.png\" title=\"\" alt=\"1510192006747_741145.png\"/>&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;查看死机现场寄存器中的数据，“r[4] = 0”、“r[5] = 2c”、“r[6] = 0”，分别对应着eLIBs_fseek()的三个参数，可以发现参数一为空，是不正常的。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192107273_598058.png\" title=\"\" alt=\"1510192107273_598058.png\"/>&nbsp;&nbsp;&nbsp;&nbsp;</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;综上，可以初步判断，死机在线程函数_wav_thread()中，调用到eLIBs_fseek()的地方，原因是参数一，即文件句柄指针为空导致的。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;注：以上根据地址对应函数或变量的过程，可借助附件中本人编写的convert_addr_to_func_name.py脚本，自动解析出，所有线程现场中可能的对应函数与变量。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">排查结果：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;通过代码中查找eLIBs_fseek()，_wav_thread()相关的，只有audioplayer_api.c中的_wav_thread()和_wav_play()中的两处。再仔细阅读代码逻辑，并联系报警发生过程（先是播放了报警声，然后又播放了按键声），可以看出文件句柄指针wav_player.fp，有用类似互斥锁机制的WAVPLAY_ENTER_CRITICAL()和WAVPLAY_EXIT_CRITICAL()保护起来，但_wav_play()中，锁保护范围的颗粒度太小，由于eLIBs_fwrite()函数执行周期可能较长，会在执行eLIBs_fwrite()的时候，被播放按键音的_wav_stop()穿插执行，进行反初始化，将其文件句柄置为了空指针，然后播放报警声的_wav_play()继续走，当执行到eLIBs_fseek()的时候，便因为该指针为空，而导致死机。</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510193184744_979989.png\" title=\"\" alt=\"1510193184744_979989.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\">&nbsp;&nbsp;&nbsp;&nbsp;<img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510193244594_592866.png\" title=\"\" alt=\"1510193244594_592866.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;没错，恭喜找到了可能的bug的根本原因，接下来，就差进一步解决后的验证。</span><br/><span style=\"box-sizing: border-box; font-weight: 700; line-height: 21.0526px;\">解决：</span><br/><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;适当增加锁保护范围的颗粒度（前提是执行周期较短），对文件句柄指针的判断与调用，需要在同一对互斥锁保护中，避免被穿插访问共享内存数据。</span><br/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192903381_962067.png\" title=\"\" alt=\"1510192903381_962067.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192936053_819770.png\" title=\"\" alt=\"1510192936053_819770.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510192957965_760083.png\" title=\"\" alt=\"1510192957965_760083.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; white-space: normal; line-height: 21.0526px; background-color: rgb(255, 255, 255);\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510193011134_633349.png\" title=\"\" alt=\"1510193011134_633349.png\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 10px; color: rgb(51, 51, 51); font-family: &#39;Microsoft YaHei&#39;, ����, Tahoma, Helvetica, Arial, 宋体, sans-serif; font-size: 14px; line-height: 21.0526px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"box-sizing: border-box; line-height: 21.0526px;\">&nbsp;&nbsp;&nbsp;&nbsp;修改后，再次跑相同测试用例，看是否还会出现死机，未出现即说明已解决。</span></p><p><br/></p>', 'DS2000,C&C++', 'private', 'publish', '28', '5', '陈钟', 'chenzhong.sy@star-net.cn', '2017-11-09 11:11:09', 'chenzhong.sy@star-net.cn', '2017-11-09 11:13:09', '0');
INSERT INTO `article` VALUES ('A17110911243780', 'T91人脸识别方案技术资料 - 不断更新', '1. T91S人脸识别技术采用的是什么技术，有哪些优势？        &nbsp; &nbsp; 深度学习技术，识别准确率高，误检少，误识率低，拒识率低。        	        2. 人脸特征提取的方法是什么？传统的方式有几何特征和光度测量，比较新的方式有3D识别、皮肤特质分析和热成像摄影。        &nbsp; &nbsp; 咱们是属于哪一种，或者我们独有的方式是什么？这种方式有哪些优势？        &nbsp; &nbsp; (1)人脸质量判断、        &nbsp; &nbsp; 对于同一个ID的人脸，利用人脸角...', '<p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><img src=\"http://39.108.177.3:8080/upload//images/2017-11-09/1510197845113_097134.png\" title=\"\" alt=\"1510197845113_097134.png\"/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\"><br/></span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">1. T91S人脸识别技术采用的是什么技术，有哪些优势？</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(75, 172, 198);\">&nbsp; &nbsp; 深度学习技术，识别准确率高，误检少，误识率低，拒识率低。</span></p><p><span style=\"white-space: pre; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">	</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">2. 人脸特征提取的方法是什么？传统的方式有几何特征和光度测量，比较新的方式有3D识别、皮肤特质分析和热成像摄影。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; &nbsp; 咱们是属于哪一种，或者我们独有的方式是什么？这种方式有哪些优势？</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(75, 172, 198);\">&nbsp; &nbsp; (1)人脸质量判断、</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(75, 172, 198);\">&nbsp; &nbsp; 对于同一个ID的人脸，利用人脸角度算法和模糊度算法，选取一张角度最正的、模糊度最低的人脸。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(75, 172, 198);\">&nbsp; &nbsp; (2)人脸特征提取</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(75, 172, 198);\">&nbsp; &nbsp; 采用深度学习算法，利用目前最先进的inception-resnet网络结构，共28层网络对人脸进行特征提取。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(75, 172, 198);\">&nbsp; &nbsp; (3)人脸比对</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(75, 172, 198);\">&nbsp; &nbsp; 采用聚类算法，离线对人脸库进行特征聚类，线上比对时能够快速定位到所在的类中心，减少比对次数。 </span><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp;&nbsp;</span></p><p><span style=\"white-space: pre; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">	</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">3. 提取的人脸特征是以什么形式存储的，如图像、代码？存储的方式有什么讲究么（相比其他方式有什么优势）？</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(75, 172, 198);\">&nbsp; &nbsp; 加密的二进制文件，特征不可逆，无法复原，更加安全。</span></p><p><span style=\"white-space: pre; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">	</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">4. 人脸识别准确性（早期看宣传手册上是99.9%，现在更新成92%）？这个数据是如何测试或验证的？</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(75, 172, 198);\">&nbsp; &nbsp; 99.9%的是针对1：1的识别率，92%针对是是百万级标准人脸库的1：N的比对识别率。</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(75, 172, 198);\">&nbsp; &nbsp; 这些数据都是在通用的人脸识别环境下测试</span></p><p><span style=\"white-space: pre; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">	</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">5. 人脸识别的能力有多强？以如下几种特殊情况来分析：</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; &nbsp; --用户配套眼镜、帽子、化妆、蓄胡子、留长发</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; &nbsp; --少数人群体，如黑人</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;\">&nbsp; &nbsp; --表情变化，如笑脸</span></p><p><span style=\"font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(75, 172, 198);\">&nbsp; &nbsp; 除墨镜、口罩外，几乎没有什么影响，都可以正常识别。</span></p><p><br/></p>', 'Other', 'private', 'publish', '13', '0', '丁庆发', 'dingqingfa@star-net.cn', '2017-11-09 11:24:38', 'dingqingfa@star-net.cn', '2017-11-09 11:24:38', '0');

-- ----------------------------
-- Table structure for comment
-- ----------------------------
DROP TABLE IF EXISTS `comment`;
CREATE TABLE `comment` (
  `id` bigint(64) NOT NULL COMMENT '主键',
  `category` varchar(32) DEFAULT NULL COMMENT '类型',
  `parent_id` varchar(64) DEFAULT NULL COMMENT '所属',
  `previous_id` bigint(64) DEFAULT NULL COMMENT '回复所评论的id',
  `description` varchar(512) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL COMMENT '内容',
  `author_name` varchar(64) DEFAULT NULL COMMENT '创建者名字',
  `author_photo` varchar(64) DEFAULT NULL COMMENT '创建者头像',
  `create_by` varchar(64) DEFAULT NULL COMMENT '创建者',
  `create_date` datetime DEFAULT NULL COMMENT '创建时间',
  `update_by` varchar(64) DEFAULT NULL COMMENT '更新者',
  `update_date` datetime DEFAULT NULL COMMENT '更新时间',
  `del_flag` varchar(64) DEFAULT NULL COMMENT '逻辑删除标记（0：显示；1：隐藏）',
  PRIMARY KEY (`id`),
  UNIQUE KEY `id` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='评论';

-- ----------------------------
-- Records of comment
-- ----------------------------
INSERT INTO `comment` VALUES ('150589772667', 'article', 'A17091309502743', null, '这是什么', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-09-20 16:55:26', 'dingqingfa@star-net.cn', '2017-09-20 16:57:27', '1');
INSERT INTO `comment` VALUES ('150589774052', 'article', 'A17091309502743', '150589772667', '【回复 丁庆发】： 什么东西', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-09-20 16:55:40', 'dingqingfa@star-net.cn', '2017-09-20 16:57:27', '1');
INSERT INTO `comment` VALUES ('150589775128', 'article', 'A17091309502743', null, '谁写的？', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-09-20 16:55:51', 'dingqingfa@star-net.cn', '2017-09-20 16:57:29', '1');
INSERT INTO `comment` VALUES ('150589789660', 'article', 'A17091309502743', null, '这是什么？', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-09-20 16:58:17', 'dingqingfa@star-net.cn', '2017-09-20 17:54:36', '1');
INSERT INTO `comment` VALUES ('150590081238', 'article', 'A17091309502743', null, '额，这是什么东西。', '李晴', '/images/photo/lion.png', 'liqing@star-net.cn', '2017-09-20 17:46:53', 'liqing@star-net.cn', '2017-09-20 17:53:15', '1');
INSERT INTO `comment` VALUES ('150590096351', 'article', 'A17091309502743', '150589789660', '【回复 丁庆发】： 生产相关的流程。', '李晴', '/images/photo/lion.png', 'liqing@star-net.cn', '2017-09-20 17:49:23', 'dingqingfa@star-net.cn', '2017-09-20 17:54:36', '1');
INSERT INTO `comment` VALUES ('150590125981', 'article', 'A17092016360581', null, '代码段可以换个颜色用。', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-09-20 17:54:20', 'dingqingfa@star-net.cn', '2017-09-20 17:54:20', '0');
INSERT INTO `comment` VALUES ('150590159782', 'article', 'A17092016360581', null, '找不到合适颜色', '林圣腾', '/images/photo/zhiwu.png', 'linshengteng@star-net.cn', '2017-09-20 17:59:57', 'linshengteng@star-net.cn', '2017-09-20 18:00:27', '1');
INSERT INTO `comment` VALUES ('150590163733', 'article', 'A17092016360581', '150590125981', '【回复 丁庆发】： 找不到合适颜色', '林圣腾', '/images/photo/zhiwu.png', 'linshengteng@star-net.cn', '2017-09-20 18:00:37', 'linshengteng@star-net.cn', '2017-09-20 18:01:29', '1');
INSERT INTO `comment` VALUES ('150590169939', 'article', 'A17092016360581', '150590125981', '【回复 丁庆发】： 找不到合适颜色', '林圣腾', '/images/photo/zhiwu.png', 'linshengteng@star-net.cn', '2017-09-20 18:01:39', 'linshengteng@star-net.cn', '2017-09-20 18:01:39', '0');
INSERT INTO `comment` VALUES ('150590177723', 'article', 'A17091309502743', null, '高端', '林圣腾', '/images/photo/zhiwu.png', 'linshengteng@star-net.cn', '2017-09-20 18:02:57', 'linshengteng@star-net.cn', '2017-09-20 18:02:57', '0');
INSERT INTO `comment` VALUES ('150633261097', 'article', 'A17092515410473', null, '以为是攻略，可以细化一下过程就成攻略了/笑哭', '林圣腾', '/images/photo/zhiwu.png', 'linshengteng@star-net.cn', '2017-09-25 17:43:30', 'linshengteng@star-net.cn', '2017-09-25 17:43:30', '0');
INSERT INTO `comment` VALUES ('150633278230', 'article', 'A17092515410473', '150633261097', '【回复 林圣腾】： 竟然有手工表情。', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-09-25 17:46:22', 'dingqingfa@star-net.cn', '2017-09-25 17:46:22', '0');
INSERT INTO `comment` VALUES ('150656202351', 'task', 'T17092809270352', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-09-28 09:27:04', 'dingqingfa@star-net.cn', '2017-09-28 09:27:04', '0');
INSERT INTO `comment` VALUES ('150656204918', 'task', 'T17082109121894', null, '电路问题，产品经理跟踪。', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-09-28 09:27:29', 'dingqingfa@star-net.cn', '2017-09-28 09:27:29', '0');
INSERT INTO `comment` VALUES ('150656884189', 'task', 'T17082219265146', null, '由于彩生活开发进度不满足联调条件，项目进度需要变更。', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-09-28 11:20:41', 'dingqingfa@star-net.cn', '2017-09-28 11:20:41', '0');
INSERT INTO `comment` VALUES ('150656925068', 'task', 'T17092811273072', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-09-28 11:27:31', 'dingqingfa@star-net.cn', '2017-09-28 11:27:31', '0');
INSERT INTO `comment` VALUES ('150659036475', 'task', 'T17092817192451', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-09-28 17:19:25', 'dingqingfa@star-net.cn', '2017-09-28 17:19:25', '0');
INSERT INTO `comment` VALUES ('150659101504', 'task', 'T17092817301541', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-09-28 17:30:16', 'dingqingfa@star-net.cn', '2017-09-28 17:30:16', '0');
INSERT INTO `comment` VALUES ('150673558006', 'task', 'T17093009394049', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-09-30 09:39:41', 'dingqingfa@star-net.cn', '2017-09-30 09:39:41', '0');
INSERT INTO `comment` VALUES ('150673573194', 'task', 'T17093009421037', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-09-30 09:42:11', 'dingqingfa@star-net.cn', '2017-09-30 09:42:11', '0');
INSERT INTO `comment` VALUES ('150751219336', 'task', 'T17100909231335', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-10-09 09:23:14', 'dingqingfa@star-net.cn', '2017-10-09 09:23:14', '0');
INSERT INTO `comment` VALUES ('150751247670', 'task', 'T17100909275646', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-10-09 09:27:57', 'dingqingfa@star-net.cn', '2017-10-09 09:27:57', '0');
INSERT INTO `comment` VALUES ('150751262266', 'task', 'T17100909302274', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-10-09 09:30:22', 'dingqingfa@star-net.cn', '2017-10-09 09:30:22', '0');
INSERT INTO `comment` VALUES ('150768658000', 'task', 'T17101109494018', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-10-11 09:49:40', 'dingqingfa@star-net.cn', '2017-10-11 09:49:40', '0');
INSERT INTO `comment` VALUES ('150768773808', 'task', 'T17101110085824', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-10-11 10:08:58', 'dingqingfa@star-net.cn', '2017-10-11 10:08:58', '0');
INSERT INTO `comment` VALUES ('150771611312', 'task', 'T17101118015252', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-10-11 18:01:53', 'dingqingfa@star-net.cn', '2017-10-11 18:01:53', '0');
INSERT INTO `comment` VALUES ('150811629103', 'task', 'T17101609113124', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-10-16 09:11:31', 'dingqingfa@star-net.cn', '2017-10-16 09:11:31', '0');
INSERT INTO `comment` VALUES ('150811704116', 'task', 'T17101609240172', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-10-16 09:24:01', 'dingqingfa@star-net.cn', '2017-10-16 09:24:01', '0');
INSERT INTO `comment` VALUES ('150881054800', 'task', 'T17092809270352', null, '由于界面上相比旧款差异较大，需要重新翻译词条，已提供词条给睿云联Cindy。', '李晴', '/images/photo/lion.png', 'liqing@star-net.cn', '2017-10-24 10:02:28', 'liqing@star-net.cn', '2017-10-24 10:02:33', '1');
INSERT INTO `comment` VALUES ('150881059641', 'task', 'T17092809270352', null, '由于界面上相比旧款机型差异较大，已提供词条给睿云联接口人Cindy。需要重新翻译。', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-10-24 10:03:17', 'dingqingfa@star-net.cn', '2017-10-24 10:03:17', '0');
INSERT INTO `comment` VALUES ('150881064270', 'task', 'T17093009394049', null, '由于样板房延期，临时演示版本挂起，使用主线版本。', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-10-24 10:04:02', 'dingqingfa@star-net.cn', '2017-10-24 10:04:02', '0');
INSERT INTO `comment` VALUES ('150881084434', 'task', 'T17092817301541', null, '蓝光来访延期。', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-10-24 10:07:24', 'dingqingfa@star-net.cn', '2017-10-24 10:07:24', '0');
INSERT INTO `comment` VALUES ('150881094625', 'task', 'T17101109494018', null, '反复排查发现烧写失败的机器通过热风枪加热后可以恢复，怀疑与GD flash 总线频率有关系，实测证实GD flash 总线工作在100M 的较高频率上，比其他三款flash 都高。', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-10-24 10:09:06', 'dingqingfa@star-net.cn', '2017-10-24 10:09:06', '0');
INSERT INTO `comment` VALUES ('150881102314', 'task', 'T17101109494018', null, '通过全志提供的针对GD flash 降频的补丁包问题没再出现。', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-10-24 10:10:24', 'dingqingfa@star-net.cn', '2017-10-24 10:10:24', '0');
INSERT INTO `comment` VALUES ('150898308122', 'task', 'T17101609113124', null, '解决了某一自动化用例发现的稳定性问题，重新提测发布。', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-10-26 09:58:02', 'dingqingfa@star-net.cn', '2017-10-26 09:58:02', '0');
INSERT INTO `comment` VALUES ('150993036598', 'task', 'T17110609060561', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-11-06 09:06:06', 'dingqingfa@star-net.cn', '2017-11-06 09:06:06', '0');
INSERT INTO `comment` VALUES ('150993039910', 'task', 'T17110609060561', null, '通过前置重启动作，缩短每轮测试时间，提高复现速度。', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-11-06 09:06:39', 'dingqingfa@star-net.cn', '2017-11-06 09:06:45', '1');
INSERT INTO `comment` VALUES ('151001910420', 'task', 'T17110709450462', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-11-07 09:45:05', 'dingqingfa@star-net.cn', '2017-11-07 09:45:05', '0');
INSERT INTO `comment` VALUES ('151019808587', 'article', 'A17110911110868', null, '楼主好人啊，完美的解决了我的问题，我的qq号1213464390加个好友求分享附件/se', '林圣腾', '/images/photo/zhiwu.png', 'linshengteng@star-net.cn', '2017-11-09 11:28:06', 'linshengteng@star-net.cn', '2017-11-09 11:28:06', '0');
INSERT INTO `comment` VALUES ('151019825275', 'article', 'A17110911110868', '151019808587', '【回复 林圣腾】： 亲，记得给分哟', '陈钟', '/images/photo/giraffe.png', 'chenzhong.sy@star-net.cn', '2017-11-09 11:30:52', 'chenzhong.sy@star-net.cn', '2017-11-09 11:30:52', '0');
INSERT INTO `comment` VALUES ('151021458964', 'task', 'T17110916030958', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-11-09 16:03:10', 'dingqingfa@star-net.cn', '2017-11-09 16:03:10', '0');
INSERT INTO `comment` VALUES ('151053616317', 'task', 'T17092817301541', null, '蓝光客户来访时间待定，不再单独提供演示版本，后期再有演示需要直接上绿城项目版本。', '丁庆发', '/images/photo/hippo.png', 'dingqingfa@star-net.cn', '2017-11-13 09:22:44', 'dingqingfa@star-net.cn', '2017-11-13 09:22:44', '0');
INSERT INTO `comment` VALUES ('151053640697', 'task', 'T17111309264680', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-11-13 09:26:47', 'dingqingfa@star-net.cn', '2017-11-13 09:26:47', '0');
INSERT INTO `comment` VALUES ('151053657118', 'task', 'T17111309293138', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-11-13 09:29:32', 'dingqingfa@star-net.cn', '2017-11-13 09:29:32', '0');
INSERT INTO `comment` VALUES ('151053662675', 'task', 'T17111309302618', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-11-13 09:30:26', 'dingqingfa@star-net.cn', '2017-11-13 09:30:26', '0');
INSERT INTO `comment` VALUES ('151053667598', 'task', 'T17111309311546', null, '创建了这个任务。 --automatic generation--', null, null, 'dingqingfa@star-net.cn', '2017-11-13 09:31:16', 'dingqingfa@star-net.cn', '2017-11-13 09:31:16', '0');

-- ----------------------------
-- Table structure for project
-- ----------------------------
DROP TABLE IF EXISTS `project`;
CREATE TABLE `project` (
  `id` varchar(64) NOT NULL DEFAULT '' COMMENT '主键',
  `name` varchar(64) DEFAULT NULL COMMENT '项目名称',
  `description` varchar(128) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL COMMENT '项目需求',
  `status` varchar(64) DEFAULT NULL COMMENT '项目状态：1、未开始，2、正在进行，3、已完成，4、已结项，5、已归档',
  `progress` varchar(64) DEFAULT NULL COMMENT '项目进度',
  `project_manager` varchar(64) DEFAULT NULL COMMENT '项目经理',
  `create_by` varchar(64) DEFAULT NULL COMMENT '创建者',
  `create_date` datetime DEFAULT NULL COMMENT '创建时间',
  `update_by` varchar(64) DEFAULT NULL COMMENT '更新者',
  `update_date` datetime DEFAULT NULL COMMENT '更新时间',
  `expect_finish_date` datetime DEFAULT NULL COMMENT '期望完成时间',
  `real_finish_date` datetime DEFAULT NULL COMMENT '实际完成时间',
  `del_flag` varchar(64) DEFAULT NULL COMMENT '逻辑删除标记（0：显示；1：隐藏）',
  PRIMARY KEY (`id`),
  UNIQUE KEY `id` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='项目';

-- ----------------------------
-- Records of project
-- ----------------------------
INSERT INTO `project` VALUES ('100', 'T91R', 'first project', null, null, null, 'dqf', '2017-07-27 19:45:16', null, null, null, null, null);
INSERT INTO `project` VALUES ('1002', 'I66', null, null, null, null, null, null, null, null, null, null, null);
INSERT INTO `project` VALUES ('1003', 'I68', null, null, null, null, null, null, null, null, null, null, null);
INSERT INTO `project` VALUES ('1004', 'zootopia', null, null, null, null, '丁庆发', null, null, null, null, null, null);
INSERT INTO `project` VALUES ('11', '辅助生产', null, null, null, null, 'admin', null, null, null, null, null, null);
INSERT INTO `project` VALUES ('12', '成品定制', null, null, null, null, 'admin', null, null, null, null, null, null);
INSERT INTO `project` VALUES ('13', '方案预研', null, null, null, null, 'admin', null, null, null, null, null, null);
INSERT INTO `project` VALUES ('14', '成品维护', null, null, null, null, 'admin', null, null, null, null, null, null);
INSERT INTO `project` VALUES ('15', '板卡定制', null, null, null, null, 'admin', null, null, null, null, null, null);
INSERT INTO `project` VALUES ('P17082219354920', 'X66L', '楼宇设备新产品，DS2600处理器，linux平台。\r\n和X66_3.0 共用主板。', '0', '0%', 'liqing@star-net.cn', 'dingqingfa@star-net.cn', '2017-08-22 19:35:50', 'dingqingfa@star-net.cn', '2017-08-22 19:35:50', '2017-08-22 19:35:50', null, '0');
INSERT INTO `project` VALUES ('P17093009360665', '智能魔镜', '镜面中嵌套Android系统，有健康、智能家居、对讲等功能。', '0', '0%', 'hongguifang@star-net.cn', 'dingqingfa@star-net.cn', '2017-09-30 09:36:07', 'dingqingfa@star-net.cn', '2017-09-30 09:36:07', '2017-09-30 09:36:07', null, '0');
INSERT INTO `project` VALUES ('P17110709431567', 'I100', '', '0', '0%', 'linshengteng@star-net.cn', 'dingqingfa@star-net.cn', '2017-11-07 09:43:15', 'dingqingfa@star-net.cn', '2017-11-07 09:43:15', '2017-11-07 09:43:15', null, '0');

-- ----------------------------
-- Table structure for subtask
-- ----------------------------
DROP TABLE IF EXISTS `subtask`;
CREATE TABLE `subtask` (
  `id` bigint(64) NOT NULL COMMENT '主键',
  `parent_id` varchar(64) DEFAULT NULL COMMENT '所属任务',
  `description` varchar(128) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL COMMENT '检查项描述',
  `status` varchar(64) DEFAULT NULL COMMENT '任务状态：0、未完成，1、已完成',
  `create_by` varchar(64) DEFAULT NULL COMMENT '创建者',
  `create_date` datetime DEFAULT NULL COMMENT '创建时间',
  `update_by` varchar(64) DEFAULT NULL COMMENT '更新者',
  `update_date` datetime DEFAULT NULL COMMENT '更新时间',
  `del_flag` varchar(64) DEFAULT NULL COMMENT '逻辑删除标记（0：显示；1：隐藏）',
  PRIMARY KEY (`id`),
  UNIQUE KEY `id` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='子任务';

-- ----------------------------
-- Records of subtask
-- ----------------------------
INSERT INTO `subtask` VALUES ('150303539524', 'T17072111340965', '重新设计UI', '1', null, '2017-08-18 13:49:56', null, '2017-08-22 18:19:32', null);
INSERT INTO `subtask` VALUES ('150329438031', 'T17082113454481', '任务面板头部最多显示3个处理人；', '1', null, '2017-08-21 13:46:20', null, '2017-08-21 13:47:11', null);
INSERT INTO `subtask` VALUES ('150336782165', 'T17080410424594', '测试', '1', null, '2017-08-22 10:10:21', null, '2017-08-22 10:10:23', null);
INSERT INTO `subtask` VALUES ('150339717184', 'T17072111340965', '编写桌面widget', '0', null, '2017-08-22 18:19:31', null, '2017-08-22 18:19:31', null);
INSERT INTO `subtask` VALUES ('150339719694', 'T17072111340965', '实现监视、呼叫物业、布撤防、通话记录功能。', '0', null, '2017-08-22 18:19:56', null, '2017-08-22 18:19:56', null);
INSERT INTO `subtask` VALUES ('150656212262', 'T17082219265146', '在T91 应用中移植rabbitmq 。', '1', null, '2017-09-28 09:28:43', null, '2017-09-28 09:29:56', null);
INSERT INTO `subtask` VALUES ('150656215732', 'T17082219265146', '使用消息队列实现开锁、二维码更新、重启等功能；', '1', null, '2017-09-28 09:29:18', null, '2017-09-28 09:30:27', null);
INSERT INTO `subtask` VALUES ('150656222683', 'T17082219265146', '对接T91 sip功能到彩生活的sip服务器；', '1', null, '2017-09-28 09:30:26', null, '2017-09-28 09:30:28', null);
INSERT INTO `subtask` VALUES ('150656224292', 'T17082219265146', '功能联调；', '0', null, '2017-09-28 09:30:43', null, '2017-09-28 11:29:21', null);
INSERT INTO `subtask` VALUES ('150673578129', 'T17093009421037', '任务增加文件上传功能；', '0', null, '2017-09-30 09:43:02', null, '2017-09-30 09:43:02', null);
INSERT INTO `subtask` VALUES ('150673584435', 'T17093009421037', '增加任务处理结果填写与导出；', '0', null, '2017-09-30 09:44:04', null, '2017-09-30 09:44:04', null);
INSERT INTO `subtask` VALUES ('150673589598', 'T17093009421037', '完善评论区，显示输入框；良好的输入体验；', '0', null, '2017-09-30 09:44:55', null, '2017-09-30 09:50:54', null);
INSERT INTO `subtask` VALUES ('150673592075', 'T17093009421037', '任务分配增加全部分类；', '0', null, '2017-09-30 09:45:20', null, '2017-09-30 10:02:27', null);
INSERT INTO `subtask` VALUES ('150673595448', 'T17093009421037', '任务到期提醒，包括邮件和日期颜色；', '0', null, '2017-09-30 09:45:55', null, '2017-09-30 09:45:55', null);
INSERT INTO `subtask` VALUES ('150673597204', 'T17093009421037', '任务增加提测时间和发布时间；', '0', null, '2017-09-30 09:46:12', null, '2017-09-30 10:02:30', null);
INSERT INTO `subtask` VALUES ('150673601349', 'T17093009421037', '文章排序增加置顶功能；', '0', null, '2017-09-30 09:46:53', null, '2017-09-30 09:46:53', null);
INSERT INTO `subtask` VALUES ('150673602544', 'T17093009421037', '优化 icheck 控件的流畅性；', '0', null, '2017-09-30 09:47:06', null, '2017-09-30 10:02:31', null);
INSERT INTO `subtask` VALUES ('150673604524', 'T17093009421037', 'redis 引入，提高访问速度；', '0', null, '2017-09-30 09:47:25', null, '2017-09-30 10:02:32', null);
INSERT INTO `subtask` VALUES ('150673606314', 'T17093009421037', '修改一系列密码，不上传git；', '0', null, '2017-09-30 09:47:43', null, '2017-09-30 09:47:43', null);
INSERT INTO `subtask` VALUES ('150673687056', 'T17093009421037', '数据库、文件自动备份；', '0', null, '2017-09-30 10:01:10', null, '2017-09-30 10:01:10', null);
INSERT INTO `subtask` VALUES ('151010688406', 'T17100909275646', '1.新增智能家居类型，实现协议：发送场景列表查询、场景控制指令，接收与处理场景列表查询回包。', '1', null, '2017-11-08 10:08:04', null, '2017-11-08 10:08:19', null);
INSERT INTO `subtask` VALUES ('151010691060', 'T17100909275646', '2.新增智能家居界面：实现场景控制选项刷新、场景控制，和根据场景数量自动布局，以及翻页、页码显示功能。', '1', null, '2017-11-08 10:08:31', null, '2017-11-08 10:08:32', null);
INSERT INTO `subtask` VALUES ('151010695239', 'T17100909275646', '提测软件升级包（演示版本，无需测试，直接发给客户），上传地址：svn://192.168.61.223/dvp_rom/testing/custom/天诚百微/V5.0.2_[146.0001]/V5.0.2_[146.0001]_b1/', '1', null, '2017-11-08 10:09:12', null, '2017-11-08 10:09:31', null);
INSERT INTO `subtask` VALUES ('151010706042', 'T17101609113124', '解决稳定性问题（一天死机次数超过3个以上的稳定性bug）。', '1', null, '2017-11-08 10:11:00', null, '2017-11-08 10:11:04', null);

-- ----------------------------
-- Table structure for sys_dict
-- ----------------------------
DROP TABLE IF EXISTS `sys_dict`;
CREATE TABLE `sys_dict` (
  `id` varchar(64) NOT NULL COMMENT '编号',
  `name` varchar(64) DEFAULT NULL COMMENT '名称',
  `en_name` varchar(64) DEFAULT NULL COMMENT '英文名称',
  `sort` varchar(64) DEFAULT NULL COMMENT '分类',
  `create_by` varchar(64) DEFAULT NULL COMMENT '创建者',
  `create_date` datetime DEFAULT NULL COMMENT '创建时间',
  `update_by` varchar(64) DEFAULT NULL COMMENT '更新者',
  `update_date` datetime DEFAULT NULL COMMENT '更新时间',
  `del_flag` char(1) DEFAULT '0' COMMENT '删除标记',
  PRIMARY KEY (`id`),
  UNIQUE KEY `id` (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='系统字典';

-- ----------------------------
-- Records of sys_dict
-- ----------------------------
INSERT INTO `sys_dict` VALUES ('10001', '初稿', 'new', 'task_status', null, null, null, null, null);
INSERT INTO `sys_dict` VALUES ('10002', '正在处理', 'doing', 'task_status', null, null, null, null, null);
INSERT INTO `sys_dict` VALUES ('10003', '完成', 'done', 'task_status', null, null, null, null, null);
INSERT INTO `sys_dict` VALUES ('10004', '已审核', 'checked', 'task_status', null, null, null, null, null);
INSERT INTO `sys_dict` VALUES ('10005', '已归档', 'archived', 'task_status', null, null, null, null, null);
INSERT INTO `sys_dict` VALUES ('10006', '暂停', 'pause', 'task_status', null, null, null, null, null);
INSERT INTO `sys_dict` VALUES ('20001', 'DS3000', 'DS3000', 'article_category_platform', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20002', 'DS2600', 'DS2600', 'article_category_platform', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20003', 'DS2000', 'DS2000', 'article_category_platform', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20004', 'MCU', 'MCU', 'article_category_platform', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20005', 'C&C++', 'C&C++', 'article_category_language', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20006', 'Java', 'Java', 'article_category_language', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20007', 'Python', 'Python', 'article_category_language', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20008', 'Shell', 'Shell', 'article_category_language', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20009', 'JS&Jquery', 'Js&Jquery', 'article_category_language', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20010', 'Linux', 'Linux', 'article_category_system', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20011', 'Android', 'Android', 'article_category_system', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20012', 'IOS', 'IOS', 'article_category_system', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20013', 'JavaWeb', 'JavaWeb', 'article_category_system', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20014', 'Git&Svn', 'Git&Svn', 'article_category_system', null, null, null, null, '0');
INSERT INTO `sys_dict` VALUES ('20015', 'Other', 'Other', 'article_category_system', null, null, null, null, '0');

-- ----------------------------
-- Table structure for task
-- ----------------------------
DROP TABLE IF EXISTS `task`;
CREATE TABLE `task` (
  `id` varchar(64) NOT NULL DEFAULT '' COMMENT '主键',
  `project_name` varchar(64) DEFAULT NULL COMMENT '所属项目',
  `title` varchar(128) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL COMMENT '任务标题',
  `description` varchar(512) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL COMMENT '任务描述',
  `status` varchar(64) DEFAULT NULL COMMENT '任务状态：1、未分配，2、正在处理，3、已完成，4、已审核，5、已归档',
  `progress` varchar(64) DEFAULT NULL COMMENT '任务进度',
  `priority` varchar(32) DEFAULT NULL COMMENT '优先级',
  `assign_to` varchar(256) DEFAULT NULL COMMENT '处理者',
  `follower` varchar(256) DEFAULT NULL COMMENT '关注人',
  `create_by` varchar(64) DEFAULT NULL COMMENT '创建者',
  `create_date` datetime DEFAULT NULL COMMENT '创建时间',
  `update_by` varchar(64) DEFAULT NULL COMMENT '更新者',
  `update_date` datetime DEFAULT NULL COMMENT '更新时间',
  `expect_finish_date` varchar(64) DEFAULT NULL COMMENT '期望完成时间',
  `real_finish_date` varchar(64) DEFAULT NULL COMMENT '实际完成时间',
  `finish_info` varchar(512) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL COMMENT '完成说明',
  `finish_link` varchar(128) CHARACTER SET utf8 COLLATE utf8_bin DEFAULT NULL COMMENT '任务标题',
  `del_flag` varchar(64) DEFAULT NULL COMMENT '逻辑删除标记（0：显示；1：隐藏）',
  PRIMARY KEY (`id`),
  UNIQUE KEY `id` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='任务';

-- ----------------------------
-- Records of task
-- ----------------------------
INSERT INTO `task` VALUES ('T17071817150796', 'teamwork', '账号注册登录以及权限校验', 'fsfffffffff啊手动阀手动阀', '10003', '100%', '0', 'dingqingfa@star-net.cn', 'chenzhong.sy@star-net.cn;liqing@star-net.cn;linshengteng@star-net.cn;fangxuerong@star-net.cn;huangwenwen@star-net.cn;hongguifang@star-net.cn;chenronghui@star-net.cn;dingqingfa@star-net.cn', null, '2017-07-18 17:15:07', null, '2017-09-05 10:57:12', '2017-07-21', '', '', '', '0');
INSERT INTO `task` VALUES ('T17072111340965', '智能魔镜', '魔镜绿城项目', '用于宁波绿城项目， 首页与智能家居、天气等结合。<br />客户：视源<br /><br />需要实现以下功能：<br />1. 重新设计UI；<br />2. 编写桌面空间widget；<br />3. 实现基本功能，呼叫中心、监视、记录；<br />4. 使用新样机支持8防区；<br /><br />时间节点：<br />1. 提供样机        【2017-10-11】<br />2. 提供防区sdk  【2017-10-12】<br />3. 完整测试版    【2017-10-16】<br />4. 发布               【2017-10-20】<br /><br />时间节点更新：<br />1. 10月19日星网发布对讲软件APP供CVTE测试，发布对讲功能的视频给绿城<br />2. 10月25日CVTE发布新机器（样机+防区模块 + 新协议版本），邮寄至绿城（2台）、星网（1台）、智轩（1台）<br />3. 10月26~30日星网、智轩调试，完成所有测试并发布APP。', '10002', '33%', '1', 'hongguifang@star-net.cn', 'chenzhong.sy@star-net.cn;liqing@star-net.cn;linshengteng@star-net.cn;fangxuerong@star-net.cn;huangwenwen@star-net.cn;hongguifang@star-net.cn;chenronghui@star-net.cn;dingqingfa@star-net.cn', null, '2017-07-21 11:34:10', null, '2017-11-13 10:05:12', '2017-10-25', '2017-07-29', '处理说明', 'http://www.baidu.com/abcd', '0');
INSERT INTO `task` VALUES ('T17073000453713', 'teamwork', '文件上传与管理功能', '', '10001', '0%', '0', 'dingqingfa@star-net.cn', 'dingqingfa@star-net.cn;chenzhong.sy@star-net.cn;liqing@star-net.cn;linshengteng@star-net.cn;fangxuerong@star-net.cn;huangwenwen@star-net.cn', null, '2017-07-30 00:45:38', null, '2017-11-13 09:29:03', '2017-07-30', null, null, null, '1');
INSERT INTO `task` VALUES ('T17080215071754', 'teamwork', '搜索功能', '搜索内容', '10002', '0%', '0', 'dingqingfa@star-net.cn', 'dingqingfa@star-net.cn;chenzhong.sy@star-net.cn;liqing@star-net.cn;linshengteng@star-net.cn;fangxuerong@star-net.cn;huangwenwen@star-net.cn;hongguifang@star-net.cn;chenronghui@star-net.cn', null, '2017-08-02 15:07:18', null, '2017-09-04 14:39:31', '2017-08-10', null, null, null, '1');
INSERT INTO `task` VALUES ('T17081614174204', 'teamwork', '使用redis缓存', '提高系统响应速度；<br />管理用户登录信息；', '10002', '83%', '0', 'dingqingfa@star-net.cn', 'dingqingfa@star-net.cn;huangwenwen@star-net.cn', null, '2017-08-16 14:17:42', null, '2017-08-22 19:07:43', '2017-08-19', null, null, null, '1');
INSERT INTO `task` VALUES ('T17082109121894', '成品定制', '小咚批量生产问题跟踪', '新一批小咚代工生产过程中出现一定数量设备无法正常配对的问题。', '10003', '0%', '0', 'dingqingfa@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-08-21 09:12:18', null, '2017-09-30 09:52:14', '2017-08-25', null, null, null, '0');
INSERT INTO `task` VALUES ('T17082113454481', 'teamwork', '任务管理功能完善', '详见', '10003', '100%', '0', 'dingqingfa@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-08-21 13:45:44', null, '2017-09-08 11:03:30', '2017-08-25', null, null, null, '0');
INSERT INTO `task` VALUES ('T17082115212269', '成品定制', 'T91对接花样年云平台', '1.使用AMQP协议。', '10001', '0%', '0', 'dingqingfa@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-08-21 15:21:23', null, '2017-09-04 14:27:47', '2017-09-30', null, null, null, '1');
INSERT INTO `task` VALUES ('T17082219204886', 'teamwork', '知识文章功能模块', '支持文章增删改；<br />支持按类别查看；', '10001', '0%', '0', 'dingqingfa@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-08-22 19:20:48', null, '2017-09-01 22:39:57', '2017-08-25', null, null, null, '1');
INSERT INTO `task` VALUES ('T17082219265146', '成品定制', '花样年T91对接云平台', '支持sip对讲；<br />实现amqp协议；<br />实现远程控制；', '10006', '75%', '0', 'dingqingfa@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-08-22 19:26:52', null, '2017-10-26 09:58:17', '2017-09-30', null, null, null, '0');
INSERT INTO `task` VALUES ('T17090410500733', '成品定制', 'X66_3.0 对接自主智能家居中控', '1. 电器：4个开关灯，1个窗帘，4种安防模式；<br />2. 进入控制界面时支持状态回读，用于更新电器状态；<br />3. 9月4日先提供控制命令数据供对方对接；<br />4. 控制命令需要对方回复数据；<br />5. 样板房演示用，不需要提测。<br />', '10003', '0%', '1', 'hongguifang@star-net.cn', 'hongguifang@star-net.cn', null, '2017-09-04 10:50:08', null, '2017-11-08 11:09:33', '2017-09-06', null, null, null, '0');
INSERT INTO `task` VALUES ('T17092809270352', '成品定制', 'X30_3.0 土耳其版本', '由于供货给睿云联的机型由DS2000平台的X30_2.1 切换到DS2600平台的X30_3.0，需要在新机型上迁移之前的土耳其版本定制功能。', '10002', '0%', '0', 'fangxuerong@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-09-28 09:27:04', null, '2017-11-13 10:05:14', '2017-10-31', null, null, null, '0');
INSERT INTO `task` VALUES ('T17092811273072', '成品定制', '通过U33R实现APP远程控制家庭空调', '【常州九州项目】<br />需要演示通过APP控制家庭空调的功能。<br />选用U33R 机型，通过WIFI 连接公网，并监听mq服务器对应的消息队列。收到APP发过来的控制命令后通过RS485转发给空调实现远程控制功能。<br />需要移植RabbitMq 消息队列。<br /><br />485协议：《通信协议(九洲新世界项目智能家居-空调).doc》<br /><br />时间节点：<br />- 11月1日 提测，预计两轮发布。', '10002', '0%', '1', 'fangxuerong@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-09-28 11:27:31', null, '2017-11-13 10:05:17', '2017-11-10', null, null, null, '0');
INSERT INTO `task` VALUES ('T17092817301541', '智能魔镜', '魔镜展厅演示版本', '【重要演示需求】<br />用于总部多功能展厅；<br />10月15日蓝光地产来公司考察演示，涉及集采。<br />要求实现对讲基本功能，可运行于展厅环境。', '10003', '0%', '0', 'linshengteng@star-net.cn;hongguifang@star-net.cn', 'hongguifang@star-net.cn', null, '2017-09-28 17:30:16', null, '2017-11-13 09:21:58', '2017-10-15', null, null, null, '0');
INSERT INTO `task` VALUES ('T17093009394049', '成品定制', 'I100 杭州阳光城样板房演示', 'i100的演示版本，针对杭州阳光的样板房（基于魔镜风格的UI，完成室内机的主要功能，10.20）', '10006', '0%', '0', 'linshengteng@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-09-30 09:39:40', null, '2017-10-25 13:56:47', '2017-10-20', null, null, null, '0');
INSERT INTO `task` VALUES ('T17093009421037', 'zootopia', 'Zootopia 新版本 v1.1', '', '10006', '0%', '0', 'dingqingfa@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-09-30 09:42:11', null, '2017-10-16 09:10:21', '2017-10-31', null, null, null, '0');
INSERT INTO `task` VALUES ('T17100909231335', '成品定制', 'T91_2.0机型家和定制软件包', '由于机型升级，需要给威海家和提供T91_2.0 新机型的定制软件包，定制内容查看历史需求，知情人-林圣腾', '10003', '0%', '0', 'liqing@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-10-09 09:23:14', null, '2017-11-08 10:23:12', '2017-10-20', null, null, null, '0');
INSERT INTO `task` VALUES ('T17100909275646', '成品定制', '天诚百威X86智能家居定制', '先做演示，只有场景控制，场景类型从智能家居中控读取，协议由对方提供。<br />实际上项目会用I66 和I100。', '10003', '100%', '1', 'chenzhong.sy@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-10-09 09:27:57', null, '2017-11-08 10:46:10', '2017-10-31', null, null, null, '0');
INSERT INTO `task` VALUES ('T17100909302274', '成品定制', '睿云联Z73土耳其语言修订版本', '客户发现一些翻译错误，根据提供的翻译词条重新打包。', '10003', '0%', '0', 'fangxuerong@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-10-09 09:30:22', null, '2017-11-08 10:23:17', '2017-10-20', null, null, null, '0');
INSERT INTO `task` VALUES ('T17101109494018', '成品维护', 'GD Flash 使用一段时间出现分区只读问题排查', 'DS2600 平台导入新Flash 后出现的不稳定问题。', '10002', '0%', '1', 'liqing@star-net.cn', 'liqing@star-net.cn', null, '2017-10-11 09:49:40', null, '2017-11-13 10:05:19', '2017-10-31', null, null, null, '0');
INSERT INTO `task` VALUES ('T17101110085824', '成品维护', 'E10S sip对讲', '实现通过sip协议呼叫app。', '10002', '0%', '0', 'chenzhong.sy@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-10-11 10:08:58', null, '2017-11-13 10:05:21', '2017-11-15', null, null, null, '0');
INSERT INTO `task` VALUES ('T17101118015252', '成品维护', 'T91_V5.0.3', '1.使用新sip库，提高设备稳定性，需要做对比测试； <br />2.优化户外人脸识别效果，主要是T91SA_2.0；通过修改测光权重等方法。 人脸识别失败记录上报，有框到人脸才上报，可用于开锁失败原因分析。<br />3.所有开锁都支持梯控联动，包括人脸识别、声波开锁、二维码、密码开锁等，部分要服务端配合。 <br />4. 可见光人脸上识别模式，白光补光灯自动开启的阈值可配置，避免应用环境光线处于临界值的场景补光灯工作不稳定，导致注册和识别场景存在差异。 <br />5.加入tcpdump 命令，方便问题排查。 <br />6.支持注册人脸修改，业主重新刷卡注册人脸时可以通过点击4张图片修改注册人脸。 <br />7.修复主线BUG。<br />8.sip对讲把关键帧提升至1s（原来是2s），提高APP端视频出现的速度。<br />其他：解决主线bug，包括人脸注册太多会卡主的问题。', '10002', '0%', '0', 'liqing@star-net.cn', 'liqing@star-net.cn', null, '2017-10-11 18:01:53', null, '2017-11-13 10:15:34', '2017-11-30', null, null, null, '0');
INSERT INTO `task` VALUES ('T17101609113124', '成品维护', 'DS2000_v5.x 兼容版本', '', '10003', '100%', '0', 'chenzhong.sy@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-10-16 09:11:31', null, '2017-11-08 10:46:04', '2017-10-31', null, null, null, '0');
INSERT INTO `task` VALUES ('T17101609240172', 'T91R', 'T91R B1', '', '10002', '0%', '1', 'linshengteng@star-net.cn;huangwenwen@star-net.cn;chenronghui@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-10-16 09:24:01', null, '2017-11-13 10:05:25', '2017-10-20', null, null, null, '0');
INSERT INTO `task` VALUES ('T17110609060561', '成品维护', 'DS2600平台启动卡住问题', '概率性问题，最快1000多次出现一次。<br /><br />1. 通过前置重启动作，缩短每轮测试时间，提高复现速度。<br />2. 验证复现后看门狗效果，在boot0_main.c文件中。<br />3. 测试全志优化后的libdram库，不带看门狗。<br />4. 开启并测试内核看门狗。<br />', '10002', '0%', '0', 'liqing@star-net.cn;dingqingfa@star-net.cn', 'liqing@star-net.cn', null, '2017-11-06 09:06:06', null, '2017-11-13 10:06:59', '2017-11-30', null, null, null, '0');
INSERT INTO `task` VALUES ('T17110709450462', 'I100', '模块化安卓应用程序框架预研', '每个业务开发一个apk；便于维护、测试与发布；<br />公共业务开发平台服务；如下载服务。<br />公共接口开发公共库；如网络封包解包。<br />输出程序分层框架图。', '10002', '0%', '0', 'linshengteng@star-net.cn;hongguifang@star-net.cn', '', null, '2017-11-07 09:45:05', null, '2017-11-13 10:07:25', '2017-11-17', null, null, null, '0');
INSERT INTO `task` VALUES ('T17110916030958', 'I66', 'I66 中海投标演示版本', '基于I100 阳光城演示版本，缩放到I66 机器上。<br />要求基本功能可用，包括呼叫、监视、设置等。<br />首页天气地区改成深圳市，其他信息可以先用假数据。<br /><br />使用X66L 触摸屏，驱动上可能需要做适配。如工作量大于预期则另外商讨对策。', '10002', '0%', '1', 'linshengteng@star-net.cn', 'linshengteng@star-net.cn', null, '2017-11-09 16:03:10', null, '2017-11-13 10:07:27', '2017-11-13', null, null, null, '0');
INSERT INTO `task` VALUES ('T17111309264680', '成品定制', '阳光城丽景湾plus-室内机召梯', '电梯厂商：上海三菱电梯；<br />解决已发现bug；<br />梯口机招梯之前需求已实现，本次追加室内机招梯。', '10003', '0%', '0', 'hongguifang@star-net.cn', 'hongguifang@star-net.cn', null, '2017-11-13 09:26:47', null, '2017-11-13 10:55:40', '2017-11-17', null, null, null, '0');
INSERT INTO `task` VALUES ('T17111309293138', '成品定制', '淮安大科-淮安东冠逸轩项目二期X30_3.0不显示硬件型号', '淮安大科-淮安东冠逸轩项目二期X30_3.0不显示硬件型号', '10001', '0%', '0', 'dingqingfa@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-11-13 09:29:32', null, '2017-11-13 09:31:28', '2017-11-25', null, null, null, '0');
INSERT INTO `task` VALUES ('T17111309302618', '成品定制', '美格T91_2.0软件包', '1、开机logo修改为美格的logo，logo如附件。<br />     2、系统信息里的型号，改成美格的XC7006<br /><br />最好底包和升级包都能提供一个，以备不时之需。（在兼容版本基础上打包即可）', '10001', '0%', '0', 'dingqingfa@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-11-13 09:30:26', null, '2017-11-13 09:31:27', '2017-11-25', null, null, null, '0');
INSERT INTO `task` VALUES ('T17111309311546', '成品定制', '南京云晶金星御园-X66L做梯控层显', '南京云晶金星御园-X66L做层显，电梯到达需要有语音提示给业主（如：电梯已到达），<br />做485梯控，不需APP召梯', '10001', '0%', '0', 'dingqingfa@star-net.cn', 'dingqingfa@star-net.cn', null, '2017-11-13 09:31:16', null, '2017-11-13 09:31:26', '2017-12-11', null, null, null, '0');

-- ----------------------------
-- Table structure for user
-- ----------------------------
DROP TABLE IF EXISTS `user`;
CREATE TABLE `user` (
  `id` varchar(64) NOT NULL COMMENT '编号',
  `company_id` varchar(64) DEFAULT NULL COMMENT '归属公司',
  `office_id` varchar(64) DEFAULT NULL COMMENT '归属部门',
  `login_name` varchar(100) DEFAULT NULL COMMENT '登录名',
  `password` varchar(100) DEFAULT NULL COMMENT '密码',
  `no` varchar(100) DEFAULT NULL COMMENT '工号',
  `name` varchar(100) DEFAULT NULL COMMENT '姓名',
  `email` varchar(200) DEFAULT NULL COMMENT '邮箱',
  `phone` varchar(200) DEFAULT NULL COMMENT '电话',
  `mobile` varchar(200) DEFAULT NULL COMMENT '手机',
  `user_type` char(1) DEFAULT NULL COMMENT '用户类型',
  `photo` varchar(1000) DEFAULT NULL COMMENT '用户头像',
  `login_ip` varchar(100) DEFAULT NULL COMMENT '最后登陆IP',
  `login_date` datetime DEFAULT NULL COMMENT '最后登陆时间',
  `login_flag` varchar(64) DEFAULT NULL COMMENT '是否可登录',
  `create_by` varchar(64) DEFAULT NULL COMMENT '创建者',
  `create_date` datetime DEFAULT NULL COMMENT '创建时间',
  `update_by` varchar(64) DEFAULT NULL COMMENT '更新者',
  `update_date` datetime DEFAULT NULL COMMENT '更新时间',
  `remarks` varchar(255) DEFAULT NULL COMMENT '备注信息',
  `del_flag` char(1) DEFAULT '0' COMMENT '删除标记',
  `qrcode` varchar(1000) DEFAULT NULL COMMENT '二维码',
  PRIMARY KEY (`id`),
  UNIQUE KEY `id` (`id`),
  UNIQUE KEY `login_name` (`login_name`),
  UNIQUE KEY `no` (`no`),
  UNIQUE KEY `email` (`email`),
  UNIQUE KEY `phone` (`phone`),
  UNIQUE KEY `mobile` (`mobile`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='用户表';

-- ----------------------------
-- Records of user
-- ----------------------------
INSERT INTO `user` VALUES ('102', null, null, null, 'T11478', 'T11478', '陈钟', 'chenzhong.sy@star-net.cn', null, null, null, '/images/photo/giraffe.png', null, null, null, null, null, null, null, null, null, null);
INSERT INTO `user` VALUES ('103', null, null, null, 'T10667', 'T10667', '李晴', 'liqing@star-net.cn', null, null, null, '/images/photo/lion.png', null, null, null, null, null, null, null, null, null, null);
INSERT INTO `user` VALUES ('104', null, null, null, 'T11441', 'T11441', '林圣腾', 'linshengteng@star-net.cn', null, null, null, '/images/photo/zhiwu.png', null, null, null, null, null, null, null, null, null, null);
INSERT INTO `user` VALUES ('105', null, null, null, 'T4025', 'T4025', '方雪嵘', 'fangxuerong@star-net.cn', null, null, null, '/images/photo/zebra.png', null, null, null, null, null, null, null, null, null, null);
INSERT INTO `user` VALUES ('106', null, null, null, 'T12665', 'T12665', '黄文文', 'huangwenwen@star-net.cn', null, null, null, '/images/photo/dragon.png', null, null, null, null, null, null, null, null, null, null);
INSERT INTO `user` VALUES ('107', null, null, null, 'T12693', 'T12693', '洪桂芳', 'hongguifang@star-net.cn', null, null, null, '/images/photo/elephant.png', null, null, null, null, null, null, null, null, null, null);
INSERT INTO `user` VALUES ('108', null, null, null, 'T13482', 'T13482', '陈荣辉', 'chenronghui@star-net.cn', null, null, null, '/images/photo/pig.png', null, null, null, null, null, null, null, null, null, null);
INSERT INTO `user` VALUES ('109', null, null, null, '115513875', 'T10316', '丁庆发', 'dingqingfa@star-net.cn', null, null, null, '/images/photo/hippo.png', null, null, null, null, null, null, null, null, null, null);
INSERT INTO `user` VALUES ('110', null, null, null, 'T10663', 'T10663', '王锦乐', 'wangjinle@star-net.cn', null, null, null, '/images/photo/bear.png', null, null, null, null, null, null, null, null, '0', null);
